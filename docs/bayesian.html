<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Bayesian Approaches | Mixed Models with R</title>
  <meta name="description" content="This is an introduction to mixed models in R. It covers a many of the most common techniques employed in such models, and relies heavily on the lme4 package. The basics of random intercepts and slopes models, crossed vs. nested models, etc. are covered. Discussion includes extensions into generalized mixed models and realms beyond." />
  <meta name="generator" content="bookdown 0.20.2 and GitBook 2.6.7" />

  <meta property="og:title" content="Bayesian Approaches | Mixed Models with R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://m-clark.github.io/mixed-models-with-R/" />
  <meta property="og:image" content="https://m-clark.github.io/mixed-models-with-R/img/nineteeneightyR.png" />
  <meta property="og:description" content="This is an introduction to mixed models in R. It covers a many of the most common techniques employed in such models, and relies heavily on the lme4 package. The basics of random intercepts and slopes models, crossed vs. nested models, etc. are covered. Discussion includes extensions into generalized mixed models and realms beyond." />
  <meta name="github-repo" content="m-clark/mixed-models-with-R/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Bayesian Approaches | Mixed Models with R" />
  
  <meta name="twitter:description" content="This is an introduction to mixed models in R. It covers a many of the most common techniques employed in such models, and relies heavily on the lme4 package. The basics of random intercepts and slopes models, crossed vs. nested models, etc. are covered. Discussion includes extensions into generalized mixed models and realms beyond." />
  <meta name="twitter:image" content="https://m-clark.github.io/mixed-models-with-R/img/nineteeneightyR.png" />



<meta name="date" content="2020-09-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="img/R.ico" type="image/x-icon" />
<link rel="prev" href="issues.html"/>
<link rel="next" href="further.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.15/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/book.css" type="text/css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.14.0/css/all.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class='before'><a href="./">Mixed Models with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#overview"><i class="fa fa-check"></i>Overview</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#goals"><i class="fa fa-check"></i>Goals</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#workshop"><i class="fa fa-check"></i>Workshop</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#key-packages"><i class="fa fa-check"></i>Key packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html"><i class="fa fa-check"></i>Mixed Models</a><ul>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#terminology"><i class="fa fa-check"></i>Terminology</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#kinds-of-clustering"><i class="fa fa-check"></i>Kinds of Clustering</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#random-intercepts-model"><i class="fa fa-check"></i>Random Intercepts Model</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#example-student-gpa"><i class="fa fa-check"></i>Example: Student GPA</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#the-standard-regression-model"><i class="fa fa-check"></i>The Standard Regression Model</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#the-mixed-model"><i class="fa fa-check"></i>The Mixed Model</a><ul>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#initial-depiction"><i class="fa fa-check"></i>Initial depiction</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#as-a-multi-level-model"><i class="fa fa-check"></i>As a multi-level model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#application"><i class="fa fa-check"></i>Application</a><ul>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#initial-visualization"><i class="fa fa-check"></i>Initial visualization</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#standard-regression"><i class="fa fa-check"></i>Standard regression</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#regression-by-cluster"><i class="fa fa-check"></i>Regression by cluster</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#running-a-mixed-model"><i class="fa fa-check"></i>Running a mixed model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#cluster-level-covariates"><i class="fa fa-check"></i>Cluster Level Covariates</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#summary-of-mixed-model-basics"><i class="fa fa-check"></i>Summary of Mixed Model Basics</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#exercises-for-starting-out"><i class="fa fa-check"></i>Exercises for Starting Out</a><ul>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#sleep"><i class="fa fa-check"></i>Sleep</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#adding-the-cluster-level-covariate"><i class="fa fa-check"></i>Adding the cluster-level covariate</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#simulating-a-mixed-model"><i class="fa fa-check"></i>Simulating a mixed model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="random_slopes.html"><a href="random_slopes.html"><i class="fa fa-check"></i>More Random Effects</a><ul>
<li class="chapter" data-level="" data-path="random_slopes.html"><a href="random_slopes.html#application-1"><i class="fa fa-check"></i>Application</a></li>
<li class="chapter" data-level="" data-path="random_slopes.html"><a href="random_slopes.html#comparison-to-many-regressions"><i class="fa fa-check"></i>Comparison to many regressions</a></li>
<li class="chapter" data-level="" data-path="random_slopes.html"><a href="random_slopes.html#visualization-of-effects"><i class="fa fa-check"></i>Visualization of effects</a></li>
<li class="chapter" data-level="" data-path="random_slopes.html"><a href="random_slopes.html#summary-of-random-slopes"><i class="fa fa-check"></i>Summary of Random Slopes</a></li>
<li class="chapter" data-level="" data-path="random_slopes.html"><a href="random_slopes.html#exercises"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html"><i class="fa fa-check"></i>Common Extensions</a><ul>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#additional-grouping-structure"><i class="fa fa-check"></i>Additional Grouping Structure</a><ul>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#cross-classified-models"><i class="fa fa-check"></i>Cross-classified models</a></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#hierarchical-structure"><i class="fa fa-check"></i>Hierarchical structure</a></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#crossed-vs.-nested"><i class="fa fa-check"></i>Crossed vs. nested</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#residual-structure"><i class="fa fa-check"></i>Residual Structure</a><ul>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#heterogeneous-variance"><i class="fa fa-check"></i>Heterogeneous variance</a></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#autocorrelation"><i class="fa fa-check"></i>Autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#generalized-linear-mixed-models"><i class="fa fa-check"></i>Generalized Linear Mixed Models</a></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#exercises-1"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#sociometric-data"><i class="fa fa-check"></i>Sociometric data</a></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#patents"><i class="fa fa-check"></i>Patents</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html"><i class="fa fa-check"></i>Issues</a><ul>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#variance-accounted-for"><i class="fa fa-check"></i>Variance Accounted For</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#common-alternatives-to-mixed-models"><i class="fa fa-check"></i>Common Alternatives to Mixed Models</a><ul>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#growth-curve-models"><i class="fa fa-check"></i>Growth curve models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#sample-sizes"><i class="fa fa-check"></i>Sample Sizes</a><ul>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#small-number-of-clusters"><i class="fa fa-check"></i>Small number of clusters</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#small-number-of-observations-within-clusters"><i class="fa fa-check"></i>Small number of observations within clusters</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#balancedmissing-values"><i class="fa fa-check"></i>Balanced/Missing values</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#big-data"><i class="fa fa-check"></i>Big data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#model-comparison"><i class="fa fa-check"></i>Model Comparison</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#convergence"><i class="fa fa-check"></i>Convergence</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html"><i class="fa fa-check"></i>Bayesian Approaches</a><ul>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html#priors"><i class="fa fa-check"></i>Priors</a><ul>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html#fixed-effects"><i class="fa fa-check"></i>Fixed effects</a></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html#variance-components-1"><i class="fa fa-check"></i>Variance components</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html#demonstration"><i class="fa fa-check"></i>Demonstration</a></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html#example-models"><i class="fa fa-check"></i>Example Models</a></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html#beyond-the-model"><i class="fa fa-check"></i>Beyond the Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="further.html"><a href="further.html"><i class="fa fa-check"></i>Going Further</a><ul>
<li class="chapter" data-level="" data-path="further.html"><a href="further.html#other-distributions"><i class="fa fa-check"></i>Other Distributions</a></li>
<li class="chapter" data-level="" data-path="further.html"><a href="further.html#other-contexts"><i class="fa fa-check"></i>Other Contexts</a></li>
<li class="chapter" data-level="" data-path="further.html"><a href="further.html#nonlinear-mixed-effects-models"><i class="fa fa-check"></i>Nonlinear Mixed Effects Models</a></li>
<li class="chapter" data-level="" data-path="further.html"><a href="further.html#connections"><i class="fa fa-check"></i>Connections</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html"><i class="fa fa-check"></i>Supplemental</a><ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#a-comparison-to-latent-growth-curve-models"><i class="fa fa-check"></i>A Comparison to Latent Growth Curve Models</a><ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#random-effects-as-latent-variables"><i class="fa fa-check"></i>Random effects as latent variables</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#random-effects-in-sem"><i class="fa fa-check"></i>Random effects in SEM</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#running-a-growth-curve-model"><i class="fa fa-check"></i>Running a growth curve model</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#random-intercepts"><i class="fa fa-check"></i>Random intercepts</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#random-intercepts-and-slopes"><i class="fa fa-check"></i>Random intercepts and slopes</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#random-effects-with-heterogeneous-variances"><i class="fa fa-check"></i>Random effects with heterogeneous variances</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#other-covariates"><i class="fa fa-check"></i>Other covariates</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#some-differences-between-mixed-models-and-growth-curves"><i class="fa fa-check"></i>Some differences between mixed models and growth curves</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#recommended-packages-that-can-do-growth-curve-models"><i class="fa fa-check"></i>Recommended packages that can do growth curve models</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#summary-of-lgc"><i class="fa fa-check"></i>Summary of LGC</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#correlation-structure-revisited"><i class="fa fa-check"></i>Correlation Structure Revisited</a><ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#summary-of-residual-correlation-structure"><i class="fa fa-check"></i>Summary of residual correlation structure</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#programming-languages"><i class="fa fa-check"></i>Programming languages</a><ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#r"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#python"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#julia"><i class="fa fa-check"></i>Julia</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#proprietary"><i class="fa fa-check"></i>Proprietary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#reference-texts-and-other-stuff"><i class="fa fa-check"></i>Reference texts and other stuff</a></li>
</ul></li>
<li class="divider"></li>
<li class='after'">
   <a href="https://m-clark.github.io/">
      <img src="img/mc_logo.png" style="width:25%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo">
   </a>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a href="https://github.com/m-clark/">
         <i class="fab fa-github fa-2x" aria-hidden="true"></i>
      </a>
   </div>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
         <i class="fab fa-creative-commons fa-lg"></i>
         <i class="fab fa-creative-commons-by fa-lg"></i>
         <i class="fab fa-creative-commons-sa fa-lg"></i>
      </a>
   </div>
</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Mixed Models with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bayesian-approaches" class="section level1">
<h1>Bayesian Approaches</h1>
<p><img src="img/priorpost.png" style="display:block; margin: 0 auto; width:50%"></p>
<p>With mixed models we’ve been thinking of coefficients as coming from a distribution (normal). While we have what we are calling ‘fixed’ effects, the distinguishing feature of the mixed model is the addition of this random component. Now consider a standard regression model, i.e. no clustering. You can actually do the same thing, i.e. assume the coefficients are not fixed, but random. In this sense, the goal is to understand that distribution, and focus on it, rather than just the summary of it, e.g. the mean. However, the mean (or other central tendency) of that distribution can be treated like you’ve been doing the fixed effects in your standard models.</p>
<p>Thus you can use how you’ve been thinking about the random effects in mixed models as a natural segue to the Bayesian approach, where all parameters are random draws from a distribution. Using Bayesian versions of your favorite models takes no more syntactical effort than your standard models. The following is a standard linear regression and a mixed model in the <span class="pack">brms</span> package, but would likewise be the same for <span class="pack" style="">rstanarm</span>.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="bayesian.html#cb45-1"></a>brms<span class="op">::</span><span class="kw">brm</span>(gpa <span class="op">~</span><span class="st"> </span>occasion, <span class="dt">data =</span> gpa)</span>
<span id="cb45-2"><a href="bayesian.html#cb45-2"></a>brms<span class="op">::</span><span class="kw">brm</span>(Reaction <span class="op">~</span><span class="st"> </span>Days <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Days <span class="op">|</span><span class="st"> </span>Subject), <span class="dt">data =</span> sleepstudy)</span>
<span id="cb45-3"><a href="bayesian.html#cb45-3"></a></span>
<span id="cb45-4"><a href="bayesian.html#cb45-4"></a>rstanarm<span class="op">::</span><span class="kw">stan_lm</span>(gpa <span class="op">~</span><span class="st"> </span>occasion, <span class="dt">data =</span> gpa)</span>
<span id="cb45-5"><a href="bayesian.html#cb45-5"></a>rstanarm<span class="op">::</span><span class="kw">stan_lmer</span>(Reaction <span class="op">~</span><span class="st"> </span>Days <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Days <span class="op">|</span><span class="st"> </span>Subject), <span class="dt">data =</span> sleepstudy)</span></code></pre></div>
<p>So running the Bayesian models is not only as easy, the syntax is identical! Furthermore, just like mixed models allowed you to understand your data more deeply, the Bayesian models have the potential to do the same. Even the probabilities and intervals make more sense. With <span class="pack">rstanarm</span> and especially <span class="pack">brms</span>, you can do fairly complex models, taking you further than the standard mixed model packages, all without learning how to code the models explicitly in Stan, the probabilistic programming language that both are based on. However, when you get to that point, the modeling possibilities are only limited by your imagination.</p>
<p>You will have to learn a new inferential framework, as well as some of the nuances of the Markov Chain Monte Carlo (MCMC) approach. But you may be surprised to find that the basics come more easily than you would anticipate. Using tools like <span class="pack">brms</span> and related make it easier than ever to dive into Bayesian data analysis, and you’ve already been in a similar mindset with mixed models, so try it out some time. I have an <a href="https://m-clark.github.io/bayesian-basics/">introduction to Baysian analysis with Stan</a>, and a bit more on the Bayesian approach and mixed models in this <a href="https://m-clark.github.io/docs/mixedModels/mixedModels.html#mixed_model_7:_bayesian_mixed_model">document</a>.</p>
<div id="priors" class="section level2">
<h2>Priors</h2>
<p>The following information about priors assumes some background knowledge of Bayesian analysis, particularly for regression models. The Stan development group offers recommendations <a href="https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations">here</a>, so refer to it often. Note that Stan does not require conjugacy, in contrast to tools such as BUGS/JAGS. This frees one up to use other prior distributions as they see fit. Generally though, using some normal distribution for the fixed effects, and the package defaults for variance components, should suffice for the standard models we’ve been discussing.</p>
<div id="fixed-effects" class="section level3">
<h3>Fixed effects</h3>
<p>For fixed effect regression coefficients, normal and student t would be the most common prior distributions, but the default <span class="pack">brms</span> (and <span class="pack">rstanarm</span>) implementation does not specify any, and so defaults to a uniform/improper prior, which is a poor choice. You will want to set this for your models. Note that scaling numeric predictors benefits here just like it does with <span class="pack">lme4</span>, and makes specifying the prior easier as well.</p>
</div>
<div id="variance-components-1" class="section level3">
<h3>Variance components</h3>
<p>In Bayesian linear mixed models, the random effects are estimated parameters, just like the fixed effects (and thus are not BLUPs). The benefit to this is that getting interval estimates for them, or predictions using them, is as easy as anything else. Typically priors for variance components are half-t for the variances, as the values can only be positive, but beyond that, e.g. intercept and slope correlations, you can again just rely on the package defaults.</p>
<p>To make this more explicit, let’s say we have a situation with random intercepts and slopes, with variances 1 and .1 respectively, with a .3 correlation. The random effects, say for 10 clusters, would come from a multivariate distribution as follows.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="bayesian.html#cb46-1"></a>re_cov =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">.3</span>, <span class="fl">.3</span>, <span class="fl">.1</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb46-2"><a href="bayesian.html#cb46-2"></a>re_cov</span></code></pre></div>
<pre><code>     [,1] [,2]
[1,]  1.0  0.3
[2,]  0.3  0.1</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="bayesian.html#cb48-1"></a>mvtnorm<span class="op">::</span><span class="kw">rmvnorm</span>(<span class="dv">10</span>, <span class="dt">mean =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">sigma =</span> re_cov)</span></code></pre></div>
<pre><code>            [,1]       [,2]
 [1,] -1.1527954 -0.3505383
 [2,]  0.2528275  0.0917429
 [3,]  0.5419091  0.1836472
 [4,] -1.4590092 -0.3372898
 [5,]  2.2144300  0.7675595
 [6,]  0.7243656  0.1967476
 [7,] -0.5719243 -0.1138614
 [8,]  0.1859953  0.1632576
 [9,] -2.7474585 -0.9841823
[10,]  0.3167497  0.0926319</code></pre>
<p>The priors in the model would regard the correlation matrix, and the estimated random effects would be added to the linear predictor, as we showed in the <a href="random_intercepts.html#initial-depiction">beginning</a>.</p>
</div>
</div>
<div id="demonstration" class="section level2">
<h2>Demonstration</h2>
<p>Let’s return to our GPA model. I will add the priors for the fixed effects, and an option to speed computation by parallelizing the chains.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="bayesian.html#cb50-1"></a><span class="kw">library</span>(brms)</span>
<span id="cb50-2"><a href="bayesian.html#cb50-2"></a></span>
<span id="cb50-3"><a href="bayesian.html#cb50-3"></a>pr =<span class="st"> </span><span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">class =</span> <span class="st">&#39;b&#39;</span>)</span>
<span id="cb50-4"><a href="bayesian.html#cb50-4"></a></span>
<span id="cb50-5"><a href="bayesian.html#cb50-5"></a>bayesian_mixed =<span class="st"> </span><span class="kw">brm</span>(</span>
<span id="cb50-6"><a href="bayesian.html#cb50-6"></a>  gpa <span class="op">~</span><span class="st"> </span>occasion <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>occasion <span class="op">|</span><span class="st"> </span>student), </span>
<span id="cb50-7"><a href="bayesian.html#cb50-7"></a>  <span class="dt">data  =</span> gpa,</span>
<span id="cb50-8"><a href="bayesian.html#cb50-8"></a>  <span class="dt">prior =</span> pr,</span>
<span id="cb50-9"><a href="bayesian.html#cb50-9"></a>  <span class="dt">cores =</span> <span class="dv">4</span></span>
<span id="cb50-10"><a href="bayesian.html#cb50-10"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="bayesian.html#cb51-1"></a><span class="kw">summary</span>(bayesian_mixed)</span></code></pre></div>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: gpa ~ occasion + (1 + occasion | student) 
   Data: gpa (Number of observations: 1200) 
Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup samples = 4000

Group-Level Effects: 
~student (Number of levels: 200) 
                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)               0.21      0.02     0.18     0.25 1.00     1968     2902
sd(occasion)                0.07      0.01     0.06     0.08 1.00     1344     2211
cor(Intercept,occasion)    -0.08      0.11    -0.29     0.14 1.00     1104     1947

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     2.60      0.02     2.56     2.64 1.00     3372     3218
occasion      0.11      0.01     0.09     0.12 1.00     3141     2955

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.21      0.01     0.20     0.22 1.00     2502     2720

Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Compare to our previous results.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="bayesian.html#cb53-1"></a><span class="kw">summary</span>(gpa_mixed, <span class="dt">cor=</span> F)</span></code></pre></div>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: gpa ~ occasion + (1 + occasion | student)
   Data: gpa

REML criterion at convergence: 261

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2695 -0.5377 -0.0128  0.5326  3.1939 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 student  (Intercept) 0.045193 0.21259       
          occasion    0.004504 0.06711  -0.10
 Residual             0.042388 0.20588       
Number of obs: 1200, groups:  student, 200

Fixed effects:
            Estimate Std. Error t value
(Intercept) 2.599214   0.018357  141.59
occasion    0.106314   0.005885   18.07</code></pre>
<p>Aside from additional diagnostic information, the Bayesian results are essentially the same, but now we can continue to explore the model. The <span class="pack" style="">brms</span> package tries to use the same function names as <span class="pack" style="">lme4</span> where possible, so <span class="func" style="">ranef</span>, <span class="func" style="">fixef</span>, <span class="func" style="">VarCorr</span>, etc. are still in play. However, you can still use my functions for standard models, which will return tidy data frames.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="bayesian.html#cb55-1"></a><span class="co"># examine random effects with the usual functions, not too tidy</span></span>
<span id="cb55-2"><a href="bayesian.html#cb55-2"></a><span class="co"># ranef(bayesian_mixed)</span></span>
<span id="cb55-3"><a href="bayesian.html#cb55-3"></a>mixedup<span class="op">::</span><span class="kw">extract_random_effects</span>(bayesian_mixed)</span></code></pre></div>
<pre><code># A tibble: 400 x 7
   group_var effect    group  value    se lower_2.5 upper_97.5
   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
 1 student   Intercept 1     -0.202 0.113    -0.432      0.015
 2 student   Intercept 2     -0.209 0.114    -0.432      0.016
 3 student   Intercept 3     -0.007 0.114    -0.225      0.215
 4 student   Intercept 4     -0.095 0.115    -0.31       0.132
 5 student   Intercept 5      0.087 0.111    -0.131      0.298
 6 student   Intercept 6     -0.204 0.114    -0.428      0.013
 7 student   Intercept 7     -0.154 0.115    -0.374      0.07 
 8 student   Intercept 8      0.151 0.112    -0.07       0.37 
 9 student   Intercept 9      0.038 0.113    -0.179      0.259
10 student   Intercept 10     0.098 0.114    -0.126      0.321
# … with 390 more rows</code></pre>
<p>However, we also have some nice plotting functions. Here I plot the occasion effect, as well as the estimated predictions from the model vs. our observed GPA values.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="bayesian.html#cb57-1"></a><span class="kw">conditional_effects</span>(bayesian_mixed)</span></code></pre></div>
<p><img src="mixed_models_files/figure-html/brms-cond-pp-1.svg" width="75%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="bayesian.html#cb58-1"></a><span class="kw">pp_check</span>(bayesian_mixed)</span></code></pre></div>
<p><img src="mixed_models_files/figure-html/brms-cond-pp-2.svg" width="75%" style="display: block; margin: auto;" /></p>
<p>There is a lot more modeling we can do here as we’ll see shortly, but it’s important to know you can do the basics easily.</p>
</div>
<div id="example-models" class="section level2">
<h2>Example Models</h2>
<p>In the following I attempt to show a wide variety of (mixed) models one could do with <span class="pack">brms</span>. Typically is shown the modeling function <span class="func">brm</span>, where the syntax is <span class="pack">lme4</span>-like. Elsewhere I use the specific <span class="func">bf</span> function, which allows one to build a potentially complicated formula as a separate object to be used in the eventual modeling function. For example.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="bayesian.html#cb59-1"></a><span class="kw">brm</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> mydata, <span class="dt">family =</span> gaussian)</span>
<span id="cb59-2"><a href="bayesian.html#cb59-2"></a></span>
<span id="cb59-3"><a href="bayesian.html#cb59-3"></a>f =<span class="st"> </span><span class="kw">bf</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb59-4"><a href="bayesian.html#cb59-4"></a></span>
<span id="cb59-5"><a href="bayesian.html#cb59-5"></a><span class="kw">brm</span>(f, ...)</span></code></pre></div>
<div id="standard-mixed-models" class="section level4">
<h4>Standard mixed models</h4>
<p>Random intercept.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="bayesian.html#cb60-1"></a><span class="kw">brm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>g))</span></code></pre></div>
<p>Random intercept and random coefficient for <code>x</code>.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="bayesian.html#cb61-1"></a><span class="kw">brm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x <span class="op">|</span><span class="st"> </span>g))</span></code></pre></div>
<p>Multiple grouping structure/random effects.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="bayesian.html#cb62-1"></a><span class="kw">brm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>g1)  <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>g2))</span>
<span id="cb62-2"><a href="bayesian.html#cb62-2"></a><span class="kw">brm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>g1 <span class="op">+</span><span class="st"> </span>g2))  <span class="co"># same thing</span></span>
<span id="cb62-3"><a href="bayesian.html#cb62-3"></a></span>
<span id="cb62-4"><a href="bayesian.html#cb62-4"></a><span class="kw">brm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>g1)  <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>g1<span class="op">:</span>g2))</span></code></pre></div>
</div>
<div id="other-distributional-families" class="section level4">
<h4>Other distributional families</h4>
<p>Multiple types of ordinal models including ‘generalized’ or ‘varying coefficients’ models that include category specific effects.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="bayesian.html#cb63-1"></a><span class="kw">brm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>g), <span class="dt">family =</span> cumulative)</span>
<span id="cb63-2"><a href="bayesian.html#cb63-2"></a></span>
<span id="cb63-3"><a href="bayesian.html#cb63-3"></a><span class="co"># x has category specific effects</span></span>
<span id="cb63-4"><a href="bayesian.html#cb63-4"></a><span class="kw">brm</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">cs</span>(x) <span class="op">+</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>g), <span class="dt">family =</span> acat)  </span>
<span id="cb63-5"><a href="bayesian.html#cb63-5"></a></span>
<span id="cb63-6"><a href="bayesian.html#cb63-6"></a><span class="co"># for ordered predictors, see the mo() function.</span></span></code></pre></div>
<p>Multinomial. Uses the categorical distribution for a standard multicategory target.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="bayesian.html#cb64-1"></a><span class="kw">brm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>g), <span class="dt">family =</span> categorical)</span></code></pre></div>
<p>Zero-inflated and hurdle models.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="bayesian.html#cb65-1"></a><span class="kw">brm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>g), <span class="dt">family =</span> <span class="kw">zero_inflated_negbinomial</span>(<span class="dt">link =</span> <span class="st">&#39;log&#39;</span>))</span>
<span id="cb65-2"><a href="bayesian.html#cb65-2"></a></span>
<span id="cb65-3"><a href="bayesian.html#cb65-3"></a><span class="kw">brm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>g), <span class="dt">family =</span> hurdle_lognormal)</span></code></pre></div>
<p>Many more including <span class="emph">weibull</span>, <span class="emph">student t</span>, <span class="emph">beta</span>, <span class="emph">skew normal</span>, <span class="emph">von mises</span>, and more.</p>
</div>
<div id="residual-structure-and-heterogeous-variances" class="section level4">
<h4>Residual structure and heterogeous variances</h4>
<p>Various functions exist to model temporal, spatial and other residual structure.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="bayesian.html#cb66-1"></a><span class="kw">brm</span>(y <span class="op">~</span><span class="st">  </span>time <span class="op">+</span><span class="st">  </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>time <span class="op">|</span><span class="st"> </span>g) <span class="op">+</span><span class="st">   </span><span class="kw">ar</span>(time, person, <span class="dt">p =</span> <span class="dv">2</span>))</span></code></pre></div>
<p>We can model the variance just like anything else.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="bayesian.html#cb67-1"></a><span class="kw">brm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>g), </span>
<span id="cb67-2"><a href="bayesian.html#cb67-2"></a>    sigma <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>g))</span></code></pre></div>
<p>We can allow the variance components themselves to vary by some group. In the following we’d have separate variances for male and female.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="bayesian.html#cb68-1"></a><span class="kw">brm</span>(count <span class="op">~</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span><span class="kw">gr</span>(g, <span class="dt">by =</span> Sex)))</span></code></pre></div>
<p>Multi-membership models, where individuals may belong to more than one cluster can also be used. In the following, <code>g1</code> and <code>g2</code> are identical conceptually, but may take on different values for some observations.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="bayesian.html#cb69-1"></a><span class="kw">brm</span>(y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span><span class="kw">mm</span>(g1, g2))) </span></code></pre></div>
</div>
<div id="multivariate-mixed-models" class="section level4">
<h4>Multivariate mixed models</h4>
<p>For multiple outcomes we can allow random effects to be correlated. In the following, <code>ID1</code> is an arbitrary label that serves to connect/correlate the modeled random effects across multiple outcomes <code>y1</code> and <code>y2</code>. In SEM literature this would be akin to a parallel process model if we add a random slope for a time indicator variable.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="bayesian.html#cb70-1"></a><span class="kw">bf</span>(</span>
<span id="cb70-2"><a href="bayesian.html#cb70-2"></a>  y1 <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID1 <span class="op">|</span>g),</span>
<span id="cb70-3"><a href="bayesian.html#cb70-3"></a>  y2 <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID1 <span class="op">|</span>g)</span>
<span id="cb70-4"><a href="bayesian.html#cb70-4"></a>)</span></code></pre></div>
<p>Such an approach would also make sense for zero-inflated models for example, where we want random effects for the same clustering to be correlated for both the count model and zero-inflated model.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="bayesian.html#cb71-1"></a><span class="kw">bf</span>(y  <span class="op">~</span><span class="st"> </span>x <span class="op">*</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x <span class="op">|</span><span class="st"> </span>ID1 <span class="op">|</span><span class="st"> </span>g), </span>
<span id="cb71-2"><a href="bayesian.html#cb71-2"></a>   zi <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID1 <span class="op">|</span><span class="st"> </span>g))</span></code></pre></div>
</div>
<div id="additive-mixed-models" class="section level4">
<h4>Additive mixed models</h4>
<p>Much of the basic functionality of <span class="pack">mgcv</span> is incorporated, and works with the same syntax.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="bayesian.html#cb72-1"></a><span class="kw">brm</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(x) <span class="op">+</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>g))</span></code></pre></div>
</div>
<div id="nonlinear-mixed-models" class="section level4">
<h4>Nonlinear mixed models</h4>
<p>We can model similar situations where the functional form is known, as with <span class="pack">nlme</span>.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="bayesian.html#cb73-1"></a><span class="kw">bf</span>(</span>
<span id="cb73-2"><a href="bayesian.html#cb73-2"></a>  y  <span class="op">~</span><span class="st"> </span>a1 <span class="op">-</span><span class="st"> </span>a2<span class="op">^</span>x, </span>
<span id="cb73-3"><a href="bayesian.html#cb73-3"></a>  a1 <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, </span>
<span id="cb73-4"><a href="bayesian.html#cb73-4"></a>  a2 <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>(x <span class="op">|</span><span class="st"> </span>g), </span>
<span id="cb73-5"><a href="bayesian.html#cb73-5"></a>  <span class="dt">nl =</span> <span class="ot">TRUE</span></span>
<span id="cb73-6"><a href="bayesian.html#cb73-6"></a>)</span></code></pre></div>
</div>
<div id="censored-and-truncated-targets" class="section level4">
<h4>Censored and truncated targets</h4>
<p>For censored data, just supply the censoring variables as you would typically note in a survival/event-history model.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="bayesian.html#cb74-1"></a><span class="kw">bf</span>(y <span class="op">|</span><span class="st"> </span><span class="kw">cens</span>(censor_variable) <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>g), <span class="dt">family =</span> lognormal)  <span class="co"># frailty</span></span>
<span id="cb74-2"><a href="bayesian.html#cb74-2"></a></span>
<span id="cb74-3"><a href="bayesian.html#cb74-3"></a><span class="co"># see also stan_jm in the rstanarm package for joint models</span></span></code></pre></div>
<p>For truncated models, specify the lower bound, upper bound, or both.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="bayesian.html#cb75-1"></a><span class="kw">brm</span>(count <span class="op">|</span><span class="st"> </span><span class="kw">trunc</span>(<span class="dt">ub =</span> <span class="dv">10</span>) <span class="op">~</span><span class="st"> </span>x <span class="op">*</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>g), <span class="dt">family =</span> poisson)</span></code></pre></div>
</div>
<div id="measurment-error" class="section level4">
<h4>Measurment error</h4>
<p>There may be cases where we know one variable is assumed to be measured with error, such as the mean of several trials, or latent variables estimated by some other means. In the following, <code>sdx</code> is the known standard deviation for x, which may be constant or vary by observation.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="bayesian.html#cb76-1"></a><span class="kw">brm</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">me</span>(x, sdx) <span class="op">+</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>g))</span></code></pre></div>
</div>
<div id="mixture-models" class="section level4">
<h4>Mixture models</h4>
<p>Two clusters specified by multiple families along with <code>mixture</code>. So I guess this is technically a mixture mixed model.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="bayesian.html#cb77-1"></a><span class="kw">brm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>g), <span class="dt">family =</span> <span class="kw">mixture</span>(gaussian, gaussian))</span></code></pre></div>
<p>A ‘growth mixture model’.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="bayesian.html#cb78-1"></a><span class="kw">brm</span>(y <span class="op">~</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>time <span class="op">|</span><span class="st"> </span>g), <span class="dt">family =</span> <span class="kw">mixture</span>(gaussian, gaussian))</span></code></pre></div>
</div>
<div id="missing-values" class="section level4">
<h4>Missing Values</h4>
<p>We can construct the model formula for missing values as follows, including using a mixed model as the imputation model (for <code>x</code>).</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="bayesian.html#cb79-1"></a>f =<span class="st"> </span></span>
<span id="cb79-2"><a href="bayesian.html#cb79-2"></a><span class="st">  </span><span class="kw">bf</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">mi</span>(x) <span class="op">+</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>g)) <span class="op">+</span></span>
<span id="cb79-3"><a href="bayesian.html#cb79-3"></a><span class="st">  </span><span class="kw">bf</span>(x <span class="op">|</span><span class="st"> </span><span class="kw">mi</span>() <span class="op">~</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>g)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb79-4"><a href="bayesian.html#cb79-4"></a><span class="st">  </span><span class="kw">set_rescor</span>(<span class="ot">FALSE</span>)</span></code></pre></div>
</div>
</div>
<div id="beyond-the-model" class="section level2">
<h2>Beyond the Model</h2>
<p>The development of Stan and packages like <span class="pack">rstanarm</span> and <span class="pack">brms</span> is rapid, and with the combined powers of those involved, there are a lot of useful tools for exploring the model results. Even if one found a specialty package for a specific type of mixed model, it is doubtful you would have as many tools for model exploration such as posterior predictive checks, marginal effects, model comparison, basic model diagnostics and more. That said, the Stan ecosystem of R packages is notable at this point, and so use what works for your situation.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="issues.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="further.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["twitter", "facebook", "linkedin", "google", "weibo", "instapaper"],
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/m-clark/mixed-models-with-R/blob/master/bayesian.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"depth": 2,
"scroll_highlight": true
},
"df_print": "kable",
"highlight": "pygments",
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
