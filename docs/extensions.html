<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Common Extensions | Mixed Models in R</title>
  <meta name="description" content="This is an introduction to mixed models in R. It covers a many of the most common techniques employed in such models, and relies heavily on the lme4 package. The basics of random intercepts and slopes models, crossed vs. nested models, etc. are covered. Discussion includes extensions into generalized mixed models and realms beyond.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Common Extensions | Mixed Models in R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://m-clark.github.io/mixed-models-with-R/" />
  <meta property="og:image" content="https://m-clark.github.io/mixed-models-with-R/img/nineteeneightyR.png" />
  <meta property="og:description" content="This is an introduction to mixed models in R. It covers a many of the most common techniques employed in such models, and relies heavily on the lme4 package. The basics of random intercepts and slopes models, crossed vs. nested models, etc. are covered. Discussion includes extensions into generalized mixed models and realms beyond." />
  <meta name="github-repo" content="m-clark/mixed-models-with-R/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Common Extensions | Mixed Models in R" />
  
  <meta name="twitter:description" content="This is an introduction to mixed models in R. It covers a many of the most common techniques employed in such models, and relies heavily on the lme4 package. The basics of random intercepts and slopes models, crossed vs. nested models, etc. are covered. Discussion includes extensions into generalized mixed models and realms beyond." />
  <meta name="twitter:image" content="https://m-clark.github.io/mixed-models-with-R/img/nineteeneightyR.png" />



<meta name="date" content="2019-02-07">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  <link rel="shortcut icon" href="img/R.ico" type="image/x-icon">
<link rel="prev" href="random_slopes.html">
<link rel="next" href="issues.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.5/datatables.js"></script>
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<script src="libs/plotly-binding-4.8.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.39.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.39.2/plotly-latest.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/viz-0.3/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.0/grViz.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/book.css" type="text/css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class='before'><a href="./">Mixed Models with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#overview"><i class="fa fa-check"></i>Overview</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#goals"><i class="fa fa-check"></i>Goals</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#initial-steps"><i class="fa fa-check"></i>Initial Steps</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#key-packages"><i class="fa fa-check"></i>Key packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html"><i class="fa fa-check"></i>Mixed Models</a><ul>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#terminology"><i class="fa fa-check"></i>Terminology</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#kinds-of-clustering"><i class="fa fa-check"></i>Kinds of clustering</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#random-intercepts-model"><i class="fa fa-check"></i>Random Intercepts model</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#example-student-gpa"><i class="fa fa-check"></i>Example: student GPA</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#the-standard-regression-model"><i class="fa fa-check"></i>The standard regression model</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#the-mixed-model"><i class="fa fa-check"></i>The mixed model</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#application"><i class="fa fa-check"></i>Application</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#cluster-level-covariate"><i class="fa fa-check"></i>Cluster level covariate</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#summary"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#exercises"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#sleep"><i class="fa fa-check"></i>Sleep</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#cluster-level-covariate-1"><i class="fa fa-check"></i>Cluster level covariate</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#simulation"><i class="fa fa-check"></i>Simulation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="random_slopes.html"><a href="random_slopes.html"><i class="fa fa-check"></i>More Random Effects</a><ul>
<li class="chapter" data-level="" data-path="random_slopes.html"><a href="random_slopes.html#application-1"><i class="fa fa-check"></i>Application</a></li>
<li class="chapter" data-level="" data-path="random_slopes.html"><a href="random_slopes.html#comparison-to-many-regressions"><i class="fa fa-check"></i>Comparison to many regressions</a></li>
<li class="chapter" data-level="" data-path="random_slopes.html"><a href="random_slopes.html#visualization-of-effects"><i class="fa fa-check"></i>Visualization of effects</a></li>
<li class="chapter" data-level="" data-path="random_slopes.html"><a href="random_slopes.html#summary-1"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="random_slopes.html"><a href="random_slopes.html#exercises-1"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html"><i class="fa fa-check"></i>Common Extensions</a><ul>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#additional-grouping-structure"><i class="fa fa-check"></i>Additional Grouping Structure</a><ul>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#cross-classified-models"><i class="fa fa-check"></i>Cross-classified models</a></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#hierarchical-structure"><i class="fa fa-check"></i>Hierarchical Structure</a></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#crossed-vs.nested"><i class="fa fa-check"></i>Crossed vs. Nested</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#residual-structure"><i class="fa fa-check"></i>Residual Structure</a><ul>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#heterogeneous-variance"><i class="fa fa-check"></i>Heterogeneous Variance</a></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#autocorrelation"><i class="fa fa-check"></i>Autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#generalized-linear-mixed-models"><i class="fa fa-check"></i>Generalized Linear Mixed Models</a></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#exercises-2"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#sociometric-data"><i class="fa fa-check"></i>Sociometric data</a></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#patents"><i class="fa fa-check"></i>Patents</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html"><i class="fa fa-check"></i>Issues</a><ul>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#variance-accounted-for"><i class="fa fa-check"></i>Variance accounted for</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#alternative-approaches-to-mixed-models"><i class="fa fa-check"></i>Alternative approaches to mixed models</a><ul>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#growth-curve-models"><i class="fa fa-check"></i>Growth curve models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#sample-sizes"><i class="fa fa-check"></i>Sample sizes</a><ul>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#small-number-of-clusters"><i class="fa fa-check"></i>Small number of clusters</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#small-n-within-cluster"><i class="fa fa-check"></i>Small N within cluster</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#balancedmissing-values"><i class="fa fa-check"></i>Balanced/Missing values</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#big-data"><i class="fa fa-check"></i>Big Data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#model-comparison"><i class="fa fa-check"></i>Model Comparison</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#convergence"><i class="fa fa-check"></i>Convergence</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="further.html"><a href="further.html"><i class="fa fa-check"></i>Going Further</a><ul>
<li class="chapter" data-level="" data-path="further.html"><a href="further.html#bayesian"><i class="fa fa-check"></i>Bayesian</a></li>
<li class="chapter" data-level="" data-path="further.html"><a href="further.html#other-distributions"><i class="fa fa-check"></i>Other distributions</a></li>
<li class="chapter" data-level="" data-path="further.html"><a href="further.html#other-contexts"><i class="fa fa-check"></i>Other contexts</a></li>
<li class="chapter" data-level="" data-path="further.html"><a href="further.html#nonlinear-mixed-effects"><i class="fa fa-check"></i>Nonlinear Mixed Effects</a></li>
<li class="chapter" data-level="" data-path="further.html"><a href="further.html#connections"><i class="fa fa-check"></i>Connections</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html"><i class="fa fa-check"></i>Supplemental</a><ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#a-comparison-to-latent-growth-curve-models"><i class="fa fa-check"></i>A Comparison to Latent Growth Curve Models</a><ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#random-effects-as-latent-variables"><i class="fa fa-check"></i>Random Effects as Latent Variables</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#random-effects-in-sem"><i class="fa fa-check"></i>Random Effects in SEM</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#running-a-growth-curve-model"><i class="fa fa-check"></i>Running a Growth Curve Model</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#random-intercepts"><i class="fa fa-check"></i>Random Intercepts</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#random-intercepts-and-slopes"><i class="fa fa-check"></i>Random Intercepts and Slopes</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#random-effects-with-heterogeneous-variances"><i class="fa fa-check"></i>Random Effects with Heterogeneous Variances</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#other-covariates"><i class="fa fa-check"></i>Other covariates</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#some-differences-between-mixed-models-and-growth-curves"><i class="fa fa-check"></i>Some Differences between Mixed Models and Growth Curves</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#recommended-packages-that-can-do-lgc-models"><i class="fa fa-check"></i>Recommended Packages that can do LGC models</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#summary-3"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#bayesian-mixed-models"><i class="fa fa-check"></i>Bayesian Mixed Models</a><ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#priors"><i class="fa fa-check"></i>Priors</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#example-models"><i class="fa fa-check"></i>Example Models</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#beyond-the-model"><i class="fa fa-check"></i>Beyond the Model</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#summary-4"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#programming-languages"><i class="fa fa-check"></i>Programming languages</a><ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#r"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#python"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#julia"><i class="fa fa-check"></i>Julia</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#proprietary"><i class="fa fa-check"></i>Proprietary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#reference-texts-and-other-stuff"><i class="fa fa-check"></i>Reference texts and other stuff</a></li>
</ul></li>
<li class="divider"></li>
<li class='after'">
   <a href="https://m-clark.github.io/">
      <img src="img/mc_logo.png" style="width:25%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo">
   </a>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a href="https://github.com/m-clark/">
         <i class="fab fa-github fa-2x" aria-hidden="true"></i>
      </a>
   </div>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
         <i class="fab fa-creative-commons fa-lg"></i>
         <i class="fab fa-creative-commons-by fa-lg"></i>
         <i class="fab fa-creative-commons-sa fa-lg"></i>
      </a>
   </div>
</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Mixed Models in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="common-extensions" class="section level1">
<h1>Common Extensions</h1>
<div id="additional-grouping-structure" class="section level2">
<h2>Additional Grouping Structure</h2>
<div id="cross-classified-models" class="section level3">
<h3>Cross-classified models</h3>
<p>Oftentimes there will be additional sources of variance beyond one grouping factor. Consider as an example, a visual perception experiment where there are multiple trials for each individual, along with specific images displayed. Such data might look like this.</p>
<div id="htmlwidget-1fe403c81784621152ab" style="width:250px;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-1fe403c81784621152ab">{"x":{"filter":"none","data":[[1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20],["a","b","c","d","e","f","g","h","i","j","a","b","c","d","e","f","g","h","i","j","a","b","c","d","e","f","g","h","i","j","a","b","c","d","e","f","g","h","i","j","a","b","c","d","e","f","g","h","i","j","a","b","c","d","e","f","g","h","i","j","a","b","c","d","e","f","g","h","i","j","a","b","c","d","e","f","g","h","i","j","a","b","c","d","e","f","g","h","i","j","a","b","c","d","e","f","g","h","i","j","a","b","c","d","e","f","g","h","i","j","a","b","c","d","e","f","g","h","i","j","a","b","c","d","e","f","g","h","i","j","a","b","c","d","e","f","g","h","i","j","a","b","c","d","e","f","g","h","i","j","a","b","c","d","e","f","g","h","i","j","a","b","c","d","e","f","g","h","i","j","a","b","c","d","e","f","g","h","i","j","a","b","c","d","e","f","g","h","i","j","a","b","c","d","e","f","g","h","i","j"],[4,1,5,10,9,2,6,8,3,3,2,5,10,7,9,3,7,6,9,5,5,6,2,4,3,3,2,5,10,9,2,8,3,3,7,6,4,6,1,5,6,10,2,8,1,9,2,7,9,3,5,9,7,7,3,5,5,3,5,4,10,10,10,4,8,7,2,6,4,5,5,1,7,10,2,8,7,8,8,3,4,4,7,5,1,10,6,6,8,8,4,5,3,8,5,1,10,8,4,10,5,2,1,9,9,1,4,3,10,6,2,5,7,8,1,8,10,1,7,8,9,2,8,10,10,3,10,9,2,2,8,1,3,4,5,1,1,4,6,6,1,4,3,4,5,4,3,8,6,6,9,6,4,2,7,3,4,7,6,9,7,2,8,9,7,6,1,7,1,4,9,1,3,8,7,9,5,10,6,9,10,9,1,6,10,4,7,2,6,9,3,8,9,3,7,1,6,9,2,7]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Person<\/th>\n      <th>Image<\/th>\n      <th>score<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tp","autoWidth":false,"columnDefs":[{"width":"10px","targets":[0,1,2]},{"className":"dt-center","targets":[0,1,2]}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p><br>
<br></p>
<p>In such a case we have observations clustered within both person and image, but person and image are not nested within one another- all participants see all 10 images. Such a situation is typically referred to as one in which there are <span class="emph">crossed</span> random effects, which just means non-nested. In the situations we’ll look at next, we will have multiple sources variances to consider.</p>
<div id="example-student-achievement" class="section level4">
<h4>Example: Student achievement</h4>
<p>For our own demonstration we’ll look at achievement scores for students. The sources of dependency are due to students having gone to the same primary or secondary schools. However, in this example, going to a primary school doesn’t necessarily mean you’ll go to a specific secondary school. Note also that there are no repeated measures, we see each student only once. Here’s a quick look a the data, and for more detail, check the <a href="appendix.html#data">appendix</a>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&#39;data/pupils.RData&#39;</span>)</code></pre>
<p><div id="htmlwidget-ed78248b32e6634f28e5" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ed78248b32e6634f28e5">{"x":{"filter":"none","data":[[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999,1000],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,43,43,43,43,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,50,50],[2,1,17,3,4,4,4,17,14,22,1,5,1,20,30,15,5,15,22,19,19,7,22,8,4,15,6,23,29,6,5,14,19,19,7,22,9,2,22,14,7,1,19,6,11,8,6,14,9,14,2,17,19,15,8,29,15,9,9,5,23,12,20,4,7,7,8,19,17,5,19,22,8,30,6,11,23,4,17,14,5,4,8,3,3,19,2,1,9,14,12,3,15,22,6,11,7,2,7,12,8,2,6,3,30,8,15,9,17,19,7,1,14,2,9,6,15,3,9,8,15,3,15,23,1,1,23,14,6,7,4,20,9,23,4,23,12,1,19,12,17,24,1,9,11,4,9,16,1,4,19,10,11,5,4,4,7,10,10,7,24,19,22,17,3,8,19,22,6,1,3,6,2,12,12,19,16,6,2,19,17,2,23,2,2,24,1,23,12,22,23,8,2,11,4,24,2,29,4,3,6,12,6,19,6,22,7,5,19,14,3,19,26,12,5,17,11,14,10,24,1,25,7,10,8,10,14,6,22,25,5,7,17,14,3,19,4,2,16,1,1,12,20,2,28,19,1,26,3,5,17,14,8,22,5,14,7,30,23,17,12,14,1,4,3,5,7,16,23,8,21,16,2,25,11,8,2,25,19,19,8,2,8,8,16,5,4,21,6,2,6,21,5,26,2,25,19,25,21,7,4,14,21,3,19,11,21,23,12,17,2,13,7,2,17,13,19,6,25,27,5,16,5,21,19,3,13,4,8,10,2,14,25,8,23,6,23,14,7,1,25,19,5,23,5,4,16,27,26,17,5,21,23,21,11,22,23,14,6,23,26,11,21,25,19,13,26,27,25,2,4,16,22,13,6,15,3,11,7,28,14,2,10,11,7,13,23,19,14,7,17,27,10,19,7,3,10,16,4,26,6,28,18,25,16,10,2,11,25,10,4,21,11,18,21,11,23,22,27,27,2,25,22,11,21,19,21,23,13,5,10,2,25,27,30,26,6,2,7,26,21,27,27,11,14,13,6,21,21,19,18,19,3,16,10,3,25,10,3,13,6,28,10,8,26,7,3,27,6,14,6,23,27,18,21,7,27,2,21,28,4,19,16,19,4,25,26,1,18,27,19,2,14,30,25,27,14,1,22,3,8,27,27,22,28,28,4,28,16,6,11,11,16,5,21,19,14,10,7,14,11,7,11,14,18,28,18,6,10,28,6,8,16,23,8,16,28,13,6,19,18,11,10,21,23,21,10,16,16,22,13,18,7,21,6,14,3,13,16,27,10,14,6,8,13,3,28,6,7,10,14,22,27,26,14,18,28,26,23,28,20,13,5,21,24,16,4,22,7,21,14,16,20,25,22,14,20,14,29,11,6,16,15,28,4,28,16,26,10,10,6,5,8,21,26,22,4,18,22,10,14,28,28,24,16,28,10,11,29,18,21,14,21,10,26,27,24,8,23,14,16,18,4,27,10,29,29,16,8,5,27,21,16,14,16,11,13,13,11,4,18,14,28,16,18,11,14,4,14,11,20,27,26,11,14,29,6,13,18,21,28,6,28,7,11,25,26,6,14,5,16,13,26,4,5,24,5,29,6,22,18,6,21,8,28,18,26,10,10,24,13,5,28,28,10,24,13,8,20,11,28,15,21,1,7,20,27,3,18,29,25,13,22,18,8,27,7,1,13,7,26,8,10,24,10,28,25,26,28,20,13,9,25,15,16,18,18,29,18,18,22,22,28,11,6,27,26,24,28,28,11,21,9,10,10,10,18,29,28,20,11,29,9,27,20,30,28,29,18,18,20,16,26,9,15,27,15,5,16,27,23,16,16,24,28,24,15,18,18,9,22,6,22,9,11,27,26,26,7,6,6,28,13,25,27,11,30,24,13,13,26,16,29,29,22,29,22,6,10,1,10,27,29,30,22,29,10,24,26,9,27,15,25,16,18,13,20,29,30,26,26,21,7,17,24,22,30,18,15,17,9,7,12,10,29,10,25,27,26,30,29,16,27,25,21,13,30,16,6,13,10,7,12,17,20,29,30,29,21,24,20,12,30,20,1,30,17,15,16,30,21,21,13,15,20,18,29,30,24,24,25,10,25,22,17,29,12,7,28,30,22,29,10,27,28,21,15,30,29,29,28,7,18,21,24,20,18,28,12,29,17,25,24,12,10,1,29,15,28,12,27,29,21,7,30,13,30,30,20,10,22,29,15,30,28,28,30,17,30,27,28,12,28,25,21,1,17,9,28,13,8,12,30,22,29,29,17,13,28,28],[6.6,5.7,4.5,4.4,5.8,5,4.9,5.3,9,5.4,5.9,6.6,6.3,6.3,5.9,4.6,6.4,6.1,5,6.8,6.4,6.7,5.8,7.6,6.2,6.8,6.4,7.8,6.7,6.3,6.7,7.8,6,6.6,6.6,6.8,5.6,6.9,6.4,5.8,7.5,6.3,8.4,8.4,7.2,7.4,6.6,6.9,7.1,7.4,7,5.4,7.4,6.9,7.5,6.6,7.2,6,5,7.1,6.2,7.3,7.4,6.6,7.7,7.5,7.8,7.4,6.7,6.8,6.4,6.9,7.7,7.1,7.8,6.8,6.2,7.8,6.4,7.5,6.6,5.9,6.9,6.6,5.8,6.7,7.5,6.2,5.6,6.7,7.7,6.8,7.1,6.4,6,6.9,6,6,6.2,7.1,5.7,5.2,5.6,6.8,5.8,5.9,5.9,6.4,5.6,6.5,7.3,5.9,7.3,7.5,6.3,7.4,7.5,6.3,6.2,6,6,7.9,8.2,6.9,6.6,7.1,6.6,6.5,5.7,6,6.3,4.7,5.7,5.8,6.4,6.1,6,4.5,6.7,6.7,4.7,6.1,5.7,4.9,7.7,6,6,7.5,5.3,5.6,5.3,5.1,6.8,5.2,6.9,6.2,5.6,5.8,3.9,6.6,5,5.7,4.7,5.4,6,4.3,6.6,5.4,5.6,5.6,7.1,6.7,5.1,7.1,6.2,6.2,7.1,7.2,6.9,6.8,5.6,6.4,5.9,6.6,8.2,6.7,6.9,5.5,6.2,7.1,5.6,6.4,6.5,6.4,5.5,6.8,5.9,6.3,7.1,6.2,6.7,6.7,4.9,5.9,7.1,5.6,5.2,5.9,7.6,7,5.5,6.2,6.3,5.2,7.4,5.4,6.7,5.3,4,4,5,5.5,4.8,5.7,4.8,5.4,5.2,4.8,5.7,4.9,6.4,5.8,5.4,5.3,5.2,6.1,5.9,5.8,5.3,4.8,4.3,4.3,5.8,5.5,5.8,6.7,6.4,6.6,6.7,6.7,4.6,6.3,6.9,6.3,6.6,6.1,4.3,6.3,7.2,4.9,5.3,7.3,6.1,6.1,6.4,7.8,7.8,6.2,6.4,5.8,6.4,6.1,8.4,7.7,7.3,7.3,6.4,6.9,6.6,7.3,6.9,6.1,7.1,5.6,6.5,6.2,6.1,5.4,6.8,6.6,6.1,6.8,6.8,5.3,5.8,6.7,7.4,5.8,7.3,6.8,5.9,6.6,6.4,5.6,5.8,6.7,7.2,6.2,6.2,6.3,6.5,7.1,8.5,5.9,5.4,6.4,6.9,7.5,8.3,8,6.3,6.9,5.4,7.6,5.9,7.6,6.2,6.3,5.1,5.5,5.6,5.9,6.4,5.6,5.1,5,4.3,6.8,4.4,5,5.8,6.2,5.3,5.4,6.7,7.3,6.7,7.6,9.7,6,6,5.9,8.1,6.2,9.9,8.3,8.4,6.9,7.4,6.9,7.6,8.1,7.1,7.7,6.3,8.2,9.5,7.8,5.9,6.6,6.4,6.8,5.6,6.7,6.7,7,5.9,7.8,6.2,6.5,7.7,7.2,6.2,6.8,6.2,6.4,6.2,5.9,7.4,5.6,5.9,6,6.4,7,7,6.6,6.1,6.2,7.4,7,6.2,6.9,7.2,7.4,6.5,6.2,7.7,6.3,7.2,5.7,4.7,6.7,7.8,6,5.9,6,5.8,5.1,6.3,5.7,6.8,5.1,5.7,7.4,6.8,5.9,6.1,5.7,7.3,7.5,5,6.8,6.6,6.1,7.6,7.4,6.3,5.9,7.6,7.8,6.3,6.7,7.4,5.8,6,5.4,5.9,5.9,5.6,6,6.3,5.8,6.7,6.2,4.5,6,5.6,6.9,7,6.8,6.9,8.9,6.3,8.7,7.2,8.8,6.3,6.8,7,9.1,6.2,5.6,5.8,5.9,6.3,6.3,5.3,6.9,6.6,6.8,6.7,7.2,5.8,6.5,6.1,6.4,6.1,6,6.8,6.5,6.2,4.8,7.3,6.3,6.7,7.6,6,5.7,6.3,6.3,5.1,7,5.7,7.3,6.5,6.9,4.9,6.3,7.1,6.3,7.6,6.1,6.2,6.2,6.4,5.9,5.7,7,5.9,4.9,5.1,5,7.2,6.1,5.1,5.4,4.4,5.1,4.3,4.8,5.9,6.5,6.7,6.9,7.1,6.7,6.1,6.1,7.3,5.5,5.8,7.3,5.2,7.8,6.2,6.9,5.7,6.5,6.6,5.6,6.6,5.9,6.2,7.3,5,5,6.6,6.2,7,5.6,5.2,5.5,6,6.1,5.5,5.9,5.4,5.6,5.8,5.6,5.3,5.7,6.1,6.7,6.5,5.5,5.8,7.5,6.2,7,5.7,6.3,7.3,4.9,6.4,6.4,7,6.5,6.8,7,8.5,6.8,6.2,6.9,6.5,6.8,5.7,7.9,6.3,6.6,6.2,4.7,5.6,7.4,5.5,7.5,6.9,7.8,7,6.2,6.7,5.7,5.8,6.7,7.7,4.6,5.5,4.6,5.3,5,6.7,6.2,6.4,6.8,5.7,5.5,5.2,6.7,7.3,6.1,5.4,6.7,7,6.8,6.5,6.2,5,6.1,6.4,6.4,7.2,6,4.1,6.9,6.3,6.3,6.8,6.5,6.5,5.8,4.9,6.2,6.2,7,5.9,5.7,6.2,5.8,7.2,5.9,6,7.2,5.5,6.3,4.5,6.6,5.8,6.1,6.9,6.8,5.7,6.6,5.7,6,6.9,6,5.8,6.2,4.8,5.9,4.4,4.7,5.1,5.6,6.1,7.3,7.2,6.6,6.1,7,7.5,6.9,6.3,7.2,6.2,6.2,5.5,6,6.8,5,5.6,7.4,6.8,8.4,7.5,7.5,8.7,8.2,6.4,5.3,7.9,6.4,5.8,8.1,6.8,5.3,6.5,7.3,6.4,7.7,7.7,7.9,6.2,6.4,7.2,6.5,6.9,7.1,5.7,6.1,7,7.4,5.6,5.6,5.7,5,5.6,5.5,6.7,6.5,7.7,6.9,5.9,6.9,5.6,7.2,5.6,5.8,6.3,5.6,7.1,7.3,5.5,7.9,7.7,5,5.7,5.4,4.4,6.6,5.4,6.7,8,6.5,5.6,6.2,5.4,6.7,7,6.1,6.4,4.9,5.5,6.8,5.3,5.2,6.6,5.9,5.6,5.9,6.1,5.6,6.2,6.9,6.1,6.5,6,6.5,5.3,5,5.8,6,7,6.8,7.1,7.1,5.8,7.6,6.4,6.4,6.2,6.4,6.6,8.2,7.7,6.2,7.1,5.7,6,6.7,6.6,5.7,5.8,6.8,7.7,5.5,5.4,6.4,6.3,6.1,6.5,6.5,6.6,6.7,5.6,7.4,6.6,6.3,5.7,6.6,6.2,7.7,5.9,6,6.8,6.3,6.6,5.4,6.3,6.5,5.7,6.7,5.7,7.2,5.4,6.5,5.6,6.2,6.8,6.9,7.4,6.1,6.3,5.8,6.5,7.3,7.2,6.8,5.2,7.4,6.4,6.4,5.3,5.8,7.3,5.3,5.4,5.6,5.9,5.5,5.7,7.3,6.7,5.2,5.8,4.6,6.8,6.2,5.1,7.1,7,6.2,7.1,5.4,6.9,6.5,6.7,6,6.2,7.8,6.1,5.7,6.3,6,7.2,6.8,6.8,6.5,7.3,7.2,7.8,6.7,6,8.2,6.5,7.2,5.9,7.4,5.6,7.1,6.6,5.9,7.1,6.7,5.4,6,6.1,5.7,6.4,6.8,5.2,5.8,7.1,4.9,7.1,5.6,6.2,6.6,6.6,5.7,6.2,6.1,7.4,5.8,5.8,6.7,7.9,7.1,5.9,7.4,6.7,6.4,5.2,5.5,6.3,4.9,6.7,6.9,6.6,6.4,7.3,6.2,5.6,5.9,6.8,4.9,6.2,6.6,7.5,6.3,5.8,5.8,6.6,5.2,6.5,6.2,7.8,4.2,5.7,5.9,6.6,6.2,7.1,7.3,6.3,5.7,6.2,5.6,6.2,6.3,5.9,7.4,6.1,6.8,8.2,4.5,6.9,5.3,6.8,6.8,6.1,6.4,5.7,5.9,6.3,5.4,6.8,6.3,6.8,6],["female","male","male","male","male","female","male","female","male","male","male","male","female","male","male","female","female","female","male","female","female","female","female","male","female","male","female","female","female","female","female","female","male","male","female","male","male","male","male","male","female","male","female","male","female","female","female","female","female","female","male","male","female","male","female","male","female","female","male","male","female","male","female","male","female","male","female","male","female","female","male","female","female","female","female","male","female","female","female","female","male","female","female","female","female","male","male","male","female","male","female","male","female","female","female","male","male","female","male","male","male","female","female","female","female","male","female","female","female","female","male","female","male","female","male","female","female","female","female","female","female","female","female","female","female","male","male","male","male","male","male","male","female","female","female","female","male","male","female","female","female","female","male","male","female","female","male","female","female","male","male","male","male","male","female","female","female","female","male","female","male","male","male","male","male","male","male","female","female","male","male","male","male","female","male","female","female","female","male","female","female","female","male","male","male","female","female","male","male","male","female","female","male","female","male","female","female","male","female","female","female","male","male","female","female","female","male","female","male","female","male","female","female","male","male","male","female","female","male","male","female","male","female","male","female","male","female","female","female","female","female","female","female","male","male","male","male","male","female","male","female","male","female","male","male","female","female","male","female","female","female","male","female","male","male","male","male","male","female","female","male","male","male","male","male","male","female","female","female","female","male","female","female","female","female","female","female","female","male","female","male","female","male","male","female","male","male","male","male","female","male","male","female","male","male","female","male","female","female","male","male","female","male","female","female","male","female","female","female","male","female","male","female","female","male","male","male","female","female","female","male","male","female","female","female","female","male","male","male","female","male","female","female","male","male","male","male","female","male","male","male","female","male","female","male","female","female","male","male","male","female","male","male","male","female","male","female","female","male","female","male","female","female","male","male","male","female","female","female","male","female","male","male","male","male","female","male","female","male","male","female","female","male","male","male","male","female","female","female","male","male","female","female","female","male","female","male","male","female","male","male","male","male","male","female","male","female","male","male","male","male","female","male","male","female","male","male","female","male","female","male","male","female","female","male","female","male","male","female","female","male","male","female","male","female","male","female","female","male","male","male","female","female","female","male","female","male","male","male","male","male","female","male","male","male","male","female","female","male","male","male","female","male","male","male","female","male","male","female","female","male","female","male","female","male","male","male","male","male","female","female","male","male","female","male","male","male","male","female","male","male","male","male","female","male","male","male","male","female","male","male","male","male","female","male","female","male","female","female","male","female","male","male","female","female","female","female","female","female","male","female","female","female","female","male","male","female","male","female","male","male","male","female","female","female","male","male","male","female","male","male","male","male","female","male","male","male","female","female","female","male","male","female","male","male","female","male","male","female","male","male","female","female","male","male","male","female","female","female","male","male","female","female","female","male","male","male","female","female","male","female","female","female","male","male","female","male","female","male","female","female","female","male","female","male","male","male","male","male","male","male","male","male","female","male","female","male","male","female","male","male","male","female","female","female","male","male","female","female","female","female","female","male","female","female","male","female","male","female","female","female","female","female","male","female","male","male","male","female","female","female","female","male","male","female","male","female","female","female","male","male","male","male","female","female","male","male","male","female","female","male","male","female","female","female","male","female","female","male","male","female","male","female","male","female","male","female","male","male","male","female","female","male","male","female","female","male","male","female","male","female","male","female","female","male","male","male","male","female","female","female","female","male","female","female","female","female","female","male","male","male","male","male","male","female","male","male","male","male","male","male","female","male","female","male","male","male","male","male","male","female","male","male","male","female","male","male","female","male","male","male","male","male","female","male","female","female","male","female","female","male","male","male","female","female","female","male","male","female","male","male","male","female","female","male","female","male","male","male","male","male","female","female","female","female","female","female","male","female","male","female","female","female","male","male","female","male","female","male","female","male","female","female","male","male","male","female","female","female","male","male","male","male","male","male","male","male","male","female","female","female","female","male","female","female","male","female","female","male","female","female","female","female","male","female","male","male","female","male","male","female","female","male","female","female","male","male","female","male","female","female","male","male","male","male","male","female","male","female","female","female","male","female","female","male","female","female","male","male","male","female","female","male","male","male","female","male","male","male","male","male","female","female","male","male","male","male","male","male","female","male","male","male","female","male","male","female","female","female","female","female","male","female","male","male","male","female","female","male","male","female","male","male","female","female","male","male","male","male","female","female","female","male","male","female","female","male","female","female","female","male","male","male","female","male","male","male","female","female","female","female","male","male","female","female","female","female","female","male","female","female","male","male","male","male","female","male","male","female","female","female","male","female","female","female","female","male","male","male","male","male","female","male","male","male","male","male","female","male","female","male","female","male","female","female","male","female","male","male","female","male","male","male","male","female","female","male","female","male","female","male","female","female","male","male","male","female","male","female","male"],["highest","lowest","2","2","3","4","3","2","highest","lowest","5","5","5","4","3","3","highest","5","2","5","2","3","lowest","5","4","4","5","4","lowest","highest","4","5","5","highest","5","5","4","5","5","5","4","2","5","3","5","4","5","5","5","3","4","4","2","4","highest","4","5","4","5","3","4","5","highest","4","2","5","highest","highest","highest","highest","3","4","5","2","lowest","lowest","5","5","4","5","highest","5","lowest","5","5","highest","highest","4","2","5","5","3","2","2","3","highest","4","5","5","highest","2","2","3","4","highest","4","2","5","5","4","3","5","5","5","2","2","lowest","5","5","3","lowest","highest","3","highest","5","4","5","4","5","5","5","highest","4","5","lowest","5","highest","5","5","5","2","2","5","3","highest","lowest","5","5","4","5","5","2","5","5","5","2","4","4","highest","5","highest","3","4","highest","highest","4","5","4","2","lowest","highest","3","5","5","5","2","2","4","4","2","3","lowest","5","4","4","lowest","4","4","highest","5","3","4","5","2","5","5","2","lowest","4","4","highest","4","3","5","2","3","5","4","4","4","5","4","4","4","5","highest","4","4","3","4","highest","5","3","5","3","4","5","5","lowest","3","highest","5","3","5","5","highest","highest","highest","4","highest","4","3","4","2","4","lowest","3","3","5","5","lowest","highest","5","lowest","5","3","5","5","2","5","5","4","4","2","4","5","4","4","2","4","3","2","highest","4","3","4","5","3","highest","5","3","4","4","5","5","5","2","3","5","4","3","5","2","lowest","3","highest","5","3","5","3","3","5","3","lowest","5","3","3","5","5","2","4","highest","5","3","lowest","4","3","5","highest","5","3","highest","lowest","5","4","5","5","2","highest","5","5","lowest","5","5","5","5","5","5","lowest","highest","highest","highest","5","5","highest","4","2","5","highest","5","lowest","lowest","5","4","5","highest","5","5","4","3","4","5","lowest","5","4","highest","highest","5","5","4","lowest","highest","2","5","highest","5","3","highest","3","4","4","4","4","4","3","5","4","3","highest","3","highest","5","2","4","highest","3","4","4","2","5","4","5","2","highest","5","5","5","4","5","2","2","4","5","3","5","4","3","3","3","5","2","4","5","5","3","3","5","5","4","highest","2","5","4","3","3","highest","5","lowest","highest","5","2","highest","4","4","4","3","4","3","5","5","4","2","5","5","5","3","2","3","5","5","3","highest","4","5","5","highest","lowest","5","5","5","4","4","5","highest","3","highest","4","5","4","5","2","highest","highest","2","4","3","2","5","highest","3","highest","lowest","5","3","highest","3","5","4","3","3","3","2","4","4","5","lowest","4","2","3","4","3","5","4","highest","lowest","highest","4","highest","5","3","4","3","highest","5","4","4","5","3","4","5","4","3","5","2","5","highest","5","highest","2","5","2","5","3","highest","5","4","4","3","3","highest","5","highest","5","5","3","3","4","4","highest","5","3","3","3","2","2","5","2","5","4","3","4","2","5","2","lowest","highest","2","4","5","highest","4","2","5","5","4","3","4","3","3","4","4","5","4","3","5","2","lowest","4","5","4","4","2","2","4","5","highest","5","5","5","5","lowest","4","2","4","4","5","2","5","5","3","highest","highest","highest","4","highest","lowest","2","3","4","5","2","4","highest","5","4","5","lowest","5","2","5","4","5","highest","4","3","4","5","2","highest","highest","3","highest","highest","4","5","5","highest","highest","lowest","4","highest","4","5","2","3","5","4","3","5","4","5","3","4","highest","highest","5","2","4","highest","5","3","lowest","2","5","4","5","4","highest","5","5","5","5","3","4","4","5","3","5","3","2","lowest","highest","5","5","5","5","highest","5","4","5","3","4","4","3","highest","3","2","5","4","3","5","4","5","5","4","4","4","highest","lowest","5","3","4","highest","5","3","3","3","3","3","lowest","3","5","2","lowest","5","highest","highest","highest","5","5","5","4","5","5","5","4","5","highest","5","5","5","5","lowest","4","5","4","2","4","5","2","5","5","5","5","5","lowest","lowest","4","4","5","highest","5","4","2","highest","2","3","2","3","4","highest","5","4","3","highest","5","4","lowest","5","4","4","2","lowest","highest","5","4","5","highest","4","4","3","5","4","4","5","5","3","2","5","highest","4","5","5","5","4","4","5","2","3","4","3","5","5","4","4","lowest","4","3","5","5","3","5","5","5","4","highest","highest","4","5","3","5","5","5","5","highest","highest","2","5","5","4","highest","lowest","3","5","3","3","5","5","lowest","lowest","4","5","4","2","5","highest","4","highest","4","4","3","3","5","5","5","lowest","5","5","4","5","5","4","3","2","5","3","2","4","5","highest","3","2","4","highest","5","5","4","highest","3","4","4","4","highest","3","5","2","lowest","5","4","4","lowest","4","5","highest","4","5","3","4","5","5","highest","5","5","4","5","5","4","highest","5","3","highest","3","highest","5","highest","5","highest","3","4","5","highest","4","3","5","4","5","3","4","4","5","4","3","highest","4","4","4","5","4","5","5","5","3","2","5","3","5","5","4","5","2","4","4","highest","2","5","lowest","highest","3","4","highest","2","5","3","highest","5","2","highest","5","4","5"],["no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes"],["no","yes","no","no","yes","yes","yes","no","yes","no","yes","yes","yes","yes","yes","yes","yes","yes","no","no","no","yes","no","no","yes","yes","no","yes","yes","no","yes","yes","no","no","yes","no","yes","no","no","yes","yes","yes","no","no","yes","no","no","yes","yes","yes","no","no","no","yes","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","no","no","yes","no","no","no","yes","no","yes","yes","yes","no","yes","yes","yes","no","no","no","no","no","yes","yes","yes","yes","no","yes","no","no","yes","yes","no","yes","yes","no","no","no","no","yes","no","yes","yes","no","no","yes","yes","yes","no","yes","no","yes","no","yes","no","yes","no","yes","yes","yes","yes","yes","yes","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","yes","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","no","no","no","no","no","no","no","yes","no","no","no","yes","yes","no","yes","no","no","no","no","no","yes","no","no","yes","yes","yes","yes","no","yes","no","no","yes","yes","yes","no","yes","yes","no","no","yes","no","no","no","no","yes","yes","no","yes","no","no","yes","yes","yes","no","yes","yes","yes","yes","yes","yes","yes","yes","no","yes","yes","no","no","yes","yes","yes","no","yes","no","no","yes","no","yes","yes","yes","yes","yes","no","yes","no","yes","yes","no","yes","no","yes","no","no","yes","yes","yes","yes","yes","no","yes","yes","yes","yes","no","yes","yes","yes","yes","no","yes","yes","no","yes","yes","no","no","yes","no","no","no","no","no","no","yes","yes","yes","yes","no","no","no","yes","yes","yes","no","yes","no","yes","yes","yes","yes","yes","yes","no","no","yes","yes","yes","yes","no","no","yes","yes","no","no","yes","no","no","yes","no","yes","yes","yes","yes","no","no","yes","yes","no","yes","no","yes","yes","no","yes","no","yes","yes","yes","yes","yes","no","yes","yes","yes","yes","yes","no","yes","no","yes","yes","yes","yes","yes","no","yes","yes","no","yes","yes","yes","yes","yes","no","yes","yes","no","yes","no","yes","yes","no","yes","no","yes","no","yes","yes","yes","yes","no","yes","yes","yes","yes","yes","no","yes","yes","no","no","yes","no","yes","no","yes","yes","yes","yes","no","yes","no","yes","yes","yes","no","yes","yes","yes","yes","yes","yes","no","yes","yes","yes","no","no","no","no","yes","no","yes","yes","no","yes","yes","yes","yes","yes","no","yes","no","yes","yes","no","no","yes","yes","yes","no","no","yes","yes","yes","no","yes","yes","no","no","no","no","yes","yes","no","yes","yes","no","yes","no","yes","yes","no","yes","yes","no","no","no","yes","no","yes","no","no","yes","yes","no","no","yes","yes","yes","no","yes","no","yes","yes","yes","yes","no","no","no","no","yes","yes","yes","no","yes","yes","no","no","no","no","no","no","yes","yes","yes","yes","yes","no","yes","yes","yes","yes","yes","no","yes","yes","yes","yes","yes","yes","yes","yes","no","yes","no","no","yes","yes","no","no","yes","yes","no","yes","yes","yes","no","no","no","yes","yes","yes","yes","yes","yes","yes","yes","no","yes","no","yes","yes","no","yes","no","yes","yes","no","yes","yes","no","no","yes","no","yes","no","yes","yes","yes","no","no","yes","yes","no","yes","yes","yes","yes","no","yes","yes","yes","yes","yes","yes","no","yes","yes","yes","yes","no","yes","no","yes","no","yes","yes","yes","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","yes","no","yes","yes","no","yes","no","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","yes","yes","yes","yes","yes","no","yes","no","yes","yes","yes","no","yes","no","yes","yes","yes","yes","no","yes","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","yes","yes","yes","no","yes","yes","yes","yes","yes","no","no","yes","yes","yes","yes","no","yes","no","yes","yes","no","yes","yes","yes","yes","yes","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","no","no","no","yes","no","yes","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","no","yes","yes","yes","yes","yes","yes","no","no","no","no","yes","yes","yes","no","no","no","no","yes","yes","yes","yes","yes","no","yes","yes","yes","yes","yes","yes","yes","no","yes","no","yes","yes","yes","no","no","yes","no","no","no","no","yes","yes","no","no","yes","yes","yes","yes","yes","yes","no","yes","yes","yes","no","yes","yes","no","yes","yes","no","no","no","yes","yes","yes","no","no","no","yes","yes","no","yes","no","yes","yes","yes","no","yes","yes","yes","yes","yes","yes","yes","no","no","no","no","no","no","no","yes","no","yes","yes","yes","no","no","yes","yes","yes","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","yes","no","no","yes","yes","yes","no","yes","yes","no","yes","yes","yes","yes","no","no","yes","yes","yes","no","yes","no","yes","yes","yes","yes","yes","yes","no","yes","no","yes","no","yes","no","no","yes","yes","yes","yes","yes","yes","no","yes","yes","yes","yes","no","yes","yes","yes","yes","yes","no","yes","yes","yes","yes","no","no","yes","yes","yes","yes","yes","no","yes","yes","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","no","yes","yes","yes","yes","yes","yes","yes","no","yes","yes","yes","yes","yes","yes","no","yes","yes","no","yes","yes","yes","yes","yes","yes","yes","yes","no","yes","yes","no","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","yes","yes","yes","yes","yes","yes","yes","no","yes","no","yes","yes","yes","yes","yes","yes","yes","yes","no","yes","yes","yes","yes","yes","yes","yes","no","yes","yes","no","yes","yes","no","yes","yes","yes","yes","yes","yes"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>PUPIL<\/th>\n      <th>primary_school_id<\/th>\n      <th>secondary_school_id<\/th>\n      <th>achievement<\/th>\n      <th>sex<\/th>\n      <th>ses<\/th>\n      <th>primary_denominational<\/th>\n      <th>secondary_denominational<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tp","scrollX":true,"autoWidth":true,"columnDefs":[{"className":"dt-right","targets":[0,1,2,3]}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<br>
<br></p>
<p>For our mixed model we’ll look at the effects for <code>sex</code> and socioeconomic status, <code>ses</code>, a six level variable from low to high, on scholastic achievement. The range of achievement scores is roughly 4 to 10, with mean of 6.3 and standard deviation 0.9. We’ll take into account the clustering at primary school and secondary school. To incorporate the additional structure in <span class="pack">lme4</span> syntax is very easy, we just do as we did before, though now for both grouping factors<a href="#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a>.</p>
<pre class="sourceCode r"><code class="sourceCode r">pupils_crossed =<span class="st"> </span><span class="kw">lmer</span>(achievement <span class="op">~</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>ses 
                      <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>primary_school_id) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>secondary_school_id), 
                      <span class="dt">data =</span> pupils)
<span class="co">## summary(pupils_crossed, correlation=F)</span></code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
5.924
</td>
<td style="text-align:right;">
0.123
</td>
<td style="text-align:right;">
48.303
</td>
<td style="text-align:right;">
5.684
</td>
<td style="text-align:right;">
6.164
</td>
</tr>
<tr>
<td style="text-align:left;">
sexfemale
</td>
<td style="text-align:right;">
0.261
</td>
<td style="text-align:right;">
0.046
</td>
<td style="text-align:right;">
5.716
</td>
<td style="text-align:right;">
0.171
</td>
<td style="text-align:right;">
0.350
</td>
</tr>
<tr>
<td style="text-align:left;">
ses2
</td>
<td style="text-align:right;">
0.132
</td>
<td style="text-align:right;">
0.118
</td>
<td style="text-align:right;">
1.122
</td>
<td style="text-align:right;">
-0.098
</td>
<td style="text-align:right;">
0.362
</td>
</tr>
<tr>
<td style="text-align:left;">
ses3
</td>
<td style="text-align:right;">
0.098
</td>
<td style="text-align:right;">
0.110
</td>
<td style="text-align:right;">
0.890
</td>
<td style="text-align:right;">
-0.118
</td>
<td style="text-align:right;">
0.314
</td>
</tr>
<tr>
<td style="text-align:left;">
ses4
</td>
<td style="text-align:right;">
0.298
</td>
<td style="text-align:right;">
0.105
</td>
<td style="text-align:right;">
2.851
</td>
<td style="text-align:right;">
0.093
</td>
<td style="text-align:right;">
0.503
</td>
</tr>
<tr>
<td style="text-align:left;">
ses5
</td>
<td style="text-align:right;">
0.354
</td>
<td style="text-align:right;">
0.101
</td>
<td style="text-align:right;">
3.514
</td>
<td style="text-align:right;">
0.156
</td>
<td style="text-align:right;">
0.551
</td>
</tr>
<tr>
<td style="text-align:left;">
seshighest
</td>
<td style="text-align:right;">
0.616
</td>
<td style="text-align:right;">
0.110
</td>
<td style="text-align:right;">
5.602
</td>
<td style="text-align:right;">
0.401
</td>
<td style="text-align:right;">
0.832
</td>
</tr>
</tbody>
</table>
<p>The fixed effects tell us there is a positive effect of being female on achievement, and in general, relative to lowest SES category, being in the upper categories of SES also has a positive effect.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
grp
</th>
<th style="text-align:left;">
var1
</th>
<th style="text-align:right;">
variance
</th>
<th style="text-align:right;">
sd
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
primary_school_id
</td>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.42
</td>
</tr>
<tr>
<td style="text-align:left;">
secondary_school_id
</td>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.26
</td>
</tr>
<tr>
<td style="text-align:left;">
Residual
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
0.69
</td>
</tr>
</tbody>
</table>
<p>When we look at the variance components we see that primary and secondary school contributes about 34% of the total variance. Most of the variance attributable to school comes from the primary school.</p>
<p>If we inspect the random effects, we can see that we now have two sets of effects- 50 for the primary schools, and 30 for the secondary. Both would be incorporated into any pupil-specific prediction.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glimpse</span>(<span class="kw">ranef</span>(pupils_crossed))</code></pre>
<pre><code>List of 2
 $ primary_school_id  :&#39;data.frame&#39;:    50 obs. of  1 variable:
  ..$ (Intercept): num [1:50] -0.327 0.183 0.52 0.474 0.253 ...
  ..- attr(*, &quot;postVar&quot;)= num [1, 1, 1:50] 0.0247 0.0225 0.0244 0.0215 0.0285 ...
 $ secondary_school_id:&#39;data.frame&#39;:    30 obs. of  1 variable:
  ..$ (Intercept): num [1:30] -0.41069 0.08247 -0.00589 -0.06162 0.08481 ...
  ..- attr(*, &quot;postVar&quot;)= num [1, 1, 1:30] 0.0155 0.014 0.0159 0.0131 0.0142 ...
 - attr(*, &quot;class&quot;)= chr &quot;ranef.mer&quot;</code></pre>
<p>Let’s look at them visually using <span class="pack">merTools</span>.</p>
<p><img src="mixed_models_files/figure-html/crossed_re_plot-1.svg" width="768" style="display: block; margin: auto;" /></p>
<p>Note that we have the usual extensions here if desired. As an example, we could also do random slopes for student level characteristics.</p>
</div>
</div>
<div id="hierarchical-structure" class="section level3">
<h3>Hierarchical Structure</h3>
<p>Now that we have looked at cross-classified models, we can examine hierarchical cluster structuring. In this situation we have clusters nested within other clusters, which may be nested within still other clusters. A typical example might be cities within counties, and counties within states.</p>
<div id="example-nurses-and-stress" class="section level4">
<h4>Example: Nurses and Stress</h4>
<p>For our demonstration we’ll use the nurses data set. Here we are interested in the effect of a training program (<code>treatment</code>) on stress levels (on a scale of 1-7) of nurses. In this scenario, nurses are nested within wards, which themselves are nested within hospitals, so we will have random effects pertaining to ward (within hospital) and hospital. For more information see the <a href="appendix.html#data">appendix</a>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&#39;data/nurses.RData&#39;</span>)</code></pre>
<div id="htmlwidget-2766fd9fd134ae88d76a" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-2766fd9fd134ae88d76a">{"x":{"filter":"none","data":[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25],[1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4],[11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,43,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,44,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,61,61,61,61,61,61,61,61,61,62,62,62,62,62,62,62,62,62,63,63,63,63,63,63,63,63,63,64,64,64,64,64,64,64,64,64,71,71,71,71,71,71,71,71,71,71,72,72,72,72,72,72,72,72,72,72,73,73,73,73,73,73,73,73,73,73,74,74,74,74,74,74,74,74,74,74,81,81,81,81,81,81,81,81,81,81,82,82,82,82,82,82,82,82,82,82,83,83,83,83,83,83,83,83,83,83,84,84,84,84,84,84,84,84,84,84,91,91,91,91,91,91,91,91,91,91,92,92,92,92,92,92,92,92,92,92,93,93,93,93,93,93,93,93,93,93,94,94,94,94,94,94,94,94,94,94,101,101,101,101,101,101,101,101,101,101,102,102,102,102,102,102,102,102,102,102,103,103,103,103,103,103,103,103,103,103,104,104,104,104,104,104,104,104,104,104,111,111,111,111,111,111,111,111,111,111,111,112,112,112,112,112,112,112,112,112,112,112,113,113,113,113,113,113,113,113,113,113,114,114,114,114,114,114,114,114,114,114,114,121,121,121,121,121,121,121,121,121,121,121,121,122,122,122,122,122,122,122,122,122,122,122,122,122,123,123,123,123,123,123,123,123,123,123,123,123,123,124,124,124,124,124,124,124,124,124,124,124,124,124,131,131,131,131,131,131,131,131,131,131,131,131,131,132,132,132,132,132,132,132,132,132,132,132,132,132,133,133,133,133,133,133,133,133,133,133,133,133,133,134,134,134,134,134,134,134,134,134,134,134,134,134,141,141,141,141,141,141,141,141,141,141,141,141,141,142,142,142,142,142,142,142,142,142,142,142,142,142,143,143,143,143,143,143,143,143,143,143,143,143,144,144,144,144,144,144,144,144,144,144,144,144,151,151,151,151,151,151,151,151,151,151,151,151,151,152,152,152,152,152,152,152,152,152,152,152,153,153,153,153,153,153,153,153,153,153,153,154,154,154,154,154,154,154,154,154,154,154,161,161,161,161,161,161,161,161,161,161,161,162,162,162,162,162,162,162,162,162,162,162,163,163,163,163,163,163,163,163,163,164,164,164,164,164,164,164,164,164,171,171,171,171,171,171,171,171,171,172,172,172,172,172,172,172,172,172,173,173,173,173,173,173,173,173,173,174,174,174,174,174,174,174,174,174,181,181,181,181,181,181,181,181,181,182,182,182,182,182,182,182,182,182,182,183,183,183,183,183,183,183,183,183,183,184,184,184,184,184,184,184,184,184,184,191,191,191,191,191,191,191,191,191,191,192,192,192,192,192,192,192,192,192,192,193,193,193,193,193,193,193,193,193,193,194,194,194,194,194,194,194,194,194,194,201,201,201,201,201,201,201,201,201,201,202,202,202,202,202,202,202,202,202,202,203,203,203,203,203,203,203,203,203,203,204,204,204,204,204,204,204,204,204,204,211,211,211,211,211,211,211,211,211,211,212,212,212,212,212,212,212,212,212,212,213,213,213,213,213,213,213,213,213,213,214,214,214,214,214,214,214,214,214,214,221,221,221,221,221,221,221,221,221,222,222,222,222,222,222,222,222,222,223,223,223,223,223,223,223,223,223,224,224,224,224,224,224,224,224,224,231,231,231,231,231,231,231,231,231,232,232,232,232,232,232,232,232,232,233,233,233,233,233,233,233,233,233,234,234,234,234,234,234,234,234,234,241,241,241,241,241,241,241,241,241,242,242,242,242,242,242,242,242,242,243,243,243,243,243,243,243,243,243,244,244,244,244,244,244,244,244,244,251,251,251,251,251,251,251,251,251,252,252,252,252,252,252,252,252,252,253,253,253,253,253,253,253,253,253,254,254,254,254,254,254,254,254,254],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777,778,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,799,800,801,802,803,804,805,806,807,808,809,810,811,812,813,814,815,816,817,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,838,839,840,841,842,843,844,845,846,847,848,849,850,851,852,853,854,855,856,857,858,859,860,861,862,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,962,963,964,965,966,967,968,969,970,971,972,973,974,975,976,977,978,979,980,981,982,983,984,985,986,987,988,989,990,991,992,993,994,995,996,997,998,999,1000],[36,45,32,57,46,60,23,32,60,45,57,47,32,42,42,53,60,33,64,37,23,61,58,52,28,52,43,64,47,62,39,46,58,34,41,56,39,60,57,50,29,57,51,25,27,53,42,43,24,48,60,27,61,33,47,50,38,28,33,52,53,31,27,57,47,41,64,45,42,25,34,36,55,33,51,60,24,31,58,60,29,24,24,46,43,24,45,64,25,55,42,58,64,47,25,50,42,60,33,51,27,43,45,53,53,37,25,32,46,57,27,55,51,24,56,31,46,57,42,53,48,25,37,47,29,41,31,52,36,39,62,42,51,29,25,50,23,60,43,43,27,28,36,60,64,64,61,27,32,28,64,55,46,45,23,55,60,39,24,61,28,34,34,25,39,64,60,58,58,32,41,61,47,60,56,47,31,47,51,61,50,37,23,56,45,23,48,46,64,47,56,51,28,61,41,37,25,25,50,64,38,39,43,28,33,39,46,25,52,45,52,33,25,36,50,57,43,53,62,60,62,33,33,27,61,23,38,64,64,57,25,56,43,45,23,46,37,31,29,37,61,43,39,29,52,58,34,57,37,56,32,29,29,32,25,36,45,58,52,42,31,37,47,31,38,58,31,41,62,62,24,28,58,56,50,51,24,28,43,45,61,45,41,31,32,24,57,41,58,56,51,45,32,55,53,41,47,41,28,62,34,41,31,57,60,29,46,27,50,45,34,45,39,43,28,55,32,38,36,29,48,31,37,58,31,46,60,46,57,50,64,24,37,36,58,64,34,47,43,39,43,27,27,55,61,37,36,32,47,27,42,55,45,23,58,60,58,33,50,47,23,53,27,53,37,53,52,39,48,64,42,31,34,41,47,48,29,51,48,61,23,61,50,39,37,47,24,47,23,36,41,55,56,37,39,24,56,60,42,29,39,61,37,24,31,36,47,64,47,31,55,34,29,42,42,56,57,29,33,39,62,60,56,47,34,39,50,38,50,25,34,39,42,42,39,56,56,31,58,43,58,37,25,57,52,36,24,42,60,56,55,31,32,42,32,32,57,61,41,46,51,31,56,42,45,39,46,36,42,41,37,52,42,57,62,32,56,48,33,34,61,24,31,46,27,42,62,57,31,34,57,53,47,34,47,31,25,57,47,61,27,53,34,64,34,55,43,29,45,27,47,58,45,64,55,32,29,29,48,45,43,23,60,39,45,36,45,36,42,37,41,64,58,62,32,33,25,60,38,48,45,56,46,45,37,57,62,24,61,51,33,60,36,52,56,46,50,32,45,28,51,38,55,45,32,43,24,47,47,45,52,45,62,48,50,46,61,58,51,33,24,60,43,57,33,62,61,47,60,27,24,31,55,53,23,25,27,45,52,25,37,50,41,28,50,52,23,28,24,37,56,58,36,58,41,51,34,58,37,25,45,58,28,43,38,38,37,61,64,47,39,45,34,34,52,33,50,45,31,53,28,50,58,39,42,28,43,64,47,29,56,23,28,43,60,62,34,36,51,53,58,57,23,23,36,39,33,45,50,34,64,31,61,48,34,58,42,51,28,64,58,37,43,33,62,39,55,43,61,52,45,57,32,32,34,32,56,57,61,23,24,42,24,57,27,51,58,29,42,43,32,51,47,62,61,47,37,23,27,55,25,43,52,25,50,50,58,34,43,46,42,51,46,25,29,48,53,29,51,62,29,46,48,37,25,38,24,27,45,41,38,57,45,57,25,43,45,38,46,46,41,45,37,53,39,51,32,25,23,41,55,24,55,50,62,46,48,53,56,46,56,29,36,31,53,52,47,56,25,56,61,64,41,56,37,36,41,25,62,27,29,36,58,46,37,32,64,52,31,52,47,39,45,53,51,50,34,48,32,38,34,62,31,50,47,27,61,48,64,28,36,51,55,31,28,33,38,45,28,38,46,57,42,31,37,57,42,42,60,33,48,24,37,37,28,34,33,50,31,29,61,58,48,25,34,27,23,58,48,50,45,51,53,25,50,29,64,36,56,34,61,34,58,60,39,24,34,48,28,34,42,46,38,31,24,56,23,50,27,60,23,25,24,37,56,42,39,29,64,50,36,46,56,31,56,64,47,32,41,41,34,37,48,62,38,24,25,36,23,24,60,41,28,58,24,34,33,55,43,57,31,23,37,55,58,55,47,47,28,33,32,52,34,56,42,29,28,55,37,47,48,31,25,47,51,34,62,39,46,38,36,25,42,36,32,42,36,51,52,31,25,41,29,23,23,38,28,62,45,60,34,41,27,39,33,56,29,32,34,58],["Male","Male","Male","Female","Female","Female","Female","Female","Male","Male","Female","Male","Female","Female","Female","Female","Male","Female","Female","Male","Female","Female","Female","Female","Male","Female","Male","Male","Male","Female","Female","Female","Female","Male","Male","Female","Female","Female","Female","Female","Female","Male","Female","Female","Female","Female","Male","Female","Male","Male","Male","Female","Male","Female","Male","Female","Female","Female","Female","Female","Male","Female","Female","Male","Female","Female","Female","Female","Male","Female","Female","Female","Female","Male","Female","Female","Female","Male","Female","Male","Male","Female","Female","Male","Female","Female","Male","Female","Female","Female","Female","Female","Female","Male","Female","Male","Female","Male","Female","Male","Female","Female","Female","Male","Male","Male","Female","Female","Female","Female","Female","Female","Male","Female","Female","Female","Male","Female","Female","Female","Female","Male","Female","Female","Female","Female","Female","Female","Female","Male","Female","Male","Female","Female","Female","Female","Female","Female","Female","Female","Female","Male","Male","Female","Female","Female","Female","Male","Female","Female","Female","Male","Female","Female","Female","Female","Female","Male","Female","Female","Female","Female","Male","Female","Male","Male","Male","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Male","Female","Female","Female","Female","Male","Female","Female","Female","Female","Female","Male","Female","Female","Female","Male","Female","Female","Female","Female","Male","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Male","Female","Female","Female","Male","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Male","Female","Female","Female","Male","Female","Female","Female","Female","Male","Female","Male","Male","Female","Female","Female","Female","Male","Male","Female","Female","Female","Male","Female","Male","Female","Female","Female","Female","Female","Male","Female","Female","Female","Female","Female","Male","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Male","Male","Female","Female","Female","Female","Male","Male","Female","Female","Male","Male","Female","Female","Female","Female","Male","Male","Female","Female","Male","Male","Female","Male","Female","Female","Female","Female","Male","Female","Male","Male","Female","Female","Female","Female","Female","Female","Female","Female","Male","Female","Male","Female","Female","Female","Female","Male","Male","Male","Female","Female","Female","Female","Female","Female","Male","Female","Male","Female","Male","Female","Male","Male","Male","Female","Female","Male","Male","Male","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Male","Female","Male","Female","Female","Female","Male","Female","Male","Female","Male","Female","Male","Female","Female","Female","Female","Female","Male","Female","Female","Male","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Male","Female","Female","Female","Female","Female","Male","Female","Female","Male","Female","Female","Female","Female","Male","Female","Female","Female","Male","Female","Female","Female","Female","Female","Female","Female","Female","Female","Male","Male","Male","Female","Female","Male","Female","Female","Female","Female","Female","Female","Male","Female","Male","Female","Female","Female","Female","Male","Male","Female","Female","Female","Male","Female","Female","Female","Male","Female","Female","Female","Male","Male","Female","Male","Male","Female","Female","Female","Female","Female","Female","Female","Female","Male","Female","Male","Female","Female","Female","Male","Female","Female","Female","Female","Female","Female","Female","Female","Male","Female","Female","Female","Male","Male","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Male","Female","Female","Male","Female","Female","Female","Female","Female","Female","Male","Female","Male","Male","Female","Female","Female","Female","Male","Female","Male","Male","Female","Female","Female","Male","Female","Male","Male","Female","Male","Male","Female","Female","Male","Male","Female","Male","Female","Female","Male","Female","Female","Female","Male","Female","Female","Female","Male","Female","Female","Male","Female","Female","Female","Female","Female","Female","Male","Female","Female","Male","Female","Female","Female","Female","Female","Female","Male","Female","Male","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Male","Female","Female","Female","Male","Male","Female","Female","Male","Male","Female","Female","Female","Male","Male","Female","Female","Male","Female","Female","Female","Female","Female","Female","Female","Female","Female","Male","Female","Female","Female","Female","Male","Female","Female","Female","Female","Female","Male","Female","Male","Female","Female","Female","Female","Female","Female","Male","Female","Female","Female","Male","Female","Female","Female","Male","Female","Male","Female","Female","Female","Female","Male","Female","Female","Female","Male","Female","Female","Male","Male","Female","Female","Male","Female","Female","Female","Female","Male","Female","Male","Male","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Male","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Male","Female","Female","Male","Female","Female","Female","Female","Female","Male","Female","Male","Female","Male","Male","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Male","Female","Female","Male","Female","Female","Male","Female","Female","Male","Female","Female","Female","Female","Male","Female","Female","Female","Female","Female","Male","Female","Female","Female","Female","Female","Male","Female","Male","Male","Female","Female","Female","Male","Male","Female","Male","Female","Male","Female","Female","Male","Female","Female","Female","Female","Female","Male","Female","Male","Female","Female","Female","Female","Male","Female","Female","Female","Male","Male","Female","Female","Female","Female","Female","Female","Male","Male","Female","Male","Male","Female","Female","Female","Male","Female","Female","Female","Male","Female","Female","Female","Female","Male","Female","Female","Female","Female","Female","Female","Female","Female","Female","Male","Female","Female","Male","Female","Male","Female","Female","Male","Female","Male","Female","Male","Female","Female","Female","Female","Male","Female","Female","Female","Male","Male","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Male","Female","Male","Female","Male","Male","Male","Female","Female","Male","Female","Male","Male","Female","Female","Female","Female","Female","Male","Female","Male","Female","Female","Male","Female","Male","Female","Male","Female","Male","Female","Female","Female","Male","Female","Female","Male","Male","Female","Female","Female","Male","Female","Male","Female","Male","Male","Female","Female","Female","Male","Female","Female","Male","Female","Female","Female","Female","Female","Female","Female","Female","Female","Male","Female","Female","Female","Female","Male","Male","Female","Male","Female","Male","Female","Male","Male","Female","Female","Female","Male","Female","Female","Male","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Male","Female","Male","Female","Female","Female","Female","Female","Male","Male","Female","Female","Female","Female","Male","Male","Female","Female","Female","Male","Female","Male","Male","Female","Male","Female","Female","Female","Male","Female","Female","Female","Male","Male","Female"],[11,20,7,25,22,22,13,13,17,21,24,24,14,13,17,20,28,21,22,17,7,20,24,20,6,17,20,32,17,27,11,20,22,14,10,17,20,29,25,20,8,29,20,13,10,18,24,15,6,17,18,10,25,14,20,21,15,8,11,21,17,17,13,20,20,17,28,24,20,8,18,17,25,11,21,31,7,18,21,27,14,13,10,21,25,4,18,25,4,27,18,25,20,17,7,21,14,29,20,18,11,17,15,21,21,15,10,14,20,25,11,25,20,14,20,17,17,24,18,18,22,7,13,14,7,13,18,22,20,8,25,13,24,13,10,13,4,18,21,13,13,14,17,25,25,27,25,11,7,11,24,24,14,20,13,22,22,22,10,22,11,15,7,6,14,28,28,20,24,14,20,20,21,28,14,18,8,20,21,20,24,10,14,24,13,11,11,17,28,21,24,13,8,27,17,17,8,11,15,24,11,11,14,8,15,10,22,11,18,17,15,4,8,17,21,18,20,21,20,27,22,4,20,13,28,15,21,33,32,18,4,27,21,20,6,15,20,14,7,13,25,20,17,13,20,28,15,29,8,20,8,13,10,13,11,18,14,17,25,15,8,17,25,6,13,22,13,15,17,32,13,13,20,24,21,13,8,11,14,14,27,17,18,8,14,10,24,14,15,20,18,15,13,25,21,13,18,17,14,25,13,17,14,24,24,10,14,15,17,15,10,14,14,20,14,22,4,20,10,15,18,13,15,24,17,20,20,14,22,22,25,7,17,13,20,28,17,20,20,11,14,11,13,17,24,18,20,7,20,8,21,22,20,8,20,21,20,17,15,20,6,24,8,20,13,17,21,11,20,22,15,13,10,17,22,14,13,20,21,27,6,21,24,18,17,17,13,21,13,7,15,22,25,15,13,10,21,29,18,6,8,20,13,10,13,8,22,18,25,10,20,13,14,20,17,22,27,10,10,20,21,22,18,18,14,20,22,17,21,10,14,20,20,17,13,21,25,11,21,20,28,14,7,25,20,15,13,20,27,22,24,11,17,13,14,10,28,27,20,18,21,7,22,20,14,17,18,8,15,13,13,27,22,22,27,11,20,24,20,15,21,6,13,13,4,17,24,25,15,13,21,17,20,18,15,11,10,21,14,21,10,24,10,22,11,21,18,15,17,11,17,22,15,25,17,14,8,13,11,22,24,10,25,21,13,10,20,8,10,20,15,25,25,28,7,10,6,20,13,21,20,20,20,18,14,20,27,14,22,15,8,31,11,21,29,18,21,20,11,13,20,18,22,24,17,13,11,17,21,17,28,20,28,22,15,17,28,28,24,17,13,27,11,22,15,36,29,18,22,17,6,20,25,20,6,15,8,22,25,8,14,21,11,6,17,25,6,4,10,10,27,22,18,24,14,18,18,24,17,11,18,22,6,20,18,18,10,20,28,17,18,13,10,13,21,15,21,13,10,17,7,17,21,13,24,18,18,27,25,6,29,3,10,18,25,20,15,11,22,24,25,18,10,6,8,20,17,13,17,17,28,6,27,15,17,25,15,18,13,22,22,20,15,13,24,17,21,20,25,20,20,21,14,14,15,10,24,15,29,10,10,14,8,28,10,20,20,13,14,14,15,22,21,20,24,20,17,7,13,24,8,15,14,8,15,14,22,7,18,18,15,24,15,13,17,17,20,8,20,27,13,17,18,15,10,17,11,14,15,14,17,21,15,22,1,10,15,17,13,18,21,17,22,27,14,20,11,11,8,15,24,14,20,18,24,17,20,18,28,24,21,17,8,10,27,20,25,22,7,25,20,24,20,21,17,15,15,3,32,10,15,15,22,13,14,15,27,24,8,17,21,17,15,17,21,28,14,18,8,17,15,29,14,20,15,10,18,25,24,13,8,21,22,17,6,4,18,21,10,18,22,25,20,13,14,22,22,14,24,18,18,11,17,13,8,15,14,24,14,15,24,24,17,11,17,10,6,21,21,18,15,18,27,13,24,11,27,13,28,18,28,15,29,22,20,13,14,22,13,10,18,15,15,11,8,27,6,20,6,18,7,7,11,15,18,17,17,18,28,20,13,20,20,13,27,38,24,13,15,13,14,13,20,25,11,14,1,20,15,6,20,20,10,24,8,13,20,24,20,21,11,7,17,25,22,24,15,7,10,10,17,21,10,21,18,18,14,20,15,17,18,15,8,18,21,10,27,14,17,18,13,10,14,11,15,15,15,21,22,6,14,20,17,8,15,17,8,25,15,21,7,15,11,15,8,14,10,11,14,22],[7,7,7,6,6,6,6,7,7,6,6,6,6,6,6,5,5,6,5,5,4,4,4,4,5,5,4,4,5,4,5,5,4,5,5,5,4,5,5,5,5,5,5,5,5,4,5,4,5,5,5,4,5,5,5,4,4,6,5,4,6,5,4,6,5,4,4,5,5,5,5,5,4,5,4,4,4,5,4,5,5,3,4,3,3,4,4,4,5,3,5,6,6,6,5,5,5,5,5,6,6,6,6,6,6,6,7,6,6,5,6,5,6,5,5,5,6,5,5,5,5,5,4,5,5,5,4,5,3,6,5,6,6,5,6,6,6,6,5,6,5,6,7,5,5,5,6,5,6,6,6,6,6,5,5,5,5,5,6,6,6,5,6,6,6,5,5,6,5,6,5,5,6,6,7,5,5,6,6,5,5,5,4,4,5,4,4,4,4,4,5,5,4,3,4,4,3,3,4,3,4,6,5,5,5,5,5,5,5,5,6,6,5,5,5,6,5,5,5,4,5,5,5,4,4,4,5,4,4,5,5,5,5,5,4,5,4,5,5,5,5,5,4,5,5,5,5,5,5,5,5,4,5,4,5,5,4,5,5,6,6,5,4,6,6,6,5,5,6,5,5,5,5,5,4,6,6,5,5,5,5,6,5,5,5,6,4,5,7,5,5,6,5,5,5,6,5,5,5,2,2,3,3,1,3,2,3,2,3,3,3,3,3,3,3,3,3,2,3,4,5,5,4,5,4,4,5,5,5,4,5,5,5,5,4,4,4,5,4,6,5,6,5,6,5,6,4,5,5,6,5,6,5,5,6,5,5,5,5,6,6,6,6,6,6,7,6,6,6,6,5,5,6,5,5,6,6,5,6,4,4,4,5,4,4,4,4,4,4,4,5,4,4,4,5,4,5,4,4,4,4,5,5,5,5,6,5,5,5,4,5,5,5,5,5,6,5,6,6,5,6,6,5,4,4,3,4,3,3,4,4,4,4,4,4,4,5,5,5,4,4,5,5,4,5,4,5,5,5,5,6,6,5,6,5,6,5,5,6,5,6,6,6,5,7,5,6,6,6,6,6,6,6,4,3,3,3,4,3,3,4,4,4,4,5,4,3,4,3,4,3,3,4,3,4,4,5,4,4,5,6,6,6,4,5,5,5,4,5,5,5,6,5,4,5,5,5,5,6,5,5,6,5,5,6,3,4,4,5,3,4,4,3,4,4,4,4,3,5,5,3,4,4,4,4,5,4,4,4,5,4,4,6,5,5,5,5,4,6,5,5,5,5,5,5,5,5,5,5,5,4,5,5,6,5,4,5,4,3,5,4,4,4,4,4,3,4,4,6,5,6,6,5,6,6,6,6,5,5,5,6,6,6,5,6,5,5,5,5,5,5,7,6,7,6,6,6,6,6,6,5,4,5,4,4,5,5,4,4,4,3,5,5,5,6,5,5,4,5,5,5,5,5,6,5,6,6,5,6,6,6,7,5,5,5,6,5,6,6,6,6,5,5,6,5,5,5,5,5,4,5,5,5,5,5,5,5,5,6,5,4,5,4,5,5,4,5,5,5,6,5,5,5,5,5,4,4,5,3,4,4,4,5,3,4,4,4,4,4,4,4,4,4,4,5,4,6,6,4,5,6,6,5,6,5,6,5,6,6,6,5,5,6,6,5,6,6,6,5,6,6,6,7,5,5,5,5,5,6,6,5,6,5,5,7,6,7,5,6,6,6,6,6,6,6,5,6,5,6,6,6,6,5,5,6,6,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,4,4,4,7,7,6,6,6,7,6,7,6,6,6,6,7,7,6,6,7,6,6,5,3,3,3,2,3,2,2,2,3,3,3,2,3,4,4,4,3,3,3,4,5,4,6,4,4,4,4,5,5,5,3,5,5,5,5,4,5,5,4,5,6,6,5,6,6,5,5,6,5,5,5,6,5,6,5,5,5,5,5,6,5,6,4,6,5,5,5,6,5,5,5,5,6,6,6,6,6,7,6,7,7,7,7,7,6,6,5,6,6,5,6,6,5,6,6,6,6,6,5,5,6,6,6,5,5,5,5,6,5,5,5,4,4,4,4,3,4,4,4,4,3,5,5,6,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,5,6,6,5,6,6,5,6,6,5,6,5,6,5,6,5,6,5,5,5,6,6,5,5,7,5,5,5,6,6,5,6,6,6,7,6,6,5,7,6,6,6,6,6,6],["general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care","general care","general care","general care","general care","general care","general care","general care","general care","general care","special care","special care","special care","special care","special care","special care","special care","special care","special care"],["large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","large","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","small","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium","medium"],["Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Training","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl","Ctrl"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>hospital<\/th>\n      <th>ward<\/th>\n      <th>wardid<\/th>\n      <th>nurse<\/th>\n      <th>age<\/th>\n      <th>sex<\/th>\n      <th>experience<\/th>\n      <th>stress<\/th>\n      <th>wardtype<\/th>\n      <th>hospsize<\/th>\n      <th>treatment<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tp","scrollX":true,"autoWidth":true,"columnDefs":[{"className":"dt-right","targets":[0,1,2,3,4,6,7]}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p><br>
<br></p>
<p>For the model we examine effects of the treatment as well as several other covariates, at least one at each of the nurse, ward, and hospital levels. Again, when it comes to the fixed effects portion, you can simply think about that part as you would any standard regression, we just add covariates as theory/exploration would suggest. To incorporate this type of random effects structure is not too different from the cross-classified approach, but does have a slight change to the syntax.</p>
<pre class="sourceCode r"><code class="sourceCode r">nurses_hierarchical =<span class="st"> </span><span class="kw">lmer</span>(stress <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>experience 
                           <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>wardtype <span class="op">+</span><span class="st"> </span>hospsize 
                           <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>hospital) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>hospital<span class="op">:</span>ward), 
                           <span class="dt">data =</span> nurses)
<span class="co">## nurses_hierarchical = lmer(stress ~ age  + sex + experience </span>
<span class="co">##                            + treatment + wardtype + hospsize </span>
<span class="co">##                            + (1|hospital/ward), </span>
<span class="co">##                            data = nurses) # same thing!</span>
<span class="co">## summary(nurses_hierarchical, correlation=F)</span></code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
5.38
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
29.13
</td>
<td style="text-align:right;">
5.02
</td>
<td style="text-align:right;">
5.74
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
10.05
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.03
</td>
</tr>
<tr>
<td style="text-align:left;">
sexFemale
</td>
<td style="text-align:right;">
-0.45
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-12.95
</td>
<td style="text-align:right;">
-0.52
</td>
<td style="text-align:right;">
-0.38
</td>
</tr>
<tr>
<td style="text-align:left;">
experience
</td>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-13.78
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
-0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
treatmentTraining
</td>
<td style="text-align:right;">
-0.70
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
-5.84
</td>
<td style="text-align:right;">
-0.93
</td>
<td style="text-align:right;">
-0.47
</td>
</tr>
<tr>
<td style="text-align:left;">
wardtypespecial care
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.42
</td>
<td style="text-align:right;">
-0.18
</td>
<td style="text-align:right;">
0.29
</td>
</tr>
<tr>
<td style="text-align:left;">
hospsizemedium
</td>
<td style="text-align:right;">
0.49
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
2.43
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.88
</td>
</tr>
<tr>
<td style="text-align:left;">
hospsizelarge
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
3.28
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
1.44
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>As far as the fixed effects go, about the only thing that doesn’t have a statistical effect is ward type<a href="#fn18" class="footnote-ref" id="fnref18"><sup>18</sup></a>.</p>
<p><br></p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
grp
</th>
<th style="text-align:center;">
var1
</th>
<th style="text-align:right;">
variance
</th>
<th style="text-align:right;">
sd
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
hospital:ward
</td>
<td style="text-align:center;">
(Intercept)
</td>
<td style="text-align:right;">
0.337
</td>
<td style="text-align:right;">
0.580
</td>
</tr>
<tr>
<td style="text-align:left;">
hospital
</td>
<td style="text-align:center;">
(Intercept)
</td>
<td style="text-align:right;">
0.119
</td>
<td style="text-align:right;">
0.345
</td>
</tr>
<tr>
<td style="text-align:left;">
Residual
</td>
<td style="text-align:center;">
</td>
<td style="text-align:right;">
0.217
</td>
<td style="text-align:right;">
0.466
</td>
</tr>
</tbody>
</table>
<p>Concerning the random effects, there appears to be quite a bit of variability from ward to ward especially, but also hospital. Recall that stress is a 7 point scale, so from ward to ward we can expect scores to bounce around about half a point on average, which is quite dramatic in my opinion. Again we inspect it visually.</p>
<p><img src="mixed_models_files/figure-html/hierarchical_re_plot-1.svg" width="768" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="crossed-vs.nested" class="section level3">
<h3>Crossed vs. Nested</h3>
<p>The following shows the difference in the results from treating ward as a nested (within hospital) vs. crossed random effect. What do you notice is different?</p>
<pre class="sourceCode r"><code class="sourceCode r">nurses_hierarchical =<span class="st"> </span><span class="kw">lmer</span>(stress <span class="op">~</span><span class="st"> </span>age  <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>experience 
                           <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>wardtype <span class="op">+</span><span class="st"> </span>hospsize 
                           <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>hospital) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>hospital<span class="op">:</span>wardid), <span class="dt">data =</span> nurses)

nurses_crossed =<span class="st"> </span><span class="kw">lmer</span>(stress <span class="op">~</span><span class="st"> </span>age  <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>experience 
                           <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>wardtype <span class="op">+</span><span class="st"> </span>hospsize 
                           <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>hospital) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>wardid), <span class="dt">data =</span> nurses)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
grp
</th>
<th style="text-align:center;">
var1
</th>
<th style="text-align:right;">
variance
</th>
<th style="text-align:right;">
sd
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
hospital:ward
</td>
<td style="text-align:center;">
(Intercept)
</td>
<td style="text-align:right;">
0.337
</td>
<td style="text-align:right;">
0.580
</td>
</tr>
<tr>
<td style="text-align:left;">
hospital
</td>
<td style="text-align:center;">
(Intercept)
</td>
<td style="text-align:right;">
0.119
</td>
<td style="text-align:right;">
0.345
</td>
</tr>
<tr>
<td style="text-align:left;">
Residual
</td>
<td style="text-align:center;">
</td>
<td style="text-align:right;">
0.217
</td>
<td style="text-align:right;">
0.466
</td>
</tr>
</tbody>
</table>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
grp
</th>
<th style="text-align:center;">
var1
</th>
<th style="text-align:right;">
variance
</th>
<th style="text-align:right;">
sd
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
wardid
</td>
<td style="text-align:center;">
(Intercept)
</td>
<td style="text-align:right;">
0.337
</td>
<td style="text-align:right;">
0.580
</td>
</tr>
<tr>
<td style="text-align:left;">
hospital
</td>
<td style="text-align:center;">
(Intercept)
</td>
<td style="text-align:right;">
0.119
</td>
<td style="text-align:right;">
0.345
</td>
</tr>
<tr>
<td style="text-align:left;">
Residual
</td>
<td style="text-align:center;">
</td>
<td style="text-align:right;">
0.217
</td>
<td style="text-align:right;">
0.466
</td>
</tr>
</tbody>
</table>
<p>Nothing? Good, you’re not crazy. Here’s a quote from the <a href="http://lme4.r-forge.r-project.org/book/Ch2.pdf">lme4 text</a>, section 2.2.1.1, which is definitely worth your time.</p>
<blockquote>
<p>The blurring of mixed-effects models with the concept of multiple,
hierarchical levels of variation results in an unwarranted emphasis on ‘levels’
when defining a model and leads to considerable confusion. It is perfectly
legitimate to define models having random effects associated with non-nested
factors. The reasons for the emphasis on defining random effects with respect to
nested factors only are that such cases do occur frequently in practice, and that
some of the computational methods for estimating the parameters in the models
can only be easily applied to nested factors.</p>
<p>This is not the case for the methods used in the lme4 package. <em>Indeed there is
nothing special done for models with random effects for nested factors</em>. When
random effects are associated with multiple factors, exactly the same
computational methods are used whether the factors form a nested sequence or are
partially crossed or are completely crossed.</p>
</blockquote>
<p>You might have noticed that we were using <code>wardid</code> rather than the <code>ward</code> grouping variable as in our first example. Even though every ward is unique, the <code>ward</code> column labels them with an arbitrary sequence starting with 1. While this might seem natural, ward 1 in hospital 1 is not the same as ward 1 in hospital 2, so it’s probably not a good idea to give them the same label. The <code>wardid</code> column properly distinguishes the wards with unique values (e.g. 11, 12).</p>
<p>What would have happened had we used that variable as a crossed random effect?</p>
<pre class="sourceCode r"><code class="sourceCode r">nurses_crossed_bad_data =<span class="st"> </span><span class="kw">lmer</span>(stress <span class="op">~</span><span class="st"> </span>age  <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>experience 
                               <span class="op">+</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>wardtype <span class="op">+</span><span class="st"> </span>hospsize 
                               <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>hospital) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>ward), <span class="dt">data =</span> nurses)</code></pre>
<pre><code>       grp        var1  variance        sd
1 hospital (Intercept) 0.1954941 0.4421471
2     ward (Intercept) 0.0000000 0.0000000
3 Residual        &lt;NA&gt; 0.4633613 0.6807065</code></pre>
<p>This is certainly not the result we want. The variance in <code>ward</code> is already captured by treatment and type. However, as demonstrated, this can be avoided with the proper syntax, or proper labeling in the data to allow unique clusters to have unique identifiers.</p>
<p>See this <a href="https://stats.stackexchange.com/questions/228800/crossed-vs-nested-random-effects-how-do-they-differ-and-how-are-they-specified">discussion also</a>, as well as <a href="https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html#nested-or-crossed">this from the FAQ</a> from one of the <span class="pack">lme4</span> developers. Josh Errickson at CSCAR also has a nice <a href="http://errickson.net/stats-notes/vizrandomeffects.html">write-up with visual depiction</a> of the underlying matrices of interest, which served as inspiration for some of the visualization in the next section.</p>
<p>So there you have it. When it comes to <span class="pack">lme4</span>, or mixed models more generally, crossed vs. nested is simply a state of mind (data)<a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a>.</p>
</div>
</div>
<div id="residual-structure" class="section level2">
<h2>Residual Structure</h2>
<p>Sometimes we will want to obtain more specific estimates regarding the residual covariance/correlation structure. This is especially the case in the longitudinal setting, where we think that observations closer in time would be more strongly correlated than those further apart, or that the variance changes over time. What does this model look like?</p>
<p>Let’s begin by thinking about the covariance/correlation matrix for the entire set of observations for our target variable, and how we want to represent the dependency in those observations. I’ll show a visualization of the first 5 people from our GPA data and modeling situation. Recall that each person has 6 observations. This display regards the results from our random intercepts (only) model for GPA.</p>
<p><img src="mixed_models_files/figure-html/residual_varcov-1.svg" width="768" style="display: block; margin: auto;" /></p>
<p>Each block represents the covariance matrix pertaining to observations within an individual. Within the person there are variances on the diagonal and covariances on the off-diagonal. When considering the whole data, we can see that observations from one person have no covariance with another person (gray). Furthermore, the covariance within a person is a constant value, the variance is also a constant value. Where did those values come from?</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
grp
</th>
<th style="text-align:right;">
variance
</th>
<th style="text-align:right;">
sd
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
student
</td>
<td style="text-align:right;">
0.064
</td>
<td style="text-align:right;">
0.252
</td>
</tr>
<tr>
<td style="text-align:left;">
Residual
</td>
<td style="text-align:right;">
0.058
</td>
<td style="text-align:right;">
0.241
</td>
</tr>
</tbody>
</table>
<p>Remember that there are two sources of variance in this model, the residual observation level variance, and that pertaining to person. Combined they provide the total residual variance that we aren’t already capturing with our covariates. In this case, it’s about 0.12, the value displayed on our diagonal. The off-diagonal is the variance attributable to student, which we alternately interpreted as an intraclass correlation (dividing by the total variance converts it to the correlation metric).</p>
<p>More generically, and referring to previous notation for our estimated variances, we can see the covariance matrix (for a cluster) as follows.</p>
<p><span class="math display">\[\Sigma = 
\left[
\begin{array}{ccc} 
\sigma^2 + \tau^2 &amp; \tau^2   &amp; \tau^2   \\
\tau^2   &amp; \sigma^2 + \tau^2 &amp; \tau^2   \\
\tau^2   &amp; \tau^2   &amp; \sigma^2 + \tau^2 \\
\end{array}\right]\]</span></p>
<p>This represents a covariance structure of <span class="emph">compound symmetry</span>. It is the default in most mixed model settings, and the same as what is shown visually above. Now let’s start to think about other types of covariance structures.</p>
<p>Consider the following model for an individual and three time points.</p>
<p><span class="math display">\[\boldsymbol{y} \sim \mathcal{N}(\boldsymbol{\mu}, \boldsymbol{\Sigma})\]</span></p>
<p>So we have three observations of <span class="math inline">\(y\)</span> that are multivariate normally distributed. The mean <span class="math inline">\(\mu\)</span> is a function of covariates just like in standard regression.</p>
<p><span class="math display">\[\mu = b_0 + b_1\cdot \mathrm{time} + b_2\cdot x_1 ...\]</span></p>
<p>However, instead of just plopping an <span class="math inline">\(\epsilon\)</span> at the end, we want to go further in defining the entire residual variance/covariance structure for all three time points.</p>
<p>In the simplest setting of standard regression, we have constant variance and no covariance.</p>
<p><span class="math display">\[\Sigma = 
\left[
\begin{array}{ccc} 
\sigma^2 &amp; 0   &amp; 0   \\
0   &amp; \sigma^2 &amp; 0   \\
0   &amp; 0   &amp; \sigma^2 \\
\end{array}\right]\]</span></p>
<p>Next, we can relax the assumption of equal variances, and estimate each separately.</p>
<p><span class="math display">\[\Sigma = 
\left[
\begin{array}{ccc} 
\sigma_1^2 &amp; 0   &amp; 0   \\
0   &amp; \sigma_2^2 &amp; 0   \\
0   &amp; 0   &amp; \sigma_3^2 \\
\end{array}\right]\]</span></p>
<p>Now let’s say we actually want to get at the underlying covariance/correlation. I’ll switch to the correlation representation, but you can still think of the variances as constant or separately estimated. So now we have something like this, where <span class="math inline">\(\rho\)</span> represents the residual correlation among observations.</p>
<p><span class="math display">\[\Sigma = \sigma^2
\left[
\begin{array}{ccc} 
1 &amp; \rho_1   &amp; \rho_2   \\
\rho_1   &amp; 1 &amp; \rho_3   \\
\rho_2   &amp; \rho_3   &amp; 1 \\
\end{array}\right]\]</span></p>
<p>In this case we’d estimate a different correlation for all time point pairs (with constant variance). This is typically described as an <span class="emph">unstructured</span>, or simply ‘symmetric’, correlation structure.</p>
<p>If you are familiar with repeated measures ANOVA, which is a <a href="https://m-clark.github.io/docs/mixedModels/anovamixed.html">special case of a mixed model</a>, you may recall that the usual assumption is a <span class="emph">sphericity</span>, a relaxed form of <span class="emph">compound symmetry</span>, where all the correlations have the same value, i.e. <span class="math inline">\(\rho_1=\rho_2=\rho_3\)</span>, and all variances are equal.</p>
<p>Another very commonly used correlation structure (for time-based settings) is an <span class="emph">autocorrelation</span> structure, of lag order one, for the residuals. What this means is that we assume the residuals at one time point apart correlate with some value <span class="math inline">\(\rho\)</span>, observations at two time points apart correlate <span class="math inline">\(\rho^2\)</span>, and so on. As such we only need to estimate <span class="math inline">\(\rho\)</span>, while the rest are then automatically determined. Here’s what it’d look like for four time points.</p>
<p><span class="math display">\[\Sigma = \sigma^2
\left[
\begin{array}{cccc} 
1 &amp; \rho     &amp; \rho^2   &amp; \rho^3   \\
\rho     &amp; 1 &amp; \rho     &amp; \rho^2   \\
\rho^2   &amp; \rho     &amp; 1 &amp; \rho     \\
\rho^3   &amp; \rho^2   &amp; \rho     &amp; 1 \\
\end{array}\right]\]</span></p>
<p>If <span class="math inline">\(\rho\)</span> was estimated to be .5, it would look like the following.</p>
<p><span class="math display">\[\Sigma = \sigma^2
\left[
\begin{array}{cccc} 
1 &amp; .5       &amp; .25      &amp; .06   \\
.5       &amp; 1 &amp; .5       &amp; .25  \\
.25      &amp; .5       &amp; 1 &amp; .5    \\
.06      &amp; .25      &amp;  .5      &amp; 1 \\
\end{array}\right]\]</span></p>
<p>Again, the main point is that points further apart in time are assumed to have less correlation.</p>
<p>Know that there are many patterns and possibilities to potentially consider, and that they are not limited to the repeated measures scenario. For example, the correlation could represent spatial structure, where units closer together geographically would be more correlated. And as noted we could also have variances that are different at each time point<a href="#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a>. We’ll start with that for the next example.</p>
<div id="heterogeneous-variance" class="section level3">
<h3>Heterogeneous Variance</h3>
<p>Unfortunately, <span class="pack">lme4</span> does not provide the ability to model the residual covariance structure, at least <a href="https://bbolker.github.io/mixedmodels-misc/notes/corr_braindump.html">not in a straightforward fashion</a>, though many other mixed model packages do<a href="#fn21" class="footnote-ref" id="fnref21"><sup>21</sup></a>. In fact, two packages that come with the basic R installation do so, <span class="pack">mgcv</span> and <span class="pack">nlme</span>. We’ll demonstrate with the latter.</p>
<p>The <span class="pack">nlme</span> package will have a different random effect specification, though not <em>too</em> different. In addition, to estimate heterogeneous variances, we’ll need to use an additional <code>weights</code> argument. The following will allow each time point of occasion to have a unique estimate.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(nlme)
heterovar_res =<span class="st"> </span><span class="kw">lme</span>(gpa <span class="op">~</span><span class="st"> </span>occasion, 
                    <span class="dt">data =</span> gpa,
                    <span class="dt">random =</span> <span class="op">~</span><span class="dv">1</span><span class="op">|</span>student, 
                    <span class="dt">weights =</span> <span class="kw">varIdent</span>(<span class="dt">form =</span> <span class="op">~</span><span class="dv">1</span><span class="op">|</span>occasion))
<span class="co">## summary(heterovar_res)</span></code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
2.599
</td>
<td style="text-align:right;">
0.026
</td>
<td style="text-align:right;">
99.002
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
occasion
</td>
<td style="text-align:right;">
0.106
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
26.317
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Variance
</th>
<th style="text-align:right;">
StdDev
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.094
</td>
<td style="text-align:right;">
0.306
</td>
</tr>
<tr>
<td style="text-align:left;">
Residual
</td>
<td style="text-align:right;">
0.138
</td>
<td style="text-align:right;">
0.372
</td>
</tr>
</tbody>
</table>
<p>At this point we’re getting the same stuff we’re used to. Now the not-so fun part. For the values we’re interested in for this example, i.e. the variances at each occasion, <span class="pack">nlme</span> does not make it easy on someone to understand initially, as the output regards the way things are for estimation, not for what one would usually have to report. The variances are scaled relative to the first variance estimate, which is actually the reported residual variance in the random effects part. Additionally the values are also on the standard deviation rather than variance scale. From the default output display, we can see that variance decreases over time in this case, but the actual values are not provided.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(heterovar_res<span class="op">$</span>modelStruct)</code></pre>
<pre><code>Random effects:
 Formula: ~1 | student
        (Intercept) Residual
StdDev:   0.8232544        1

Variance function:
 Structure: Different standard deviations per stratum
 Formula: ~1 | occasion 
 Parameter estimates:
        0         1         2         3         4         5 
1.0000000 0.8261186 0.6272415 0.4311126 0.3484013 0.4324628 </code></pre>
<p>Relative values are fine, I guess, but what we’d want are the actual estimates. Here’s how you can get them using the residual standard deviation to scale those values, then square them to get on the variance scale.</p>
<pre class="sourceCode r"><code class="sourceCode r">(<span class="kw">c</span>(<span class="fl">1.0000000</span>, <span class="kw">coef</span>(heterovar_res<span class="op">$</span>modelStruct<span class="op">$</span>varStruct, <span class="dt">unconstrained=</span>F))<span class="op">*</span>heterovar_res<span class="op">$</span>sigma)<span class="op">^</span><span class="dv">2</span></code></pre>
<pre><code>                    1          2          3          4          5 
0.13815037 0.09428374 0.05435276 0.02567636 0.01676917 0.02583744 </code></pre>
<p>Yeah. You’ll have to look this up every time you want to do it, or just make your own function that takes the model input. A newer alternative to keep in mind is <span class="pack">glmmTMB</span>. It would allow one to stay more in the <span class="pack">lme4</span> style and output.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(glmmTMB)
heterovar_res2 =<span class="st"> </span><span class="kw">glmmTMB</span>(gpa <span class="op">~</span><span class="st"> </span>occasion <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>student) <span class="op">+</span><span class="st"> </span><span class="kw">diag</span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>occas <span class="op">|</span>student), 
                         <span class="dt">data =</span> gpa)
<span class="kw">summary</span>(heterovar_res2)</code></pre>
<pre><code> Family: gaussian  ( identity )
Formula:          gpa ~ occasion + (1 | student) + diag(0 + occas | student)
Data: gpa

     AIC      BIC   logLik deviance df.resid 
   261.1    312.0   -120.5    241.1     1190 

Random effects:

Conditional model:
 Groups    Name                   Variance Std.Dev. Corr                     
 student   (Intercept)            0.093123 0.30516                           
 student.1 occasyear 1 semester 1 0.129833 0.36032                           
           occasyear 1 semester 2 0.086087 0.29341  0.00                     
           occasyear 2 semester 1 0.046240 0.21503  0.00 0.00                
           occasyear 2 semester 2 0.017615 0.13272  0.00 0.00 0.00           
           occasyear 3 semester 1 0.008709 0.09332  0.00 0.00 0.00 0.00      
           occasyear 3 semester 2 0.017730 0.13316  0.00 0.00 0.00 0.00 0.00 
 Residual                         0.008065 0.08980                           
Number of obs: 1200, groups:  student, 200

Dispersion estimate for gaussian family (sigma^2): 0.00806 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) 2.598788   0.026201   99.19   &lt;2e-16 ***
occasion    0.106141   0.004034   26.31   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Note that the variances dispalyed for each time point are not conflated with the residual variance. To compare with <span class="pack">nlme</span>, just add the residual variance to those estimates. As with every mixed model package (apparently), it still takes a bit to get the variances in a usable form from the <span class="func">VarCorr</span> object. The following shows how though, and compares to the <span class="pack">nlme</span> result.</p>
<pre class="sourceCode r"><code class="sourceCode r">vc_glmmtmb =<span class="st"> </span><span class="kw">VarCorr</span>(heterovar_res2)
vc_glmmtmb =<span class="st"> </span><span class="kw">attr</span>(vc_glmmtmb<span class="op">$</span>cond<span class="op">$</span>student<span class="fl">.1</span>, <span class="st">&#39;stddev&#39;</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="kw">sigma</span>(heterovar_res2)<span class="op">^</span><span class="dv">2</span></code></pre>
<table class="table table" style="width: auto !important; margin-left: auto; margin-right: auto; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
year 1 sem 1
</th>
<th style="text-align:right;">
year 1 sem 2
</th>
<th style="text-align:right;">
year 2 sem 1
</th>
<th style="text-align:right;">
year 2 sem 2
</th>
<th style="text-align:right;">
year 3 sem 1
</th>
<th style="text-align:right;">
year 3 sem 2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
glmmTMB
</td>
<td style="text-align:right;">
0.138
</td>
<td style="text-align:right;">
0.094
</td>
<td style="text-align:right;">
0.054
</td>
<td style="text-align:right;">
0.026
</td>
<td style="text-align:right;">
0.017
</td>
<td style="text-align:right;">
0.026
</td>
</tr>
<tr>
<td style="text-align:left;">
nlme
</td>
<td style="text-align:right;">
0.138
</td>
<td style="text-align:right;">
0.094
</td>
<td style="text-align:right;">
0.054
</td>
<td style="text-align:right;">
0.026
</td>
<td style="text-align:right;">
0.017
</td>
<td style="text-align:right;">
0.026
</td>
</tr>
</tbody>
</table>
</div>
<div id="autocorrelation" class="section level3">
<h3>Autocorrelation</h3>
<p>The following example shows the same basic model, but with the autocorrelation structure we described previously. In <span class="pack">nlme</span> we use the built-in <span class="func">corAR1</span> function and <code>correlation</code> argument similar to how we did with the weights argument.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(nlme)
corr_res =<span class="st"> </span><span class="kw">lme</span>(gpa <span class="op">~</span><span class="st"> </span>occasion, 
               <span class="dt">data =</span> gpa,
               <span class="dt">random =</span> <span class="op">~</span><span class="dv">1</span><span class="op">|</span>student, 
               <span class="dt">correlation =</span> <span class="kw">corAR1</span>(<span class="dt">form =</span> <span class="op">~</span>occasion))
<span class="co">## summary(corr_res)</span></code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
2.597
</td>
<td style="text-align:right;">
0.023
</td>
<td style="text-align:right;">
113.146
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
occasion
</td>
<td style="text-align:right;">
0.107
</td>
<td style="text-align:right;">
0.005
</td>
<td style="text-align:right;">
20.297
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Variance
</th>
<th style="text-align:right;">
StdDev
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.046
</td>
<td style="text-align:right;">
0.215
</td>
</tr>
<tr>
<td style="text-align:left;">
Residual
</td>
<td style="text-align:right;">
0.075
</td>
<td style="text-align:right;">
0.273
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>Notice first that the fixed effect for occasion is the same as <a href="supplemental.html#mixed-model-2">before</a>. The variance estimates have changed slightly along with the variances of the fixed effects (i.e. the standard errors). The main thing is that we have a new parameter called <code>Phi</code> in the <span class="pack">nlme</span> output that represents our autocorrelation, <code>Phi</code>, with value of 0.418. This suggests at least some correlation exists among the residuals for observations next to each other in time, though it diminishes quickly as observations grow further apart.</p>
</div>
</div>
<div id="generalized-linear-mixed-models" class="section level2">
<h2>Generalized Linear Mixed Models</h2>
<p>Just as generalized linear models extend the standard linear model, we can generalize (linear) mixed models to <span class="emph">generalized linear mixed models</span>. Furthermore, there is nothing restricting us to only the exponential family, as other packages would potentially allow for many other response distributions.</p>
<p>For this example we’ll do a logistic regression in the mixed model setting. In this case, we’ll use the speed dating data set. In the speed dating events, the experiment randomly assigned each participant to ten short dates (four minutes) with other participants. For each date, each person rated six attributes (attractive, sincere, intelligent, fun, ambitious, shared interests) of the other person on a 10-point scale and wrote down whether he or she would like to see the other person again.</p>
<p>Our target variable is whether the participant would be willing to date the person again (<code>decision</code>). To keep things simple, the predictors will be limited to the sex of the participant (<code>sex</code>), whether the partner was of the same race (<code>samerace</code>), and three of the attribute ratings the participant gave of their partner- attractiveness (<code>attractive</code>), sincerity (<code>sincere</code>), and intelligence (<code>intelligent</code>). The latter have been scaled to have zero mean and standard deviation of .5, which puts them on a more even footing with the binary covariates (<code>_sc</code>)<a href="#fn22" class="footnote-ref" id="fnref22"><sup>22</sup></a>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&#39;data/speed_dating.RData&#39;</span>)
sd_model =<span class="st"> </span><span class="kw">glmer</span>(decision <span class="op">~</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>samerace <span class="op">+</span><span class="st"> </span>attractive_sc <span class="op">+</span><span class="st"> </span>sincere_sc
                 <span class="op">+</span><span class="st"> </span>intelligent_sc 
                 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>iid), <span class="dt">data=</span>speed_dating, <span class="dt">family=</span>binomial)
<span class="kw">summary</span>(sd_model, <span class="dt">correlation=</span>F)</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
-0.74
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
-6.13
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.98
</td>
<td style="text-align:right;">
-0.51
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
-0.17
</td>
<td style="text-align:right;">
0.48
</td>
</tr>
<tr>
<td style="text-align:left;">
sameraceYes
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
4.19
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.46
</td>
</tr>
<tr>
<td style="text-align:left;">
attractive_sc
</td>
<td style="text-align:right;">
1.96
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
33.56
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
1.84
</td>
<td style="text-align:right;">
2.07
</td>
</tr>
<tr>
<td style="text-align:left;">
sincere_sc
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
5.75
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
0.42
</td>
</tr>
<tr>
<td style="text-align:left;">
intelligent_sc
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
8.23
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.55
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>The fixed effects results are as expected for the attributes, with attractiveness being a very strong effect in particular. In addition, having a partner of the same race had a positive effect while sex of the participant was statistically negligible. You are free to exponentiate the coefficients to get the odds ratios if desired, just as you would with standard logistic regression.</p>
<p><br></p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
grp
</th>
<th style="text-align:left;">
var1
</th>
<th style="text-align:left;">
variance
</th>
<th style="text-align:left;">
sd
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
iid
</td>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:left;">
2.71
</td>
<td style="text-align:left;">
1.65
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>For the variance components, notice that there is no residual variance. This is because we are not modeling with the normal distribution for the response, thus there is no <span class="math inline">\(\sigma\)</span> to estimate. However, the result suggests that there is quite a bit of variability from person to person.</p>
</div>
<div id="exercises-2" class="section level2">
<h2>Exercises</h2>
<div id="sociometric-data" class="section level3">
<h3>Sociometric data</h3>
<p>In the following data, kids are put into different groups and rate each other in terms of how much they would like to share some activity with the others. We have identifying variables for the person doing the rating (sender), the person being rated (receiver), what group they are in, as well as age and sex for both sender and receiver, as well as group size.</p>
<p>To run a mixed model, we will have three sources of structure to consider:</p>
<ul>
<li>senders (within group)</li>
<li>receivers (within group)</li>
<li>group</li>
</ul>
<p>First, load the sociometric data.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&#39;data/sociometric.RData&#39;</span>)</code></pre>
<p>To run the model, we will proceed with the following modeling steps. For each, make sure you are creating a separate model object for each model run.</p>
<ul>
<li>Model 1: No covariates, only sender and receiver random effects. Note that even though we don’t add group yet, still use the nesting approach to specify the effects (e.g. <code>1|group:receiver</code>)</li>
<li>Model 2: No covariates, add group random effect</li>
<li>Model 3: Add all covariates: <code>agesend/rec</code>, <code>sexsend/rec</code>, and <code>grsize</code> (group size)</li>
<li>Model 4: In order to examine sex matching effects, add an interaction of the sex variables to the model <code>sexsend:sexrec</code>.</li>
<li>Compare models with AIC (see the note about <a href="issues.html#model-comparison">model comparison</a>), e.g. <code>AIC(model1)</code>. A lower value would indicate the model is preferred.</li>
</ul>
</div>
<div id="patents" class="section level3">
<h3>Patents</h3>
<p>Do a Poisson mixed effect model using the <a href="appendix.html#data">patent data</a>. Model the number of citations (<code>ncit</code>) based on whether there was opposition (<code>opposition</code>) and if it was for the biotechnology/pharmaceutical industry (<code>biopharm</code>). Use year as a random effect to account for unspecified economic conditions.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&#39;data/patents.RData&#39;</span>)</code></pre>
<p>Interestingly, one can model overdispersion in a Poisson model by specifying an random intercept for each observation (<code>subject</code> in the data). In other words, no clustering or grouped structure is necessary.</p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="17">
<li id="fn17"><p>I don’t show the formal model here as we did before, but this is why depicting mixed models solely as ‘multilevel’ becomes a bit problematic in my opinion. In the standard mixed model notation it’s straightforward though, you just add an addition random effect term, just as we do in the actual model syntax.<a href="extensions.html#fnref17" class="footnote-back">↩</a></p></li>
<li id="fn18"><p>Setting aside our discussion to take a turn regarding regression modeling more generally, this is a good example of ‘surprising’ effects not being so surprising when you consider them more closely. Take a look at the effect of experience. More experience means less stress, this is probably not surprising. Now look at the age effect. It’s positive! But wouldn’t older nurses have more experience? What’s going on here? When interpreting experience, it is with age <em>held constant</em>, thus more experience helps with lowering stress no matter what your age. With age, we’re holding experience constant. If experience doesn’t matter, being older is affiliated with more stress, which might be expected given the type of very busy and high pressure work often being done (the mean age is 43). A good way to better understand this specifically is to look at predicted values when age is young, middle, and older vs. experience levels at low, middle, and high experience, possibly explicitly including the interaction of the two in the model. Also note that if you take experience out of the model, the age effect is negative, which is expected, as it captures experience also.<a href="extensions.html#fnref18" class="footnote-back">↩</a></p></li>
<li id="fn19"><p>Note that it <em>does</em> matter if you label your data inappropriately. For example, if in the nesting situation you start your id variable at 1 for each nested group, then you have to use the nested notation in <span class="pack">lme4</span>, otherwise, e.g. it won’t know that id = 1 in group 1 is different from id 1 in group 2. In our hospital example, this would be akin to using <code>ward</code> instead of <code>wardid</code> as we did. Again though, this wouldn’t be an issue if one practices good data habits. Note also the <code>:</code> syntax. In other modeling contexts in R this denotes an interaction, and that is no different here. In some contexts, typically due to experimental designs, one would want to explore random effects of the sort 1|A, 1|B and 1|A:B. However, this is relatively rare.<a href="extensions.html#fnref19" class="footnote-back">↩</a></p></li>
<li id="fn20"><p>One reason to do so would be that you expect variability to decrease over time, e.g. due to experience. You might also allow that variance to be different due to some other grouping factor entirely (e.g. due to treatment group membership).<a href="extensions.html#fnref20" class="footnote-back">↩</a></p></li>
<li id="fn21"><p>This feature request has been made by its users for over a decade at this point- it’s not gonna happen. The issue is that the way <span class="pack">lmer</span> works by default uses a method that won’t allow it (this is why it is faster and better performing than other packages). Unfortunately the only response to this issue is ‘use <span class="pack">nlme</span>’. However many other packages work with <span class="pack">lme4</span> rather than <span class="pack">nlme</span>, and if you aren’t going to use <span class="pack">lme4</span> for mixed models you might as well go Bayesian with <span class="pack">rstanarm</span> or <span class="pack">brms</span> instead of <span class="pack">nlme.</span> I would even prefer <span class="pack">mgcv</span> to <span class="pack">nlme</span> (though it can use <span class="pack">nlme</span> under the hood) because of the other capabilities it provides, and the objects created are easier to work with in my opinion.<a href="extensions.html#fnref21" class="footnote-back">↩</a></p></li>
<li id="fn22"><p>Note that for a balanced binary variable, the mean <code>p=.5</code> and standard deviation is <code>sqrt(p*(1-p)) = .5</code><a href="extensions.html#fnref22" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="random_slopes.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="issues.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["twitter", "facebook", "google", "weibo", "instapaper"],
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"depth": 2,
"scroll_highlight": true
},
"df_print": "kable",
"highlight": "pygments",
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
