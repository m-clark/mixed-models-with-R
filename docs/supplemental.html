<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Supplemental | Mixed Models with R</title>
  <meta name="description" content="This is an introduction to using mixed models in R. It covers the most common techniques employed, with demonstration primarily via the lme4 package. Discussion includes extensions into generalized mixed models, Bayesian approaches, and realms beyond." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Supplemental | Mixed Models with R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://m-clark.github.io/mixed-models-with-R/" />
  <meta property="og:image" content="https://m-clark.github.io/mixed-models-with-R//img/nineteeneightyR.png" />
  <meta property="og:description" content="This is an introduction to using mixed models in R. It covers the most common techniques employed, with demonstration primarily via the lme4 package. Discussion includes extensions into generalized mixed models, Bayesian approaches, and realms beyond." />
  <meta name="github-repo" content="m-clark/mixed-models-with-R/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Supplemental | Mixed Models with R" />
  
  <meta name="twitter:description" content="This is an introduction to using mixed models in R. It covers the most common techniques employed, with demonstration primarily via the lme4 package. Discussion includes extensions into generalized mixed models, Bayesian approaches, and realms beyond." />
  <meta name="twitter:image" content="https://m-clark.github.io/mixed-models-with-R//img/nineteeneightyR.png" />




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="img/R.ico" type="image/x-icon" />
<link rel="prev" href="summary.html"/>
<link rel="next" href="appendix.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.19/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="css/book.css" type="text/css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.14.0/css/all.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class='before'><a href="./">Mixed Models with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#overview"><i class="fa fa-check"></i>Overview</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#goals"><i class="fa fa-check"></i>Goals</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#data-and-exercises"><i class="fa fa-check"></i>Data and Exercises</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#key-packages"><i class="fa fa-check"></i>Key packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html"><i class="fa fa-check"></i>Mixed Models</a>
<ul>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#terminology"><i class="fa fa-check"></i>Terminology</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#kinds-of-structure"><i class="fa fa-check"></i>Kinds of Structure</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#random-intercepts-model"><i class="fa fa-check"></i>Random Intercepts Model</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#example-student-gpa"><i class="fa fa-check"></i>Example: Student GPA</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#the-standard-regression-model"><i class="fa fa-check"></i>The Standard Regression Model</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#the-mixed-model"><i class="fa fa-check"></i>The Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#initial-depiction"><i class="fa fa-check"></i>Initial depiction</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#as-a-multi-level-model"><i class="fa fa-check"></i>As a multi-level model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#application"><i class="fa fa-check"></i>Application</a>
<ul>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#initial-visualization"><i class="fa fa-check"></i>Initial visualization</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#standard-regression"><i class="fa fa-check"></i>Standard regression</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#regression-by-cluster"><i class="fa fa-check"></i>Regression by cluster</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#running-a-mixed-model"><i class="fa fa-check"></i>Running a mixed model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#cluster-level-covariates"><i class="fa fa-check"></i>Cluster Level Covariates</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#summary-of-mixed-model-basics"><i class="fa fa-check"></i>Summary of Mixed Model Basics</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#exercises-for-starting-out"><i class="fa fa-check"></i>Exercises for Starting Out</a>
<ul>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#sleep"><i class="fa fa-check"></i>Sleep</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#adding-the-cluster-level-covariate"><i class="fa fa-check"></i>Adding the cluster-level covariate</a></li>
<li class="chapter" data-level="" data-path="random_intercepts.html"><a href="random_intercepts.html#simulating-a-mixed-model"><i class="fa fa-check"></i>Simulating a mixed model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="random_slopes.html"><a href="random_slopes.html"><i class="fa fa-check"></i>More Random Effects</a>
<ul>
<li class="chapter" data-level="" data-path="random_slopes.html"><a href="random_slopes.html#application-1"><i class="fa fa-check"></i>Application</a></li>
<li class="chapter" data-level="" data-path="random_slopes.html"><a href="random_slopes.html#comparison-to-many-regressions"><i class="fa fa-check"></i>Comparison to many regressions</a></li>
<li class="chapter" data-level="" data-path="random_slopes.html"><a href="random_slopes.html#visualization-of-effects"><i class="fa fa-check"></i>Visualization of effects</a></li>
<li class="chapter" data-level="" data-path="random_slopes.html"><a href="random_slopes.html#categorical-features"><i class="fa fa-check"></i>Categorical Features</a></li>
<li class="chapter" data-level="" data-path="random_slopes.html"><a href="random_slopes.html#summary-of-random-slopes"><i class="fa fa-check"></i>Summary of Random Slopes</a></li>
<li class="chapter" data-level="" data-path="random_slopes.html"><a href="random_slopes.html#exercises-for-random-slopes"><i class="fa fa-check"></i>Exercises for Random Slopes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html"><i class="fa fa-check"></i>Common Extensions</a>
<ul>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#additional-grouping-structure"><i class="fa fa-check"></i>Additional Grouping Structure</a>
<ul>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#cross-classified-models"><i class="fa fa-check"></i>Cross-classified models</a></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#hierarchical-structure"><i class="fa fa-check"></i>Hierarchical structure</a></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#crossed-vs.-nested"><i class="fa fa-check"></i>Crossed vs. nested</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#residual-structure"><i class="fa fa-check"></i>Residual Structure</a>
<ul>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#heterogeneous-variance"><i class="fa fa-check"></i>Heterogeneous variance</a></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#autocorrelation"><i class="fa fa-check"></i>Autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#generalized-linear-mixed-models"><i class="fa fa-check"></i>Generalized Linear Mixed Models</a></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#exercises-for-extensions"><i class="fa fa-check"></i>Exercises for Extensions</a>
<ul>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#sociometric-data"><i class="fa fa-check"></i>Sociometric data</a></li>
<li class="chapter" data-level="" data-path="extensions.html"><a href="extensions.html#patents"><i class="fa fa-check"></i>Patents</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html"><i class="fa fa-check"></i>Issues</a>
<ul>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#variance-accounted-for"><i class="fa fa-check"></i>Variance Accounted For</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#common-alternatives-to-mixed-models"><i class="fa fa-check"></i>Common Alternatives to Mixed Models</a>
<ul>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#growth-curve-models"><i class="fa fa-check"></i>Growth curve models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#sample-sizes"><i class="fa fa-check"></i>Sample Sizes</a>
<ul>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#small-number-of-clusters"><i class="fa fa-check"></i>Small number of clusters</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#small-number-of-observations-within-clusters"><i class="fa fa-check"></i>Small number of observations within clusters</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#balancedmissing-values"><i class="fa fa-check"></i>Balanced/Missing values</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#big-data"><i class="fa fa-check"></i>Big data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#model-comparison"><i class="fa fa-check"></i>Model Comparison</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#convergence"><i class="fa fa-check"></i>Convergence</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html"><i class="fa fa-check"></i>Bayesian Approaches</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html#priors"><i class="fa fa-check"></i>Priors</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html#fixed-effects"><i class="fa fa-check"></i>Fixed effects</a></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html#variance-components-1"><i class="fa fa-check"></i>Variance components</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html#demonstration"><i class="fa fa-check"></i>Demonstration</a></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html#example-models"><i class="fa fa-check"></i>Example Models</a></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html#beyond-the-model"><i class="fa fa-check"></i>Beyond the Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="further.html"><a href="further.html"><i class="fa fa-check"></i>Going Further</a>
<ul>
<li class="chapter" data-level="" data-path="further.html"><a href="further.html#other-distributions"><i class="fa fa-check"></i>Other Distributions</a></li>
<li class="chapter" data-level="" data-path="further.html"><a href="further.html#other-contexts"><i class="fa fa-check"></i>Other Contexts</a></li>
<li class="chapter" data-level="" data-path="further.html"><a href="further.html#nonlinear-mixed-effects-models"><i class="fa fa-check"></i>Nonlinear Mixed Effects Models</a></li>
<li class="chapter" data-level="" data-path="further.html"><a href="further.html#connections"><i class="fa fa-check"></i>Connections</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html"><i class="fa fa-check"></i>Supplemental</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#a-comparison-to-latent-growth-curve-models"><i class="fa fa-check"></i>A Comparison to Latent Growth Curve Models</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#random-effects-as-latent-variables"><i class="fa fa-check"></i>Random effects as latent variables</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#random-effects-in-sem"><i class="fa fa-check"></i>Random effects in SEM</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#running-a-growth-curve-model"><i class="fa fa-check"></i>Running a growth curve model</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#random-intercepts"><i class="fa fa-check"></i>Random intercepts</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#random-intercepts-and-slopes"><i class="fa fa-check"></i>Random intercepts and slopes</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#random-effects-with-heterogeneous-variances"><i class="fa fa-check"></i>Random effects with heterogeneous variances</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#other-covariates"><i class="fa fa-check"></i>Other covariates</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#some-differences-between-mixed-models-and-growth-curves"><i class="fa fa-check"></i>Some differences between mixed models and growth curves</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#recommended-packages-that-can-do-growth-curve-models"><i class="fa fa-check"></i>Recommended packages that can do growth curve models</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#summary-of-lgc"><i class="fa fa-check"></i>Summary of LGC</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#correlation-structure-revisited"><i class="fa fa-check"></i>Correlation Structure Revisited</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#summary-of-residual-correlation-structure"><i class="fa fa-check"></i>Summary of residual correlation structure</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a>
<ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#programming-languages"><i class="fa fa-check"></i>Programming languages</a>
<ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#r"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#python"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#julia"><i class="fa fa-check"></i>Julia</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#proprietary"><i class="fa fa-check"></i>Proprietary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#reference-texts-and-other-stuff"><i class="fa fa-check"></i>Reference texts and other stuff</a></li>
</ul></li>
<li class="divider"></li>
<li class='after'">
   <a href="https://m-clark.github.io/">
      <img src="img/mc_logo.png" style="width:25%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo">
   </a>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a href="https://github.com/m-clark/">
         <i class="fab fa-github fa-2x" aria-hidden="true"></i>
      </a>
   </div>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
         <i class="fab fa-creative-commons fa-lg"></i>
         <i class="fab fa-creative-commons-by fa-lg"></i>
         <i class="fab fa-creative-commons-sa fa-lg"></i>
      </a>
   </div>
</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Mixed Models with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="supplemental" class="section level1">
<h1>Supplemental</h1>
<div id="a-comparison-to-latent-growth-curve-models" class="section level2">
<h2>A Comparison to Latent Growth Curve Models</h2>
<p>It is common in <span class="emph">Structural Equation Modeling</span> (SEM) to deal with longitudinal data via a <span class="emph">Latent Growth Curve (LGC)</span> model. It turns out that LGC are in a sense, just a different form of the very commonly used <span class="emph">mixed model</span> framework. In some ways they are more flexible, mostly in the standard structural equation modeling framework that allows for indirect, and other complex covariate relationships. In other ways, they are less flexible, e.g. with missing data, estimating nonlinear relationships, incorporating with many time points, dealing with time-varying covariates. With appropriate tools there is little one can’t do with the normal mixed model approach relative to the SEM approach, and one would likely have easier interpretation. As such I’d recommend sticking with the standard mixed model framework unless you really need to, but it is useful to have both tools.</p>
<p>To best understand a growth curve model, I still think it’s instructive to see it from the mixed model perspective, where things are mostly interpretable from what you know from a standard linear model. We will use our GPA example from before, and one can refer to the <a href="appendix.html#appendix">appendix</a> for more detail.</p>
<div id="random-effects-as-latent-variables" class="section level3">
<h3>Random effects as latent variables</h3>
<p><a href="random_intercepts.html#random-intercepts-model">As before</a> we assume the following for the GPA model. As a simple starting point we merely model a trend of time (occasion- 6 semesters) and have random effects due to student for both intercept and occasion. In this setting we are treating time as numeric, but one could treat the occasion variable as categorical<a href="#fn30" class="footnote-ref" id="fnref30"><sup>30</sup></a>.</p>
<p><span class="math display">\[\mathrm{gpa} = (b_{\mathrm{intercept}} + \mathrm{re}_{\mathrm{intercept}}) + (b_{\mathrm{occ}}  + \mathrm{re}_{\mathrm{occasion}})\cdot \mathrm{occasion} +  \epsilon\]</span></p>
<p><span class="math display">\[\mathrm{re}_{\mathrm{intercept}} \sim \mathcal{N}(0, \tau)\]</span>
<span class="math display">\[\mathrm{re}_{\mathrm{occasion}} \sim \mathcal{N}(0, \varphi)\]</span>
<span class="math display">\[\epsilon \sim \mathcal{N}(0, \sigma)\]</span></p>
<p>Thus the student effects for the intercept and slope are random, and specifically are normally distributed with mean of zero and some estimated standard deviation (<span class="math inline">\(\tau\)</span>, <span class="math inline">\(\varphi\)</span> respectively)<a href="#fn31" class="footnote-ref" id="fnref31"><sup>31</sup></a>. We consider these effects as coming from unspecified, or <span class="emph">latent</span>, causes due to student. In addition, we have the usual residual error <span class="math inline">\(\epsilon\)</span>, which can also be thought of as a per-observation random effect due to all other unknown causes.</p>
<p>The ‘multilevel model’ version might look like the following, but it is identical.</p>
<p><span class="math display">\[\mathrm{gpa} = b_{\mathrm{int\_student}} + b_{\mathrm{occ\_student}}\cdot \mathrm{occasion} + \epsilon\]</span></p>
<p><span class="math display">\[b_{\mathrm{int\_student}} = b_{\mathrm{intercept}} + \mathrm{re}_{\mathrm{intercept}}\]</span>
<span class="math display">\[b_{\mathrm{occ\_student}} = b_{\mathrm{occ}} + \mathrm{re}_{\mathrm{occasion}}\]</span></p>
<p>The corresponding model may be run using <span class="pack">lme4</span> as follows.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="supplemental.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&#39;data/gpa.RData&#39;</span>)   </span>
<span id="cb110-2"><a href="supplemental.html#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="supplemental.html#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="co"># if you haven&#39;t downloaded the workshop RStudio project</span></span>
<span id="cb110-4"><a href="supplemental.html#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="co"># load(url(&#39;https://github.com/m-clark/mixed-models-with-R/raw/master/data/gpa.RData?raw=true&#39;))</span></span>
<span id="cb110-5"><a href="supplemental.html#cb110-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-6"><a href="supplemental.html#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb110-7"><a href="supplemental.html#cb110-7" aria-hidden="true" tabindex="-1"></a>mixed_init <span class="ot">=</span> <span class="fu">lmer</span>(gpa <span class="sc">~</span> occasion <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> occasion<span class="sc">|</span>student), <span class="at">data =</span> gpa)</span>
<span id="cb110-8"><a href="supplemental.html#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(mixed_init)</span></span></code></pre></div>
<p>I show a simplified output below, so make sure you can match the results to the <span class="func">summary</span> printout. The fixed (population-average) effects are the <span class="math inline">\(b_{\mathrm{intercept}}\)</span> and <span class="math inline">\(b_{\mathrm{occ}}\)</span> in the previous model depiction. The standard deviations of the random effects are the <span class="math inline">\(\tau\)</span>, <span class="math inline">\(\varphi\)</span> and <span class="math inline">\(\epsilon\)</span>.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
value
</th>
<th style="text-align:right;">
se
</th>
<th style="text-align:right;">
lower_2.5
</th>
<th style="text-align:right;">
upper_97.5
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:right;">
2.60
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
2.56
</td>
<td style="text-align:right;">
2.63
</td>
</tr>
<tr>
<td style="text-align:left;">
occasion
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.12
</td>
</tr>
</tbody>
</table>
<p>We can also get estimates of the student level effects. These are the <span class="math inline">\(re_{intercept}\)</span> and <span class="math inline">\(re_{occasion}\)</span> from before.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:mixed-init-re">Table 1: </span>Per-student random effects (sample)
</caption>
<thead>
<tr>
<th style="text-align:left;">
group_var
</th>
<th style="text-align:left;">
effect
</th>
<th style="text-align:left;">
group
</th>
<th style="text-align:right;">
value
</th>
<th style="text-align:right;">
se
</th>
<th style="text-align:right;">
lower_2.5
</th>
<th style="text-align:right;">
upper_97.5
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
student
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
-0.202
</td>
<td style="text-align:right;">
0.113
</td>
<td style="text-align:right;">
-0.424
</td>
<td style="text-align:right;">
0.019
</td>
</tr>
<tr>
<td style="text-align:left;">
student
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
-0.211
</td>
<td style="text-align:right;">
0.113
</td>
<td style="text-align:right;">
-0.432
</td>
<td style="text-align:right;">
0.011
</td>
</tr>
<tr>
<td style="text-align:left;">
student
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
-0.007
</td>
<td style="text-align:right;">
0.113
</td>
<td style="text-align:right;">
-0.228
</td>
<td style="text-align:right;">
0.215
</td>
</tr>
<tr>
<td style="text-align:left;">
student
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
-0.093
</td>
<td style="text-align:right;">
0.113
</td>
<td style="text-align:right;">
-0.315
</td>
<td style="text-align:right;">
0.128
</td>
</tr>
<tr>
<td style="text-align:left;">
student
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
0.087
</td>
<td style="text-align:right;">
0.113
</td>
<td style="text-align:right;">
-0.134
</td>
<td style="text-align:right;">
0.309
</td>
</tr>
<tr>
<td style="text-align:left;">
student
</td>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
-0.206
</td>
<td style="text-align:right;">
0.113
</td>
<td style="text-align:right;">
-0.427
</td>
<td style="text-align:right;">
0.016
</td>
</tr>
</tbody>
</table>
</div>
<div id="random-effects-in-sem" class="section level3">
<h3>Random effects in SEM</h3>
<p>In SEM, we specify the latent linear, or common factor, model as follows.</p>
<p><span class="math display">\[Y = b_{\mathrm{intercept}} + \lambda F +  \epsilon\]</span>
<span class="math display">\[F \sim \mathcal{N}(0, \tau)\]</span></p>
<p><span class="math display">\[\epsilon \sim \mathcal{N}(0, \sigma)\]</span></p>
<p>In the above, <span class="math inline">\(Y\)</span> is our observed variable, <span class="math inline">\(b_{intercept}\)</span> is the intercept as in a standard linear regression model, <span class="math inline">\(\lambda\)</span> is the coefficient (<span class="emph">loading</span> in factor analysis/SEM terminology) regarding the effect of the latent variable, represented as <span class="math inline">\(F\)</span>. The latent variable is assumed normally distributed, with zero mean, and some estimated variance, just like the random effects in mixed models.</p>
<p>Note that if <span class="math inline">\(\lambda = 1\)</span>, we then have the right hand side as <span class="math inline">\(b_{intercept} + F\)</span>, and this is indistinguishable from the random intercept portion of the mixed model (<span class="math inline">\(b_{\mathrm{intercept}} + \mathrm{re}_{\mathrm{intercept}}\)</span>). Through this that we can maybe start to get a sense of random effects as latent variables (or vice versa). Indeed, mixed models have ties to many other kinds of models (e.g. spatial, additive), because those models also add a ‘random’ component to the model in some fashion.</p>
</div>
<div id="running-a-growth-curve-model" class="section level3">
<h3>Running a growth curve model</h3>
<p>The graphical model for the standard LGC model resembles that of <span class="emph">confirmatory factor analysis</span> (CFA) with two latent variables/factors. The observed, or <em>manifest</em>, measures are the dependent variable values at each respective time point. However, for those familiar with structural equation modeling (SEM), growth curve models will actually look a bit different compared with typical SEM, because we have to fix the factor loadings to specific values in order to make it work for the LGC. As we will see, this also leads to non-standard output relative to other SEM models, as there is nothing to estimate for the many fixed parameters.</p>
<p>More specifically, we’ll have a latent variable representing the random intercepts, as well as one representing the random slopes for the longitudinal trend (time), which in the GPA data is the semester indicator. All loadings for the intercept factor are 1. The loadings for the effect of time are arbitrary, but should accurately reflect the time spacing, and typically it is good to start at zero, so that the zero has a meaningful interpretation.</p>
<div style="width:50%; margin:auto auto; font-size:50%">
<div id="htmlwidget-e37d739cea93b54c12f4" style="width:100%;height:25%;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-e37d739cea93b54c12f4">{"x":{"diagram":"digraph growth {\n           # specifying label position is impossible as long as Diagrammer ignores several label attributes inherent in graphviz\n           # Intialization of graph attributes\n           graph [overlap=false ordering=out outputorder = edgesfirst splines=false bgcolor=transparent]    # order out keeps observed nodes in order; splines will keep straight after specifying headport\n           \n           # Node statements\n           node [shape=circle style=filled fillcolor=lightblue color=gray75 fontcolor=gray50 fontsize=\"14px\"];\n           \n           subgraph{\n            rankdir = LR;\n             rank = same;\n\n             # using plotly palette with alpha\n             Intercept [fontname=Roboto, fontcolor=white, fixedsize=true, width=1, height=1, fillcolor=\"#1f77b480\" color=\"#1f77b4\"];  \n             Slope [fontname=Roboto, fontcolor=white, fixedsize=true, width=1, height=1, fillcolor=\"#ff7f0e80\" color=\"#ff7f0e\"];\n           }\n\n           node [width=.66, height=.66, fixedsize=true, shape=square, style=\"\"]\n           subgraph {\n             rankdir = TB;\n             rank=same;\n             node [fontcolor=gray50]\n             node [color=\"#9467bd\"]\n             \n             V1 [label = <Y<FONT POINT-SIZE=\"8\"><SUB>T1<\/SUB><\/FONT>>];\n             V2 [label = <Y<FONT POINT-SIZE=\"8\"><SUB>T2<\/SUB><\/FONT>>]; \n             V3 [label = <Y<FONT POINT-SIZE=\"8\"><SUB>T3<\/SUB><\/FONT>>]; \n             V4 [label = <Y<FONT POINT-SIZE=\"8\"><SUB>T4<\/SUB><\/FONT>>]; \n           }\n\n           # Initialization of edge attributes\n           edge [color = gray50 overlap=false arrowsize=.5]\n           \n           # Edge statements\n           \n           edge [ fontcolor=gray25 dir=both fontsize=\"8px\"]  # labeleangle, labeldistance etc. attributes ignored\n           Intercept -> Slope[label=\"  &rho;\\n\" minlen=2];\n           \n           edge [dir=forward headport=\"c\" minlen=1]\n           edge [label=\"1\"  color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           Intercept -> V1; \n           edge [label=\"1\"   color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           Intercept -> V2;\n           edge [label=\"1\"  color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           Intercept -> V3;\n           edge [label=\"1\"  color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           Intercept -> V4;\n           \n           edge [dir=forward headport=\"n\" minlen=1]\n           edge [label=\"0\"  color=\"#ff7f0e\" fontcolor=\"#ff7f0e\" labelposition=3]\n           Slope -> V1; \n           edge [label=\"1\"  color=\"#ff7f0e\" fontcolor=\"#ff7f0e\"]\n           Slope -> V2;\n           edge [label=\"2\"  color=\"#ff7f0e\" fontcolor=\"#ff7f0e\"]\n           Slope -> V3;\n           edge [label=\"3\"  color=\"#ff7f0e\" fontcolor=\"#ff7f0e\"]\n           Slope -> V4;\n} ","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="wide-data" class="section level4">
<h4>Wide data</h4>
<p>Given the above visualization, for the LGC our data needs to be in <em>wide</em> format, where each row represents the unit of interest, and we have separate columns for each time point of the target variable, as well as any other variable that varies over time. This is contrasted with the <em>long</em> format we use for the mixed model, where rows represent observations at a given time point. We can use the <span class="func">spread</span> function from <span class="pack">tidyr</span> to help with that. We end up with a data frame of two-hundred observations and columns for each semester gpa (0 through 5 for six semesters) denoted by <code>gpa_*</code>.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="supplemental.html#cb111-1" aria-hidden="true" tabindex="-1"></a>gpa_wide <span class="ot">=</span> gpa <span class="sc">%&gt;%</span> </span>
<span id="cb111-2"><a href="supplemental.html#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(student, sex, highgpa, occasion, gpa) <span class="sc">%&gt;%</span> </span>
<span id="cb111-3"><a href="supplemental.html#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> occasion, <span class="at">values_from =</span> gpa) <span class="sc">%&gt;%</span> </span>
<span id="cb111-4"><a href="supplemental.html#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_at</span>(<span class="fu">vars</span>(<span class="st">`</span><span class="at">0</span><span class="st">`</span>,<span class="st">`</span><span class="at">1</span><span class="st">`</span>,<span class="st">`</span><span class="at">2</span><span class="st">`</span>,<span class="st">`</span><span class="at">3</span><span class="st">`</span>,<span class="st">`</span><span class="at">4</span><span class="st">`</span>,<span class="st">`</span><span class="at">5</span><span class="st">`</span>), <span class="cf">function</span>(x) glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&#39;gpa_{x}&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb111-5"><a href="supplemental.html#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">female =</span> <span class="fu">as.numeric</span>(sex)<span class="sc">-</span><span class="dv">1</span>)   <span class="co"># convert to binary 0 = male 1 = female to be used later</span></span></code></pre></div>
<div id="htmlwidget-29ea852b9cea07512cad" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-29ea852b9cea07512cad">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200"],["female","male","female","male","male","female","male","female","male","male","female","female","male","female","male","female","male","male","female","male","female","male","male","female","female","male","male","female","female","female","female","female","female","male","male","male","male","female","male","female","female","male","female","female","female","male","female","female","male","male","male","female","male","female","male","male","male","female","male","male","male","male","female","female","male","female","female","male","male","male","female","female","male","male","female","male","female","male","female","female","female","female","female","male","female","male","female","male","male","female","male","female","male","female","female","female","male","female","female","male","female","male","female","female","female","male","male","male","male","male","female","female","male","female","female","female","female","female","male","male","male","female","male","female","male","female","male","female","female","male","female","male","male","female","female","female","male","female","female","male","female","female","female","female","female","female","male","male","female","male","female","male","female","male","male","male","female","female","female","female","male","female","female","male","female","female","male","male","male","male","male","female","female","female","male","male","male","male","female","male","male","female","male","female","female","female","female","female","male","male","female","female","male","male","male","female","female","male","female","male"],[2.8,2.5,2.5,3.8,3.1,2.9,2.3,3.9,2,2.8,3.9,2.9,3.7,3.5,3.6,2.9,2.4,2.5,2.3,3.4,2.8,3.6,2.4,3.9,3.7,3,3.3,3.5,3.3,2.4,2,3.5,3.2,3.9,3.5,2.9,3,2.9,3.5,3.1,3.3,3.9,2.3,3.5,2.4,2.1,2.8,2.6,2.8,3.8,2.1,3.5,2.3,2.2,3.3,2.1,3.5,2.5,2.5,2.3,2.5,3,3.8,2.2,3.6,3.8,3.3,2.9,2.5,3.7,3.4,2.9,4,3.4,2,2.9,2.8,2.9,2.6,3.7,2.2,3.6,2.3,3.7,2.8,2.5,2.1,2.2,3.7,2.6,3.6,2.7,3.5,3.7,3.4,2.3,2.6,3.4,2.9,2.8,3.4,3.5,2.3,3.5,3.6,2.6,3.2,2.3,3.2,2.4,2.2,2.5,3.7,4,3.6,2.2,2.3,2.2,2.4,3.9,3.7,2.5,2.8,3.6,3.8,3.1,2.5,3.8,3.4,2.9,2.2,2.7,2,2.8,2.3,2,2,3.3,3.9,2.8,2.1,2.9,3.1,3.6,2.8,3.4,3.4,3.1,2.4,2.7,2.2,3.8,2.5,2.9,2.9,3.9,2.1,2.6,3.1,3.4,3.1,2.7,3,2.5,3.8,2.5,2.8,3.2,3.9,2,2.7,3.4,3.7,3.2,3.7,3.7,3.9,3.5,2.8,2.3,3.2,3.7,3,4,3.7,3.4,2.2,2.1,2.6,3.9,2,2.9,3,2.2,2.5,3.5,2.1,4,2.3,3.4],[2.3,2.2,2.4,2.5,2.8,2.5,2.4,2.8,2.8,2.8,2.6,2.6,2.8,2.4,2.2,2.5,2.6,2.4,2.5,2.8,2.6,2.8,2.8,2.7,3.5,2.3,2.2,2.6,2.9,2.9,2.6,2.8,2.3,2.4,2.5,2.5,2.2,2.9,2.4,2.5,2.9,2.5,2,3.1,2.7,2.9,2.6,2.9,3.1,2.4,1.7,2.5,2.8,2.8,2.4,2.2,2.5,2.5,2.8,2,2.4,2.4,2.6,2.4,1.9,2.3,2.6,2.3,2.3,2.7,2.9,3,2.6,3.5,2.5,2.4,2.4,2.4,2.3,3.1,2.3,3.3,2.5,2.3,2.4,2.7,2.3,2.7,2.6,2.4,2,2.7,2.9,2.7,2.5,2.4,2.3,3.3,2.2,2.7,2.8,3.1,2.2,2.3,3.4,1.8,2.4,2.7,2.7,2.5,2.4,3,2.7,2.8,2.2,2.5,2.8,2.5,2.4,2.5,2.9,3,2.9,2.5,2.8,2.5,2.7,3,2.7,2.4,2.8,2.2,2.5,2.5,3,2.8,2.8,2.5,2.5,2.5,2.7,2.8,2.9,2.5,2.4,2.6,2.6,2.5,2.7,2.7,2.4,2.4,2.5,2.6,2.7,2.6,3.3,3,3,2.9,2.6,1.7,2.2,2.5,2.8,3,2.7,2.9,2.9,2.4,2.3,2.7,2.2,2.8,2.3,2.9,2.9,2.8,2.7,2.9,2.3,2.7,2.7,2.3,2.6,2.2,2.4,2.3,3.3,1.7,2.4,2.9,3.1,2.4,2.4,2.2,2.9,2.5,2.6,2.8],[2.1,2.5,2.9,2.7,2.8,2.4,2.4,2.8,2.7,2.8,2.9,3,3.1,3,2.7,2.7,2.2,2.9,2.3,2.9,2.4,2.7,3.2,2.9,3.1,2.8,2.4,3.1,2.7,3,2.2,2.9,3,2.8,2.5,2.9,2.5,3.2,2.3,2.9,3.5,2.5,2.5,3,3.1,2.2,2.5,2.5,2.7,2.7,2.5,2.9,3.4,2.5,2.8,2,2.9,2.2,2.8,2.7,3.1,2.2,3.1,2.9,2.9,2.7,3,2.1,2.3,2.4,2.8,3.1,2.5,2.9,2.5,2.9,3.1,2.5,1.8,2.8,2.4,3.2,3.1,2.1,2.8,2.5,2.7,2.8,2.8,2.5,2.5,3.2,3.5,2.9,2.5,2.5,2.5,2.4,2.7,2,2.7,2.9,2.4,2.8,3.9,2.8,2.5,2,2.7,2.3,2.5,3.5,2.4,2.3,2.1,2.3,2.1,2.4,2.5,3.2,2.7,3.3,2.3,3.1,2.3,2.7,2.3,2.7,2.8,2.9,3.1,2.7,2.8,3.1,2.7,2.5,2.1,2.8,3.1,2.9,3.1,2.9,2.7,3,2.5,2.4,2.9,3,2.7,2.8,2.5,2.9,3,2.7,3.1,2.7,3,2.8,3,2.7,2.5,2.5,2.5,2.4,2.7,2.5,2.9,2.9,2.7,3.1,2.4,2.8,3.1,2.7,2.9,2.7,3,2.9,3.4,2.5,2.4,3.2,2.5,2.8,3.1,2.4,2.2,2.7,3.3,2.3,2.8,3,2.8,2.4,2.7,2.5,2.5,2.9,2.3,3.2],[3,2.6,3,2.4,2.8,2.4,2.8,3.1,2.7,3,3.2,2.3,3.5,2.9,2.6,2.8,2.6,2,3,3.2,2.5,3.1,2.8,3,3,2.1,2.5,2.9,2.9,3.2,2.1,3,2.4,2.6,2.6,3,3.3,3.2,3,3.2,3.2,3.4,3.1,3.1,3,2.7,2.8,2.7,3,2.4,3.3,3,2.7,3.3,3.2,2.6,2.8,2.4,2.6,2.6,3.2,2.5,3.1,2.7,2.4,3.2,2.5,2.3,2.5,3,3,3.5,2.6,2.8,3.2,2.8,3.2,2.1,2.2,3,2.8,2.7,3.2,2.4,3.1,3,2.7,2.5,3.2,2.7,2.3,3.8,3.2,3,2.9,2.8,3,3.2,2.7,2,3.1,2.7,2.8,2.9,3.9,2.6,2.3,2,2.7,2.2,2.2,3.2,3,2.8,3.1,2.8,3,3,2.6,3.2,2.6,2.9,2.3,2.5,2.7,2.1,2.4,2.3,2.7,3.6,3.2,3.4,2.3,2.8,3,2.8,2.7,2.7,3,2.6,3.1,3.1,2.4,2.9,2.8,2.3,3.4,2.5,2.4,2.4,2.5,2.7,2.7,3.2,2.5,2.7,3.1,2.9,3.1,3.2,2.7,2.2,2.9,2.6,2.9,3.2,3.1,3,3,3.2,2.7,3,3,2.9,3.1,2.8,3.1,2.8,2.5,2.5,2.2,3.1,2.7,2.8,3,3,2.1,3.3,2.8,2.7,2.8,2.4,2.7,2.6,2.2,2.7,2.8,3,2.7,3.4],[3,2.6,2.8,2.7,3,2.3,2.6,3.3,3.1,2.7,3.6,2.9,3.6,3,2.6,2.7,2.5,2.6,2.9,3.2,2.5,3.1,3,2.7,3.3,2.8,2.2,3.1,2.9,3.1,2.4,3.3,2.8,2.7,3.2,3.2,3.1,3.4,3.1,3.6,3.5,2.6,3.3,2.9,3.3,2.4,2.2,2.9,2.7,3.2,3.2,3.3,3,3.3,3.2,2.6,2.8,2.8,3.1,2.8,3.3,3,3.5,3.3,2.8,3.3,2.4,2.8,2.7,3.2,2.8,3.2,2.8,3.1,3,3.4,3.8,2.5,2.3,3.1,3.1,3.2,3.3,2.1,3.3,2.5,3.2,2.7,3,3,2.5,4,3.3,2.7,2.8,3.3,3.2,3.2,2.8,2.3,3.6,2.6,2.8,3,3.5,2.3,2.3,2.6,3.1,2.2,2.4,2.9,2.5,2.9,3,2.7,3.1,3.3,2.5,2.8,3,3,2.4,3.3,2.4,3.1,2.6,2.7,2.7,3.1,3.1,3,2.1,2.8,3.1,2.4,2.8,2.7,3.3,2.6,3.1,3,2.9,3,2.9,2.5,3.5,2.6,2.9,2.4,2.9,2.7,2.8,3.3,2.7,3,3.3,2.7,3.4,3.4,2.8,2.7,2.9,2.8,2.9,3.2,2.8,3.3,3.2,3.7,2.7,2.4,3.4,3.2,2.8,2.7,2.8,3,2.8,2.5,2.6,3.1,2.3,3,3,2.9,2.4,3.2,3,2.5,3,2.9,2.7,3.1,2.2,3.1,3.2,3.2,2.7,3.5],[3,3,3.3,2.9,2.9,2.7,3,3.3,3.1,3,3.6,3.1,3.9,3.3,2.8,2.8,2.6,2.5,2.9,3.4,2.5,3,2.9,2.9,3.4,2.8,2.8,3.1,3.3,3.2,2.6,3.4,2.8,2.6,3.4,3,3.3,3.6,3.1,3.3,3.8,2.8,3.2,3.1,3.1,2.6,2.8,3,3,3,3,3.3,2.8,3.2,3.1,2.9,3.4,2.9,3,3.1,3.5,2.9,3.4,3.2,2.8,3.4,2.6,2.7,2.7,2.9,2.9,3.7,2.6,3.1,3.2,3.3,4,2.3,2.5,3.4,3.3,3.3,3.4,2.2,3.1,2.6,3.1,3.1,3.1,3,2.8,4,3.4,2.7,2.7,3.4,2.9,3.1,2.8,2.4,3.6,2.9,3.1,3.4,3.9,2.5,2.6,2.5,2.8,2.2,2.2,3,2.6,3,3,2.9,3,3.3,2.8,3,3.3,3.1,2.2,3,2.6,3,2.3,2.9,2.9,3,3.4,3.3,2.3,2.9,3,2.8,3.1,2.9,3.3,2.9,3.4,3.1,3,3,2.9,2.5,3.6,2.8,3,2.6,2.7,2.8,3,3.4,2.7,2.8,3.4,2.8,3.8,3.7,2.8,2.6,3.2,2.8,2.9,3.2,3.6,3.4,3.6,3.6,2.5,2.8,3.7,3,3.4,2.6,3.3,2.9,2.9,2.6,2.6,3.3,2.6,3.1,3.2,3.2,2.8,3.1,3.1,2.6,3.1,2.8,2.9,3.4,2.4,3.3,3.3,3.3,2.8,3.3],[3.3,2.8,3.4,2.7,3.1,2.8,3,3.4,3.5,3,3.8,3.3,3.9,3.4,2.8,2.8,2.8,2.7,2.9,3.3,2.6,3.3,3,3,3.6,2.5,2.5,3.2,3.2,3.3,2.8,3.6,3,2.6,3.6,3.5,3.4,3.8,2.9,3.6,3.9,3,3.6,3.2,3.2,2.4,2.7,3.2,3.4,3,3.3,3.3,3,3.4,3.5,3.1,3.3,3.1,3.3,2.9,3.5,3.4,3.4,3.4,2.7,3.7,2.6,3.1,2.8,3.1,2.8,3.7,2.6,3.3,3,3.5,4,2.8,2.8,3.2,3.6,3.6,3.4,2.4,3.3,2.6,3.2,3,3.5,3.2,2.9,4,3.4,2.8,2.9,3.8,2.9,3.3,2.8,2.7,3.7,2.7,2.9,3.4,3.9,2.7,2.7,2.7,2.7,2.3,2.5,3.1,2.8,3.1,3.2,3.1,3.1,3.6,2.9,3.3,3.3,3.6,2.5,3.4,3,3,2.5,3.1,2.9,3.1,3.7,3.7,2.5,3.2,3,2.7,3,3.1,3.4,2.8,3.1,2.9,3,3.4,3.2,2.9,3.9,2.8,3.1,2.7,2.9,2.9,3,3.5,2.9,2.8,3.4,2.8,4,3.8,3.1,2.5,3.2,3.3,2.9,3.4,3.5,3.5,3.6,3.9,2.6,3.2,3.6,3.4,3.3,2.9,3.4,2.9,3.2,2.6,2.7,3.3,2.6,3.3,2.9,3.1,2.8,3.6,3.1,2.8,2.9,2.9,3.3,3.3,2.5,3.2,3.8,3.4,2.8,3.4],[1,0,1,0,0,1,0,1,0,0,1,1,0,1,0,1,0,0,1,0,1,0,0,1,1,0,0,1,1,1,1,1,1,0,0,0,0,1,0,1,1,0,1,1,1,0,1,1,0,0,0,1,0,1,0,0,0,1,0,0,0,0,1,1,0,1,1,0,0,0,1,1,0,0,1,0,1,0,1,1,1,1,1,0,1,0,1,0,0,1,0,1,0,1,1,1,0,1,1,0,1,0,1,1,1,0,0,0,0,0,1,1,0,1,1,1,1,1,0,0,0,1,0,1,0,1,0,1,1,0,1,0,0,1,1,1,0,1,1,0,1,1,1,1,1,1,0,0,1,0,1,0,1,0,0,0,1,1,1,1,0,1,1,0,1,1,0,0,0,0,0,1,1,1,0,0,0,0,1,0,0,1,0,1,1,1,1,1,0,0,1,1,0,0,0,1,1,0,1,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>student<\/th>\n      <th>sex<\/th>\n      <th>highgpa<\/th>\n      <th>gpa_0<\/th>\n      <th>gpa_1<\/th>\n      <th>gpa_2<\/th>\n      <th>gpa_3<\/th>\n      <th>gpa_4<\/th>\n      <th>gpa_5<\/th>\n      <th>female<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"ltipr","columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>We’ll use <span class="pack">lavaan</span> for our excursion into LGC. The syntax will require its own modeling code, but lavaan tries to keep to R regression model style. The names of <span class="objclass">intercept</span> and <span class="objclass">occasion</span> are arbitrary, and correspond to the intercepts and slopes factors of the previous visualization. The <code>=~</code> is just denoting that the left-hand side is the latent variable, and the right-hand side are the observed/manifest variables. We use the standard fixed loadings for an LGC model.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="supplemental.html#cb112-1" aria-hidden="true" tabindex="-1"></a>lgc_init_model <span class="ot">=</span> <span class="st">&#39;</span></span>
<span id="cb112-2"><a href="supplemental.html#cb112-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a href="supplemental.html#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="st">  intercept =~ 1*gpa_0 + 1*gpa_1 + 1*gpa_2 + 1*gpa_3 + 1*gpa_4 + 1*gpa_5</span></span>
<span id="cb112-4"><a href="supplemental.html#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="st">  occasion  =~ 0*gpa_0 + 1*gpa_1 + 2*gpa_2 + 3*gpa_3 + 4*gpa_4 + 5*gpa_5</span></span>
<span id="cb112-5"><a href="supplemental.html#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb112-6"><a href="supplemental.html#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span></code></pre></div>
<p>Now we’re ready to run the model. Note that <span class="pack">lavaan</span> has a specific function, <span class="func">growth</span>, to use for these models. It doesn’t spare us any effort for the model syntax, but does make it unnecessary to set various arguments for the more generic <span class="func">sem</span> and <span class="func">lavaan</span> functions.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="supplemental.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb113-2"><a href="supplemental.html#cb113-2" aria-hidden="true" tabindex="-1"></a>lgc_init <span class="ot">=</span> <span class="fu">growth</span>(lgc_init_model, <span class="at">data =</span> gpa_wide)</span>
<span id="cb113-3"><a href="supplemental.html#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lgc_init)</span></code></pre></div>
<pre><code>lavaan 0.6-9 ended normally after 73 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        11
                                                      
  Number of observations                           200
                                                      
Model Test User Model:
                                                      
  Test statistic                                43.945
  Degrees of freedom                                16
  P-value (Chi-square)                           0.000

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  intercept =~                                        
    gpa_0             1.000                           
    gpa_1             1.000                           
    gpa_2             1.000                           
    gpa_3             1.000                           
    gpa_4             1.000                           
    gpa_5             1.000                           
  occasion =~                                         
    gpa_0             0.000                           
    gpa_1             1.000                           
    gpa_2             2.000                           
    gpa_3             3.000                           
    gpa_4             4.000                           
    gpa_5             5.000                           

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  intercept ~~                                        
    occasion          0.002    0.002    1.629    0.103

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .gpa_0             0.000                           
   .gpa_1             0.000                           
   .gpa_2             0.000                           
   .gpa_3             0.000                           
   .gpa_4             0.000                           
   .gpa_5             0.000                           
    intercept         2.598    0.018  141.956    0.000
    occasion          0.106    0.005   20.338    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .gpa_0             0.080    0.010    8.136    0.000
   .gpa_1             0.071    0.008    8.799    0.000
   .gpa_2             0.054    0.006    9.039    0.000
   .gpa_3             0.029    0.003    8.523    0.000
   .gpa_4             0.015    0.002    5.986    0.000
   .gpa_5             0.016    0.003    4.617    0.000
    intercept         0.035    0.007    4.947    0.000
    occasion          0.003    0.001    5.645    0.000</code></pre>
</div>
<div id="fixed-effects-1" class="section level4">
<h4>Fixed effects</h4>
<p>Most of the output is blank, which is needless clutter, but we do get the same five parameter values we are interested in though.</p>
<p>We’ll start with the ‘intercepts’:</p>
<pre><code>Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)

    intercept         2.598    0.018  141.956    0.000
    occasion          0.106    0.005   20.338    0.000</code></pre>
<p>It might be odd to call your fixed effects ‘intercepts,’ but it makes sense if we are thinking of it as a multilevel model as depicted <a href="supplemental.html#random-effects-as-latent-variables">previously</a>, where we actually broke out the random effects as a separate model. These are the population average of the random intercepts and slopes for occasion. The estimates here are pretty much spot on with our mixed model estimates. To make the estimation approach as similar as possible, I’ve switched to standard maximum likelihood via <code>REML = FALSE</code>.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="supplemental.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb116-2"><a href="supplemental.html#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="supplemental.html#cb116-3" aria-hidden="true" tabindex="-1"></a>gpa_mixed <span class="ot">=</span> <span class="fu">lmer</span>(</span>
<span id="cb116-4"><a href="supplemental.html#cb116-4" aria-hidden="true" tabindex="-1"></a>  gpa <span class="sc">~</span> occasion <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> occasion <span class="sc">|</span> student), </span>
<span id="cb116-5"><a href="supplemental.html#cb116-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> gpa, </span>
<span id="cb116-6"><a href="supplemental.html#cb116-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">REML =</span> <span class="cn">FALSE</span></span>
<span id="cb116-7"><a href="supplemental.html#cb116-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-8"><a href="supplemental.html#cb116-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-9"><a href="supplemental.html#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gpa_mixed, <span class="at">cor=</span>F)</span></code></pre></div>
<pre><code>Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
Formula: gpa ~ occasion + (1 + occasion | student)
   Data: gpa

     AIC      BIC   logLik deviance df.resid 
   258.2    288.8   -123.1    246.2     1194 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2747 -0.5381 -0.0128  0.5327  3.1945 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 student  (Intercept) 0.044859 0.21180       
          occasion    0.004469 0.06685  -0.10
 Residual             0.042387 0.20588       
Number of obs: 1200, groups:  student, 200

Fixed effects:
            Estimate Std. Error t value
(Intercept)  2.59921    0.01831  141.94
occasion     0.10631    0.00587   18.11</code></pre>
</div>
<div id="random-effects" class="section level4">
<h4>Random effects</h4>
<p>Now let’s look at the variance estimates, where we see some differences between the LGC and mixed model approach. LGC by default assumes heterogeneous variance for each time point. Mixed models by default assume the same variance for each time point, but can allow them to be estimated separately in most modeling packages. Likewise, we could fix the LGC variances to be identical here. Just know that’s why the results are not identical (to go along with their respective estimation approaches, which are also different by default).</p>
<pre><code>Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  intercept ~~                                        
    occasion          0.002    0.002    1.629    0.103
    
Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .gpa_0             0.080    0.010    8.136    0.000
   .gpa_1             0.071    0.008    8.799    0.000
   .gpa_2             0.054    0.006    9.039    0.000
   .gpa_3             0.029    0.003    8.523    0.000
   .gpa_4             0.015    0.002    5.986    0.000
   .gpa_5             0.016    0.003    4.617    0.000
    intercept         0.035    0.007    4.947    0.000
    occasion          0.003    0.001    5.645    0.000</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="supplemental.html#cb119-1" aria-hidden="true" tabindex="-1"></a>mixedup<span class="sc">::</span><span class="fu">extract_vc</span>(gpa_mixed)</span></code></pre></div>
<pre><code>                          group    effect variance    sd sd_2.5 sd_97.5 var_prop
sd_(Intercept)|student  student Intercept    0.045 0.212  0.182   0.245    0.489
sd_occasion|student     student  occasion    0.004 0.067  0.057   0.078    0.049
sigma                  Residual              0.042 0.206  0.196   0.216    0.462</code></pre>
</div>
</div>
<div id="random-intercepts" class="section level3">
<h3>Random intercepts</h3>
<p>How can we put these models on the same footing? Let’s take a step back and do a model with only random intercepts. In this case, time is an observed measure, and has no person-specific variability. Our graphical model now looks like the following. Time, or time point (i.e. semester in our example), is now represented with a square to denote it is no longer affiliated with a latent variable.</p>
<div style="width:50%; margin:auto auto; font-size:50%">
<div id="htmlwidget-d8adf897fba9f38019dc" style="width:100%;height:25%;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-d8adf897fba9f38019dc">{"x":{"diagram":"digraph growth {\n           # specifying label position is impossible as long as Diagrammer ignores several label attributes inherent in graphviz\n           # Intialization of graph attributes\n           graph [overlap=false ordering=out outputorder = edgesfirst splines=false bgcolor=transparent]    # order out keeps observed nodes in order; splines will keep straight after specifying headport\n           \n           # Node statements\n           node [shape=circle style=filled fillcolor=lightblue color=gray75 fontcolor=gray50 fontsize=\"14px\"];\n           \n           subgraph{\n            rankdir = LR;\n             rank = same;\n\n             # using plotly palette with alpha\n             Intercept [label=\"Intercept\", fontname=Roboto, fontcolor=white, fixedsize=true, width=1, height=1, fillcolor=\"#1f77b480\" color=\"#1f77b4\"];  \n             \n           }\n           \n           Time [fontname=Roboto, fontcolor=white, fixedsize=true, width=.66, height=.66, fillcolor=\"#ff7f0e80\" color=\"#ff7f0e\" shape=square];\n\n           node [width=.66, height=.66, fixedsize=true, shape=square, style=\"\"]\n           subgraph {\n             rankdir = TB;\n             rank=same;\n             node [fontcolor=gray50]\n             node [color=\"#9467bd\"]\n             \n             V1 [label = <Y<FONT POINT-SIZE=\"8\"><SUB>T1<\/SUB><\/FONT>>];\n             V2 [label = <Y<FONT POINT-SIZE=\"8\"><SUB>T2<\/SUB><\/FONT>>]; \n             V3 [label = <Y<FONT POINT-SIZE=\"8\"><SUB>T3<\/SUB><\/FONT>>]; \n             V4 [label = <Y<FONT POINT-SIZE=\"8\"><SUB>T4<\/SUB><\/FONT>>]; \n           }\n\n           # Initialization of edge attributes\n           edge [color = gray50 overlap=false arrowsize=.5]\n           \n           # Edge statements\n\n           edge [dir=forward headport=\"c\" minlen=1]\n           edge [label=\"1\"  color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           Intercept -> V1; \n           edge [label=\"1\"   color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           Intercept -> V2;\n           edge [label=\"1\"  color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           Intercept -> V3;\n           edge [label=\"1\"  color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           Intercept -> V4;\n           \n           edge [dir=back minlen=1]\n           edge [label=\"0\"  color=\"#ff7f0e\" fontcolor=\"#ff7f0e\" labelposition=3]\n           V1 -> Time; \n           edge [label=\"1\"  color=\"#ff7f0e\" fontcolor=\"#ff7f0e\"]\n           V2 -> Time;\n           edge [label=\"2\"  color=\"#ff7f0e\" fontcolor=\"#ff7f0e\"]\n           V3 -> Time;\n           edge [label=\"3\"  color=\"#ff7f0e\" fontcolor=\"#ff7f0e\"]\n           V4 -> Time;\n   \n} ","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<p>We can do this by fixing the slope ‘factor’ to have zero variance. However, note also that in the LGC, at each time point of the gpa outcome, we have a unique (residual) variance associated with it. Conversely, this is constant in the mixed model setting, i.e. we only have one estimate for the residual variance that does not vary by occasion. We deal with this in the LGC by giving the parameter an arbitrary name, <code>resid</code>, and then applying it to each time point.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="supplemental.html#cb121-1" aria-hidden="true" tabindex="-1"></a>lgc_ran_int_model <span class="ot">=</span> <span class="st">&#39;</span></span>
<span id="cb121-2"><a href="supplemental.html#cb121-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-3"><a href="supplemental.html#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="st"> intercept =~ 1*gpa_0 + 1*gpa_1 + 1*gpa_2 + 1*gpa_3 + 1*gpa_4 + 1*gpa_5</span></span>
<span id="cb121-4"><a href="supplemental.html#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="st"> slope     =~ 0*gpa_0 + 1*gpa_1 + 2*gpa_2 + 3*gpa_3 + 4*gpa_4 + 5*gpa_5</span></span>
<span id="cb121-5"><a href="supplemental.html#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="st"> </span></span>
<span id="cb121-6"><a href="supplemental.html#cb121-6" aria-hidden="true" tabindex="-1"></a><span class="st"> slope     ~~ 0*slope    # slope variance is zero</span></span>
<span id="cb121-7"><a href="supplemental.html#cb121-7" aria-hidden="true" tabindex="-1"></a><span class="st"> intercept ~~ 0*slope    # no covariance with intercept factor</span></span>
<span id="cb121-8"><a href="supplemental.html#cb121-8" aria-hidden="true" tabindex="-1"></a><span class="st"> </span></span>
<span id="cb121-9"><a href="supplemental.html#cb121-9" aria-hidden="true" tabindex="-1"></a><span class="st"> </span></span>
<span id="cb121-10"><a href="supplemental.html#cb121-10" aria-hidden="true" tabindex="-1"></a><span class="st"> gpa_0 ~~ resid*gpa_0    # same residual variance for each time point</span></span>
<span id="cb121-11"><a href="supplemental.html#cb121-11" aria-hidden="true" tabindex="-1"></a><span class="st"> gpa_1 ~~ resid*gpa_1</span></span>
<span id="cb121-12"><a href="supplemental.html#cb121-12" aria-hidden="true" tabindex="-1"></a><span class="st"> gpa_2 ~~ resid*gpa_2</span></span>
<span id="cb121-13"><a href="supplemental.html#cb121-13" aria-hidden="true" tabindex="-1"></a><span class="st"> gpa_3 ~~ resid*gpa_3</span></span>
<span id="cb121-14"><a href="supplemental.html#cb121-14" aria-hidden="true" tabindex="-1"></a><span class="st"> gpa_4 ~~ resid*gpa_4</span></span>
<span id="cb121-15"><a href="supplemental.html#cb121-15" aria-hidden="true" tabindex="-1"></a><span class="st"> gpa_5 ~~ resid*gpa_5</span></span>
<span id="cb121-16"><a href="supplemental.html#cb121-16" aria-hidden="true" tabindex="-1"></a><span class="st"> </span></span>
<span id="cb121-17"><a href="supplemental.html#cb121-17" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span></code></pre></div>
<p>Now each time point will have one variance estimate. Let’s run the LGC.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="supplemental.html#cb122-1" aria-hidden="true" tabindex="-1"></a>lgc_ran_int <span class="ot">=</span> <span class="fu">growth</span>(lgc_ran_int_model, <span class="at">data =</span> gpa_wide)</span>
<span id="cb122-2"><a href="supplemental.html#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="supplemental.html#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="co"># increase the number of digits shown, remove some output unnecessary to demo</span></span>
<span id="cb122-4"><a href="supplemental.html#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lgc_ran_int, <span class="at">nd =</span> <span class="dv">4</span>, <span class="at">header =</span> <span class="cn">FALSE</span>)  </span></code></pre></div>
<pre><code>
Parameter Estimates:

  Standard errors                                 Standard
  Information                                     Expected
  Information saturated (h1) model              Structured

Latent Variables:
                    Estimate   Std.Err   z-value   P(&gt;|z|)
  intercept =~                                            
    gpa_0             1.0000                              
    gpa_1             1.0000                              
    gpa_2             1.0000                              
    gpa_3             1.0000                              
    gpa_4             1.0000                              
    gpa_5             1.0000                              
  slope =~                                                
    gpa_0             0.0000                              
    gpa_1             1.0000                              
    gpa_2             2.0000                              
    gpa_3             3.0000                              
    gpa_4             4.0000                              
    gpa_5             5.0000                              

Covariances:
                    Estimate   Std.Err   z-value   P(&gt;|z|)
  intercept ~~                                            
    slope             0.0000                              

Intercepts:
                    Estimate   Std.Err   z-value   P(&gt;|z|)
   .gpa_0             0.0000                              
   .gpa_1             0.0000                              
   .gpa_2             0.0000                              
   .gpa_3             0.0000                              
   .gpa_4             0.0000                              
   .gpa_5             0.0000                              
    intercept         2.5992    0.0217  120.0471    0.0000
    slope             0.1063    0.0041   26.1094    0.0000

Variances:
                    Estimate   Std.Err   z-value   P(&gt;|z|)
    slope             0.0000                              
   .gpa_0   (resd)    0.0580    0.0026   22.3607    0.0000
   .gpa_1   (resd)    0.0580    0.0026   22.3607    0.0000
   .gpa_2   (resd)    0.0580    0.0026   22.3607    0.0000
   .gpa_3   (resd)    0.0580    0.0026   22.3607    0.0000
   .gpa_4   (resd)    0.0580    0.0026   22.3607    0.0000
   .gpa_5   (resd)    0.0580    0.0026   22.3607    0.0000
    intrcpt           0.0634    0.0073    8.6605    0.0000</code></pre>
<p>Compare it to the corresponding mixed model.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="supplemental.html#cb124-1" aria-hidden="true" tabindex="-1"></a>mixed_ran_int <span class="ot">=</span> <span class="fu">lmer</span>(gpa <span class="sc">~</span> occasion <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> student), <span class="at">data =</span> gpa, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb124-2"><a href="supplemental.html#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mixed_ran_int, <span class="at">cor =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
Formula: gpa ~ occasion + (1 | student)
   Data: gpa

     AIC      BIC   logLik deviance df.resid 
   401.6    422.0   -196.8    393.6     1196 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.6188 -0.6370 -0.0002  0.6366  2.8330 

Random effects:
 Groups   Name        Variance Std.Dev.
 student  (Intercept) 0.06336  0.2517  
 Residual             0.05803  0.2409  
Number of obs: 1200, groups:  student, 200

Fixed effects:
            Estimate Std. Error t value
(Intercept) 2.599214   0.021652  120.05
occasion    0.106314   0.004072   26.11</code></pre>
<p>Now we have essentially identical results to <span class="objclass">mixed_ran_int</span>. The default estimation process is different for the two, resulting in some differences starting several decimal places out, but these are not meaningful differences. We can actually use the same estimator, but the results will still differ slightly due to the data differences.</p>
</div>
<div id="random-intercepts-and-slopes" class="section level3">
<h3>Random intercepts and slopes</h3>
<p>Now let’s let the slope for occasion vary. We can just delete or comment out the syntax related to the (co-) variance. By default slopes and intercepts are allowed to correlate as in the mixed model. We will continue to keep the variance constant.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="supplemental.html#cb126-1" aria-hidden="true" tabindex="-1"></a>lgc_ran_int_ran_slope_model <span class="ot">=</span> <span class="st">&#39;</span></span>
<span id="cb126-2"><a href="supplemental.html#cb126-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-3"><a href="supplemental.html#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="st"> intercept =~ 1*gpa_0 + 1*gpa_1 + 1*gpa_2 + 1*gpa_3 + 1*gpa_4 + 1*gpa_5</span></span>
<span id="cb126-4"><a href="supplemental.html#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="st"> slope     =~ 0*gpa_0 + 1*gpa_1 + 2*gpa_2 + 3*gpa_3 + 4*gpa_4 + 5*gpa_5</span></span>
<span id="cb126-5"><a href="supplemental.html#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="st"> </span></span>
<span id="cb126-6"><a href="supplemental.html#cb126-6" aria-hidden="true" tabindex="-1"></a><span class="st"> # slope     ~~ 0*slope  # slope variance is zero</span></span>
<span id="cb126-7"><a href="supplemental.html#cb126-7" aria-hidden="true" tabindex="-1"></a><span class="st"> # intercept ~~ 0*slope  # no covariance</span></span>
<span id="cb126-8"><a href="supplemental.html#cb126-8" aria-hidden="true" tabindex="-1"></a><span class="st"> </span></span>
<span id="cb126-9"><a href="supplemental.html#cb126-9" aria-hidden="true" tabindex="-1"></a><span class="st"> </span></span>
<span id="cb126-10"><a href="supplemental.html#cb126-10" aria-hidden="true" tabindex="-1"></a><span class="st"> gpa_0 ~~ resid*gpa_0    # same residual variance for each time point</span></span>
<span id="cb126-11"><a href="supplemental.html#cb126-11" aria-hidden="true" tabindex="-1"></a><span class="st"> gpa_1 ~~ resid*gpa_1</span></span>
<span id="cb126-12"><a href="supplemental.html#cb126-12" aria-hidden="true" tabindex="-1"></a><span class="st"> gpa_2 ~~ resid*gpa_2</span></span>
<span id="cb126-13"><a href="supplemental.html#cb126-13" aria-hidden="true" tabindex="-1"></a><span class="st"> gpa_3 ~~ resid*gpa_3</span></span>
<span id="cb126-14"><a href="supplemental.html#cb126-14" aria-hidden="true" tabindex="-1"></a><span class="st"> gpa_4 ~~ resid*gpa_4</span></span>
<span id="cb126-15"><a href="supplemental.html#cb126-15" aria-hidden="true" tabindex="-1"></a><span class="st"> gpa_5 ~~ resid*gpa_5</span></span>
<span id="cb126-16"><a href="supplemental.html#cb126-16" aria-hidden="true" tabindex="-1"></a><span class="st"> </span></span>
<span id="cb126-17"><a href="supplemental.html#cb126-17" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span></code></pre></div>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="supplemental.html#cb127-1" aria-hidden="true" tabindex="-1"></a>lgc_ran_int_ran_slope <span class="ot">=</span> <span class="fu">growth</span>(lgc_ran_int_ran_slope_model, <span class="at">data =</span> gpa_wide)</span>
<span id="cb127-2"><a href="supplemental.html#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lgc_ran_int_ran_slope, <span class="at">nd =</span> <span class="dv">4</span>, <span class="at">header =</span> <span class="cn">FALSE</span>)  </span></code></pre></div>
<pre><code>
Parameter Estimates:

  Standard errors                                 Standard
  Information                                     Expected
  Information saturated (h1) model              Structured

Latent Variables:
                    Estimate   Std.Err   z-value   P(&gt;|z|)
  intercept =~                                            
    gpa_0             1.0000                              
    gpa_1             1.0000                              
    gpa_2             1.0000                              
    gpa_3             1.0000                              
    gpa_4             1.0000                              
    gpa_5             1.0000                              
  slope =~                                                
    gpa_0             0.0000                              
    gpa_1             1.0000                              
    gpa_2             2.0000                              
    gpa_3             3.0000                              
    gpa_4             4.0000                              
    gpa_5             5.0000                              

Covariances:
                    Estimate   Std.Err   z-value   P(&gt;|z|)
  intercept ~~                                            
    slope            -0.0014    0.0016   -0.8337    0.4045

Intercepts:
                    Estimate   Std.Err   z-value   P(&gt;|z|)
   .gpa_0             0.0000                              
   .gpa_1             0.0000                              
   .gpa_2             0.0000                              
   .gpa_3             0.0000                              
   .gpa_4             0.0000                              
   .gpa_5             0.0000                              
    intercept         2.5992    0.0183  141.9471    0.0000
    slope             0.1063    0.0059   18.1113    0.0000

Variances:
                    Estimate   Std.Err   z-value   P(&gt;|z|)
   .gpa_0   (resd)    0.0424    0.0021   20.0000    0.0000
   .gpa_1   (resd)    0.0424    0.0021   20.0000    0.0000
   .gpa_2   (resd)    0.0424    0.0021   20.0000    0.0000
   .gpa_3   (resd)    0.0424    0.0021   20.0000    0.0000
   .gpa_4   (resd)    0.0424    0.0021   20.0000    0.0000
   .gpa_5   (resd)    0.0424    0.0021   20.0000    0.0000
    intrcpt           0.0449    0.0068    6.5992    0.0000
    slope             0.0045    0.0007    6.3874    0.0000</code></pre>
<p>Again, we compare the mixed model to show identical output.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="supplemental.html#cb129-1" aria-hidden="true" tabindex="-1"></a>mixed_ran_int_ran_slope <span class="ot">=</span> <span class="fu">lmer</span>(gpa <span class="sc">~</span> occasion <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> occasion<span class="sc">|</span>student), <span class="at">data =</span> gpa)</span>
<span id="cb129-2"><a href="supplemental.html#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mixed_ran_int_ran_slope, <span class="at">cor =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: gpa ~ occasion + (1 + occasion | student)
   Data: gpa

REML criterion at convergence: 261

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2695 -0.5377 -0.0128  0.5326  3.1939 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 student  (Intercept) 0.045193 0.21259       
          occasion    0.004504 0.06711  -0.10
 Residual             0.042388 0.20588       
Number of obs: 1200, groups:  student, 200

Fixed effects:
            Estimate Std. Error t value
(Intercept) 2.599214   0.018357  141.59
occasion    0.106314   0.005885   18.07</code></pre>
<p>In addition, the estimated random coefficients estimates from the mixed model perfectly correlate with those of the latent variables.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
student
</th>
<th style="text-align:right;">
Int_mixed
</th>
<th style="text-align:right;">
Slope_mixed
</th>
<th style="text-align:right;">
Int_LGC
</th>
<th style="text-align:right;">
Slope_LGC
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
2.397
</td>
<td style="text-align:right;">
0.166
</td>
<td style="text-align:right;">
2.398
</td>
<td style="text-align:right;">
0.166
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
2.389
</td>
<td style="text-align:right;">
0.105
</td>
<td style="text-align:right;">
2.389
</td>
<td style="text-align:right;">
0.104
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
2.593
</td>
<td style="text-align:right;">
0.149
</td>
<td style="text-align:right;">
2.593
</td>
<td style="text-align:right;">
0.149
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
2.506
</td>
<td style="text-align:right;">
0.064
</td>
<td style="text-align:right;">
2.506
</td>
<td style="text-align:right;">
0.064
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
2.686
</td>
<td style="text-align:right;">
0.080
</td>
<td style="text-align:right;">
2.686
</td>
<td style="text-align:right;">
0.081
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
2.394
</td>
<td style="text-align:right;">
0.063
</td>
<td style="text-align:right;">
2.394
</td>
<td style="text-align:right;">
0.063
</td>
</tr>
</tbody>
</table>
<p>Note that the intercept-slope relationship in the LGC is expressed as a covariance. If we want correlation, we just ask for standardized output. I show only the line output of interest.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="supplemental.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lgc_ran_int_ran_slope, <span class="at">nd =</span> <span class="dv">4</span>, <span class="at">std =</span> <span class="cn">TRUE</span>, <span class="at">header =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>Covariances:
                    Estimate   Std.Err   z-value   P(&gt;|z|)    Std.lv   Std.all
  intercept ~~                                                                
    slope            -0.0014    0.0016   -0.8337    0.4045   -0.0963   -0.0963</code></pre>
<p>The <code>std.all</code> is what we typically will look at.</p>
</div>
<div id="random-effects-with-heterogeneous-variances" class="section level3">
<h3>Random effects with heterogeneous variances</h3>
<p>We have demonstrated heterogeneous variances <a href="extensions.html#heterogeneous-variance">previously</a>. But to revisit here, <span class="pack">lme4</span> does not provide an easy way to have separate variance at each time point, sacrificing various model complexities for computational advantages. However, <span class="pack">nlme</span> provides an easy, though not straightforward way to get at these estimates. See the previous section for details.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="supplemental.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb133-2"><a href="supplemental.html#cb133-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-3"><a href="supplemental.html#cb133-3" aria-hidden="true" tabindex="-1"></a>mixed_ran_int_ran_slope_hetero_var <span class="ot">=</span> <span class="fu">lme</span>(</span>
<span id="cb133-4"><a href="supplemental.html#cb133-4" aria-hidden="true" tabindex="-1"></a>  gpa <span class="sc">~</span> occasion,</span>
<span id="cb133-5"><a href="supplemental.html#cb133-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> occasion <span class="sc">|</span> student,</span>
<span id="cb133-6"><a href="supplemental.html#cb133-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> gpa,</span>
<span id="cb133-7"><a href="supplemental.html#cb133-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span> <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>occasion)</span>
<span id="cb133-8"><a href="supplemental.html#cb133-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb133-9"><a href="supplemental.html#cb133-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-10"><a href="supplemental.html#cb133-10" aria-hidden="true" tabindex="-1"></a>mixedup<span class="sc">::</span><span class="fu">summarise_model</span>(mixed_ran_int_ran_slope_hetero_var)</span></code></pre></div>
<pre><code>
Variance Components:</code></pre>
<pre><code>    Group    Effect Variance   SD SD_2.5 SD_97.5 Var_prop
  student Intercept     0.04 0.19   0.15    0.23     0.30
  student  occasion     0.00 0.06   0.05    0.07     0.03
 Residual               0.08 0.28   0.24    0.33     0.67</code></pre>
<pre><code>
Fixed Effects:</code></pre>
<pre><code>      Term Value   SE      Z P_value Lower_2.5 Upper_97.5
 Intercept  2.60 0.02 141.60    0.00      2.56       2.63
  occasion  0.11 0.01  20.29    0.00      0.10       0.12</code></pre>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:mixed-heterogenous">Table 2: </span>Residual variance at each time point
</caption>
<thead>
<tr>
<th style="text-align:right;">
Semester
</th>
<th style="text-align:right;">
Variance
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.080
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.071
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.054
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.029
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.015
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.016
</td>
</tr>
</tbody>
</table>
<p>Compare to the LGC (our <span class="objclass">lgc_init model</span>).</p>
<pre><code>Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .gpa_0             0.080    0.010    8.136    0.000
   .gpa_1             0.071    0.008    8.799    0.000
   .gpa_2             0.054    0.006    9.039    0.000
   .gpa_3             0.029    0.003    8.523    0.000
   .gpa_4             0.015    0.002    5.986    0.000
   .gpa_5             0.016    0.003    4.617    0.000</code></pre>
</div>
<div id="other-covariates" class="section level3">
<h3>Other covariates</h3>
<p>Within these models we can have cluster level covariates which are constant over time, or covariates that vary over time. We will examine each in turn.</p>
<div id="cluster-level-covariates-1" class="section level4">
<h4>Cluster level covariates</h4>
<div id="mixed-model" class="section level5">
<h5>Mixed model</h5>
<p>To add a <span class="emph">cluster-level covariate</span>, for a mixed model, it looks something like this (ignoring lowest level subscript, <span class="math inline">\(b_0\)</span> = intercept):</p>
<p><em>standard random intercept</em></p>
<p><span class="math display">\[\mathrm{gpa} = b_{\mathrm{int\_student}} + b_{occ}\cdot\mathrm{time} + \epsilon \]</span></p>
<p><span class="math display">\[b_{\mathrm{int\_student}} = b_{\mathrm{intercept}} + \mathrm{re}_{\mathrm{intercept}}\]</span></p>
<p>Plugging in becomes:</p>
<p><span class="math display">\[\mathrm{gpa} = b_{\mathrm{intercept}} + b_{occ}\cdot\mathrm{occasion} +  \mathrm{re}_{\mathrm{intercept}} + \epsilon \]</span></p>
<p><em>subject level covariate added</em></p>
<p><span class="math display">\[b_{\mathrm{int\_student}} = b_{\mathrm{intercept}} + b_{\mathrm{sex}}\cdot\mathrm{sex} + \mathrm{re}_{\mathrm{intercept}}\]</span></p>
<p>But if we plug that into our level 1 model, it just becomes:</p>
<p><span class="math display">\[\mathrm{gpa} = b_{\mathrm{intercept}} + b_{\mathrm{sex}}\cdot\mathrm{sex} + b_{occ}\cdot\mathrm{occasion} +  \mathrm{re}_{\mathrm{intercept}} + \epsilon \]</span></p>
<p>In our previous modeling syntax it would look like this:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="supplemental.html#cb139-1" aria-hidden="true" tabindex="-1"></a>gpa_mixed <span class="ot">=</span> <span class="fu">lmer</span>(gpa <span class="sc">~</span> sex <span class="sc">+</span> occasion <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>student), <span class="at">data =</span> gpa)</span></code></pre></div>
<p>We’d have a fixed effect for sex and interpret it just like in the standard regression setting.</p>
</div>
<div id="lgc" class="section level5">
<h5>LGC</h5>
<p>With LGC, there is a tendency to interpret the model as an SEM, with the language of effects on latent variables, and certainly one can. For example, we can talk about the (implicitly causal) effect of sex on the intercepts factor, which represents GPA at the first semester. However, adding additional covariates typically causes confusion for those not familiar with mixed models. We literally do have to regress the intercept and slope latent variables on cluster level covariates as follows.</p>
<p><span class="math display">\[\mathrm{gpa} = b_{\mathrm{int\_student}} + b_{\mathrm{occ\_student}}\cdot \mathrm{occasion} + \epsilon\]</span>
<span class="math display">\[b_{\mathrm{int\_student}} = b_{\mathrm{intercept}} + b_{\mathrm{sex}}\cdot\mathrm{sex} + \mathrm{re}_{\mathrm{intercept}}\]</span>
Furthermore, people almost automatically put in an effect for the cluster level covariate on the slope factor also. In the mixed model this would result in the following:</p>
<p><em>subject level covariate added added for slopes</em></p>
<p><span class="math display">\[b_{\mathrm{occ\_student}} = b_{\mathrm{occ}} + \gamma\cdot\mathrm{sex} + \mathrm{re}_{\mathrm{occasion}}\]</span></p>
<p>And after plugging in:</p>
<p><span class="math display">\[\mathrm{gpa} = \color{#b2001d}{b_{\mathrm{intercept}} + b_{\mathrm{sex}}\cdot\mathrm{sex} + b_{occ}\cdot\mathrm{occasion} + \mathbf{\gamma\cdot\mathrm{sex}\cdot\mathrm{occasion}}}  + \color{#001eb2}{\mathrm{re}_{\mathrm{intercept}} + \mathrm{re}_{\mathrm{occasion}}\cdot\mathrm{occasion}} + e\]</span></p>
<p>The fixed effects are in red, while the random effects are in blue. Focusing on the fixed effects, we can see that this warrants an interaction between sex and occasion. This is <em>not required</em>, but one should add it if they actually are interested in the interaction. Our graphical model looks like the following using the above notation.</p>
<div style="width:50%; margin:auto auto; font-size:50%">
<div id="htmlwidget-8ea3b0cdb2bbbf88fc79" style="width:100%;height:25%;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-8ea3b0cdb2bbbf88fc79">{"x":{"diagram":"digraph growth {\n           # specifying label position is impossible as long as Diagrammer ignores several label attributes inherent in graphviz\n           # Intialization of graph attributes\n           graph [overlap=false ordering=out outputorder = edgesfirst splines=false bgcolor=transparent]    # order out keeps observed nodes in order; splines will keep straight after specifying headport\n           \n           # Node statements\n           node [shape=circle style=filled fillcolor=lightblue color=gray75 fontcolor=gray50 fontsize=\"14px\"];\n           \n           subgraph{\n            rankdir = LR;\n             rank = same;\n\n             # using plotly palette with alpha\n             Intercept [label=\"Intercept\", fontname=Roboto, fontcolor=white, fixedsize=true, width=1, height=1, fillcolor=\"#1f77b480\" color=\"#1f77b4\"];  \n             Occasion [fontname=Roboto, fontcolor=white, fixedsize=true, width=1, height=1, fillcolor=\"#ff7f0e80\" color=\"#ff7f0e\"];\n           }\n           \n           \n           node [width=.75, height=.75, fixedsize=true, shape=square, style=\"\"]\n           sex;\n\n           node [width=.75, height=.75, fixedsize=true, shape=square, style=\"\"]\n           subgraph {\n             rankdir = TB;\n             rank=same;\n             node [fontcolor=gray50]\n             node [color=\"#9467bd\"]\n             \n             V1 [label = <GPA<FONT POINT-SIZE=\"8\"><SUB>sem_1<\/SUB><\/FONT>>];\n             V2 [label = <GPA<FONT POINT-SIZE=\"8\"><SUB>sem_2<\/SUB><\/FONT>>]; \n             V3 [label = <GPA<FONT POINT-SIZE=\"8\"><SUB>sem_3<\/SUB><\/FONT>>]; \n             V4 [label = <GPA<FONT POINT-SIZE=\"8\"><SUB>sem_4<\/SUB><\/FONT>>]; \n             V5 [label = <GPA<FONT POINT-SIZE=\"8\"><SUB>sem_5<\/SUB><\/FONT>>]; \n             V6 [label = <GPA<FONT POINT-SIZE=\"8\"><SUB>sem_6<\/SUB><\/FONT>>]; \n           }\n\n           # Initialization of edge attributes\n           edge [color = gray50 overlap=false arrowsize=.5]\n           \n           # Edge statements\n           \n           edge [ fontcolor=gray25 dir=both fontsize=\"8px\"]  # labeleangle, labeldistance etc. attributes ignored\n           Intercept -> Occasion[label=\"  &rho;\\n\" minlen=2];\n           \n           edge [dir=forward headport=\"c\" minlen=1]\n           edge [label=\"1\"  color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           Intercept -> V1; \n           edge [label=\"1\"   color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           Intercept -> V2;\n           edge [label=\"1\"  color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           Intercept -> V3;\n           edge [label=\"1\"  color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           Intercept -> V4;\n           edge [label=\"1\"  color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           Intercept -> V5;\n           edge [label=\"1\"  color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           Intercept -> V6;\n           \n           edge [dir=forward headport=\"n\" minlen=1]\n           edge [label=\"0\"  color=\"#ff7f0e\" fontcolor=\"#ff7f0e\" labelposition=3]\n           Occasion -> V1; \n           edge [label=\"1\"  color=\"#ff7f0e\" fontcolor=\"#ff7f0e\"]\n           Occasion -> V2;\n           edge [label=\"2\"  color=\"#ff7f0e\" fontcolor=\"#ff7f0e\"]\n           Occasion -> V3;\n           edge [label=\"3\"  color=\"#ff7f0e\" fontcolor=\"#ff7f0e\"]\n           Occasion -> V4;\n           edge [label=\"4\"  color=\"#ff7f0e\" fontcolor=\"#ff7f0e\"]\n           Occasion -> V5;\n           edge [label=\"5\"  color=\"#ff7f0e\" fontcolor=\"#ff7f0e\"]\n           Occasion -> V6;\n           \n           edge [dir=forward headport=\"n\" minlen=1]\n           sex -> Intercept [label = <b<FONT POINT-SIZE=\"8\"><SUB>sex<\/SUB><\/FONT>>];\n           sex -> Occasion [label = \"γ\"];\n} ","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<p>We are now ready to run the LGC for comparison.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="supplemental.html#cb140-1" aria-hidden="true" tabindex="-1"></a>lgc_cluster_level_model <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb140-2"><a href="supplemental.html#cb140-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3"><a href="supplemental.html#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="st">  intercept =~ 1*gpa_0 + 1*gpa_1 + 1*gpa_2 + 1*gpa_3 + 1*gpa_4 + 1*gpa_5</span></span>
<span id="cb140-4"><a href="supplemental.html#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="st">  occasion  =~ 0*gpa_0 + 1*gpa_1 + 2*gpa_2 + 3*gpa_3 + 4*gpa_4 + 5*gpa_5</span></span>
<span id="cb140-5"><a href="supplemental.html#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb140-6"><a href="supplemental.html#cb140-6" aria-hidden="true" tabindex="-1"></a><span class="st">  # regressions</span></span>
<span id="cb140-7"><a href="supplemental.html#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="st">  intercept ~ female</span></span>
<span id="cb140-8"><a href="supplemental.html#cb140-8" aria-hidden="true" tabindex="-1"></a><span class="st">  occasion  ~ female </span></span>
<span id="cb140-9"><a href="supplemental.html#cb140-9" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb140-10"><a href="supplemental.html#cb140-10" aria-hidden="true" tabindex="-1"></a><span class="st">  gpa_0 ~~ resid*gpa_0    # same residual variance for each time point</span></span>
<span id="cb140-11"><a href="supplemental.html#cb140-11" aria-hidden="true" tabindex="-1"></a><span class="st">  gpa_1 ~~ resid*gpa_1</span></span>
<span id="cb140-12"><a href="supplemental.html#cb140-12" aria-hidden="true" tabindex="-1"></a><span class="st">  gpa_2 ~~ resid*gpa_2</span></span>
<span id="cb140-13"><a href="supplemental.html#cb140-13" aria-hidden="true" tabindex="-1"></a><span class="st">  gpa_3 ~~ resid*gpa_3</span></span>
<span id="cb140-14"><a href="supplemental.html#cb140-14" aria-hidden="true" tabindex="-1"></a><span class="st">  gpa_4 ~~ resid*gpa_4</span></span>
<span id="cb140-15"><a href="supplemental.html#cb140-15" aria-hidden="true" tabindex="-1"></a><span class="st">  gpa_5 ~~ resid*gpa_5</span></span>
<span id="cb140-16"><a href="supplemental.html#cb140-16" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb140-17"><a href="supplemental.html#cb140-17" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb140-18"><a href="supplemental.html#cb140-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-19"><a href="supplemental.html#cb140-19" aria-hidden="true" tabindex="-1"></a>lgc_cluster_level <span class="ot">=</span> <span class="fu">growth</span>(lgc_cluster_level_model, <span class="at">data =</span> gpa_wide)</span>
<span id="cb140-20"><a href="supplemental.html#cb140-20" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lgc_cluster_level, <span class="at">std =</span> <span class="cn">TRUE</span>, <span class="at">header =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>
Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  intercept =~                                                          
    gpa_0             1.000                               0.212    0.717
    gpa_1             1.000                               0.212    0.710
    gpa_2             1.000                               0.212    0.671
    gpa_3             1.000                               0.212    0.613
    gpa_4             1.000                               0.212    0.551
    gpa_5             1.000                               0.212    0.492
  occasion =~                                                           
    gpa_0             0.000                               0.000    0.000
    gpa_1             1.000                               0.067    0.224
    gpa_2             2.000                               0.134    0.424
    gpa_3             3.000                               0.201    0.581
    gpa_4             4.000                               0.267    0.695
    gpa_5             5.000                               0.334    0.776

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  intercept ~                                                           
    female            0.076    0.036    2.083    0.037    0.357    0.178
  occasion ~                                                            
    female            0.029    0.012    2.499    0.012    0.433    0.216

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .intercept ~~                                                          
   .occasion         -0.002    0.002   -1.184    0.237   -0.140   -0.140

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .gpa_0             0.000                               0.000    0.000
   .gpa_1             0.000                               0.000    0.000
   .gpa_2             0.000                               0.000    0.000
   .gpa_3             0.000                               0.000    0.000
   .gpa_4             0.000                               0.000    0.000
   .gpa_5             0.000                               0.000    0.000
   .intercept         2.560    0.026   97.376    0.000   12.085   12.085
   .occasion          0.091    0.008   10.865    0.000    1.363    1.363

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .gpa_0   (resd)    0.042    0.002   20.000    0.000    0.042    0.486
   .gpa_1   (resd)    0.042    0.002   20.000    0.000    0.042    0.476
   .gpa_2   (resd)    0.042    0.002   20.000    0.000    0.042    0.425
   .gpa_3   (resd)    0.042    0.002   20.000    0.000    0.042    0.355
   .gpa_4   (resd)    0.042    0.002   20.000    0.000    0.042    0.287
   .gpa_5   (resd)    0.042    0.002   20.000    0.000    0.042    0.229
   .intrcpt           0.043    0.007    6.525    0.000    0.968    0.968
   .occasin           0.004    0.001    6.273    0.000    0.953    0.953</code></pre>
<p>Applied researchers commonly have difficulty interpreting the model due to past experience with SEM. While these are latent variables, they aren’t typical latent variables that represent underlying theoretical constructs. It doesn’t help that the output can be confusing, because now one has an ‘intercept for your intercepts’ and an ‘intercept for your slopes.’ In the multilevel context it makes sense, but there you know ‘intercept’ is just ‘fixed effect.’</p>
<p>This is the corresponding mixed model for comparison:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="supplemental.html#cb142-1" aria-hidden="true" tabindex="-1"></a>mixed_cluster_level_cov <span class="ot">=</span> <span class="fu">lmer</span>(</span>
<span id="cb142-2"><a href="supplemental.html#cb142-2" aria-hidden="true" tabindex="-1"></a>  gpa <span class="sc">~</span> sex <span class="sc">+</span> occasion <span class="sc">+</span> sex<span class="sc">:</span>occasion <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> occasion<span class="sc">|</span>student), </span>
<span id="cb142-3"><a href="supplemental.html#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> gpa</span>
<span id="cb142-4"><a href="supplemental.html#cb142-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb142-5"><a href="supplemental.html#cb142-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-6"><a href="supplemental.html#cb142-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mixed_cluster_level_cov, <span class="at">cor =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: gpa ~ sex + occasion + sex:occasion + (1 + occasion | student)
   Data: gpa

REML criterion at convergence: 256.7

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2556 -0.5409 -0.0142  0.5407  3.2263 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 student  (Intercept) 0.044096 0.20999       
          occasion    0.004328 0.06579  -0.14
 Residual             0.042388 0.20588       
Number of obs: 1200, groups:  student, 200

Fixed effects:
                   Estimate Std. Error t value
(Intercept)        2.559549   0.026418  96.888
sexfemale          0.075553   0.036460   2.072
occasion           0.091128   0.008429  10.811
sexfemale:occasion 0.028927   0.011634   2.486</code></pre>
</div>
</div>
<div id="time-varying-covariates" class="section level4">
<h4>Time-varying covariates</h4>
<div id="mixed-model-1" class="section level5">
<h5>Mixed model</h5>
<p>If we had a <span class="emph">time varying covariate</span>, it’d look like the following. The <code>gpa</code> data doesn’t really come with a useful time-varying covariate, so I’ve added one just for demonstration, average weekly hours spent in the library (<code>lib_hours</code>).</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="supplemental.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gpa_mixed_tvc, <span class="at">cor =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: gpa ~ occasion + lib_hours + (1 + occasion | student)
   Data: gpa

REML criterion at convergence: 48.5

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.4105 -0.5185 -0.0023  0.5202  2.9575 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 student  (Intercept) 0.033134 0.18203       
          occasion    0.002817 0.05307  -0.13
 Residual             0.037591 0.19388       
Number of obs: 1200, groups:  student, 200

Fixed effects:
            Estimate Std. Error t value
(Intercept) 2.385494   0.021079  113.17
occasion    0.082838   0.005196   15.94
lib_hours   0.032216   0.002024   15.92</code></pre>
<p>Note that we could have a random slope for library hours if we wanted. The fixed effect for the covariate is still as it would be for standard regression interpretation.</p>
</div>
<div id="lgc-1" class="section level5">
<h5>LGC</h5>
<p>With time varying covariates, the syntax starts to get tedious for the LGC. Here we add <code>lib_hours</code> to the model, but we need to convert it to wide format and add it to our previous data. Thus <code>lib_hours_*</code> represent the average weekly hours spent in the library for each each student at each semester.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="supplemental.html#cb146-1" aria-hidden="true" tabindex="-1"></a>lgc_tvc <span class="ot">&lt;-</span> <span class="fu">growth</span>(lgc_tvc_model, <span class="at">data =</span> gpa_wide)</span>
<span id="cb146-2"><a href="supplemental.html#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lgc_tvc, <span class="at">header =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>
Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  intercept =~                                        
    gpa_0             1.000                           
    gpa_1             1.000                           
    gpa_2             1.000                           
    gpa_3             1.000                           
    gpa_4             1.000                           
    gpa_5             1.000                           
  occasion =~                                         
    gpa_0             0.000                           
    gpa_1             1.000                           
    gpa_2             2.000                           
    gpa_3             3.000                           
    gpa_4             4.000                           
    gpa_5             5.000                           

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  gpa_0 ~                                             
    lib_hours_0       0.045    0.004   10.701    0.000
  gpa_1 ~                                             
    lib_hours_1       0.039    0.003   13.514    0.000
  gpa_2 ~                                             
    lib_hours_2       0.033    0.002   13.752    0.000
  gpa_3 ~                                             
    lib_hours_3       0.028    0.003   11.271    0.000
  gpa_4 ~                                             
    lib_hours_4       0.024    0.003    8.527    0.000
  gpa_5 ~                                             
    lib_hours_5       0.022    0.003    6.348    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  intercept ~~                                        
    occasion         -0.001    0.001   -0.656    0.512

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .gpa_0             0.000                           
   .gpa_1             0.000                           
   .gpa_2             0.000                           
   .gpa_3             0.000                           
   .gpa_4             0.000                           
   .gpa_5             0.000                           
    intercept         2.300    0.030   76.682    0.000
    occasion          0.122    0.011   11.123    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .gpa_0   (resd)    0.036    0.002   20.000    0.000
   .gpa_1   (resd)    0.036    0.002   20.000    0.000
   .gpa_2   (resd)    0.036    0.002   20.000    0.000
   .gpa_3   (resd)    0.036    0.002   20.000    0.000
   .gpa_4   (resd)    0.036    0.002   20.000    0.000
   .gpa_5   (resd)    0.036    0.002   20.000    0.000
    intrcpt           0.030    0.005    6.019    0.000
    occasin           0.003    0.001    5.975    0.000</code></pre>
<p>However, this result is not the same as our mixed model. Here is the corresponding graphical model. The <code>*</code> represents a coefficient that is freely estimated.</p>
<div style="width:50%; margin:auto auto; font-size:50%">
<div id="htmlwidget-2f643b5fe6766ac3ccf0" style="width:100%;height:25%;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-2f643b5fe6766ac3ccf0">{"x":{"diagram":"digraph growth {\n           # specifying label position is impossible as long as Diagrammer ignores several label attributes inherent in graphviz\n           # Intialization of graph attributes\n           graph [overlap=false ordering=out outputorder = edgesfirst splines=false bgcolor=transparent]    # order out keeps observed nodes in order; splines will keep straight after specifying headport\n           \n           # Node statements\n           node [shape=circle style=filled fillcolor=lightblue color=gray75 fontcolor=gray50 fontsize=\"14px\"];\n           \n           subgraph{\n            rankdir = LR;\n             rank = same;\n\n             # using plotly palette with alpha\n             Intercept [label=\"Intercept\", fontname=Roboto, fontcolor=white, fixedsize=true, width=1, height=1, fillcolor=\"#1f77b480\" color=\"#1f77b4\"];  \n             Occasion [fontname=Roboto, fontcolor=white, fixedsize=true, width=1, height=1, fillcolor=\"#ff7f0e80\" color=\"#ff7f0e\"];\n           }\n           \n           \n\n           node [width=.75, height=.75, fixedsize=true, shape=square, style=\"\"]\n           subgraph {\n             rankdir = TB;\n             rank=same;\n             node [fontcolor=gray50]\n             node [color=\"#9467bd\"]\n             \n             V1 [label = <GPA<FONT POINT-SIZE=\"8\"><SUB>sem_1<\/SUB><\/FONT>>];\n             V2 [label = <GPA<FONT POINT-SIZE=\"8\"><SUB>sem_2<\/SUB><\/FONT>>]; \n             V3 [label = <GPA<FONT POINT-SIZE=\"8\"><SUB>sem_3<\/SUB><\/FONT>>]; \n             V4 [label = <GPA<FONT POINT-SIZE=\"8\"><SUB>sem_4<\/SUB><\/FONT>>]; \n             V5 [label = <GPA<FONT POINT-SIZE=\"8\"><SUB>sem_5<\/SUB><\/FONT>>]; \n             V6 [label = <GPA<FONT POINT-SIZE=\"8\"><SUB>sem_6<\/SUB><\/FONT>>]; \n           }\n           \n           node [width=.75, height=.75, fixedsize=true, shape=square, style=\"\"]\n           subgraph {\n             rankdir = TB;\n             rank=same;\n             node [fontcolor=gray50]\n             node [color=\"#9467bd\"]\n             \n             LH_sem_1 [label = <LH<FONT POINT-SIZE=\"8\"><SUB>sem_1<\/SUB><\/FONT>>];\n             LH_sem_2 [label = <LH<FONT POINT-SIZE=\"8\"><SUB>sem_2<\/SUB><\/FONT>>]; \n             LH_sem_3 [label = <LH<FONT POINT-SIZE=\"8\"><SUB>sem_3<\/SUB><\/FONT>>]; \n             LH_sem_4 [label = <LH<FONT POINT-SIZE=\"8\"><SUB>sem_4<\/SUB><\/FONT>>]; \n             LH_sem_5 [label = <LH<FONT POINT-SIZE=\"8\"><SUB>sem_5<\/SUB><\/FONT>>]; \n             LH_sem_6 [label = <LH<FONT POINT-SIZE=\"8\"><SUB>sem_6<\/SUB><\/FONT>>]; \n           }\n\n           # Initialization of edge attributes\n           edge [color = gray50 overlap=false arrowsize=.5]\n           \n           # Edge statements\n           \n           edge [ fontcolor=gray25 dir=both fontsize=\"8px\"]  # labeleangle, labeldistance etc. attributes ignored\n           Intercept -> Occasion[label=\"  &rho;\\n\" minlen=2];\n           \n           edge [dir=forward headport=\"c\" minlen=1]\n           edge [label=\"1\"  color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           Intercept -> V1; \n           edge [label=\"1\"   color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           Intercept -> V2;\n           edge [label=\"1\"  color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           Intercept -> V3;\n           edge [label=\"1\"  color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           Intercept -> V4;\n           edge [label=\"1\"  color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           Intercept -> V5;\n           edge [label=\"1\"  color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           Intercept -> V6;\n           \n           edge [dir=forward headport=\"n\" minlen=1]\n           edge [label=\"0\"  color=\"#ff7f0e\" fontcolor=\"#ff7f0e\" labelposition=3]\n           Occasion -> V1; \n           edge [label=\"1\"  color=\"#ff7f0e\" fontcolor=\"#ff7f0e\"]\n           Occasion -> V2;\n           edge [label=\"2\"  color=\"#ff7f0e\" fontcolor=\"#ff7f0e\"]\n           Occasion -> V3;\n           edge [label=\"3\"  color=\"#ff7f0e\" fontcolor=\"#ff7f0e\"]\n           Occasion -> V4;\n           edge [label=\"4\"  color=\"#ff7f0e\" fontcolor=\"#ff7f0e\"]\n           Occasion -> V5;\n           edge [label=\"5\"  color=\"#ff7f0e\" fontcolor=\"#ff7f0e\"]\n           Occasion -> V6;\n           \n           \n           edge [dir=back headport=\"c\" minlen=1]\n           edge [label=\" *\"  color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           V1 -> LH_sem_1; \n           edge [label=\" *\"   color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           V2 -> LH_sem_2;\n           edge [label=\" *\"  color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           V3 -> LH_sem_3;\n           edge [label=\" *\"  color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           V4 -> LH_sem_4;\n           edge [label=\" *\"  color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           V5 -> LH_sem_5;\n           edge [label=\" *\"  color=\"#1f77b4\" fontcolor=\"#1f77b4\"]\n           V6 -> LH_sem_6;\n           \n\n} ","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<p>The problem here is similar to that seen with the residual variances. Unless we fix the coefficient to be constant, this is akin to having an interaction of the time-varying covariate with a categorical form of time. So in the same model, we flip from considering time as a numeric and linear effect on the outcome, to one that is categorical. This is rarely done in typical mixed or other regression models, though for some reason is the standard for the LGC setting. The following will get us back to the comparable mixed model.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="supplemental.html#cb148-1" aria-hidden="true" tabindex="-1"></a>lgc_tvc_model <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb148-2"><a href="supplemental.html#cb148-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-3"><a href="supplemental.html#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="st">  intercept =~ 1*gpa_0 + 1*gpa_1 + 1*gpa_2 + 1*gpa_3 + 1*gpa_4 + 1*gpa_5</span></span>
<span id="cb148-4"><a href="supplemental.html#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="st">  occasion  =~ 0*gpa_0 + 1*gpa_1 + 2*gpa_2 + 3*gpa_3 + 4*gpa_4 + 5*gpa_5</span></span>
<span id="cb148-5"><a href="supplemental.html#cb148-5" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb148-6"><a href="supplemental.html#cb148-6" aria-hidden="true" tabindex="-1"></a><span class="st">  # time-varying covariates</span></span>
<span id="cb148-7"><a href="supplemental.html#cb148-7" aria-hidden="true" tabindex="-1"></a><span class="st">  gpa_0 ~ lh_coef*lib_hours_0</span></span>
<span id="cb148-8"><a href="supplemental.html#cb148-8" aria-hidden="true" tabindex="-1"></a><span class="st">  gpa_1 ~ lh_coef*lib_hours_1</span></span>
<span id="cb148-9"><a href="supplemental.html#cb148-9" aria-hidden="true" tabindex="-1"></a><span class="st">  gpa_2 ~ lh_coef*lib_hours_2</span></span>
<span id="cb148-10"><a href="supplemental.html#cb148-10" aria-hidden="true" tabindex="-1"></a><span class="st">  gpa_3 ~ lh_coef*lib_hours_3</span></span>
<span id="cb148-11"><a href="supplemental.html#cb148-11" aria-hidden="true" tabindex="-1"></a><span class="st">  gpa_4 ~ lh_coef*lib_hours_4</span></span>
<span id="cb148-12"><a href="supplemental.html#cb148-12" aria-hidden="true" tabindex="-1"></a><span class="st">  gpa_5 ~ lh_coef*lib_hours_5</span></span>
<span id="cb148-13"><a href="supplemental.html#cb148-13" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb148-14"><a href="supplemental.html#cb148-14" aria-hidden="true" tabindex="-1"></a><span class="st">  gpa_0 ~~ resid*gpa_0    # same residual variance for each time point</span></span>
<span id="cb148-15"><a href="supplemental.html#cb148-15" aria-hidden="true" tabindex="-1"></a><span class="st">  gpa_1 ~~ resid*gpa_1</span></span>
<span id="cb148-16"><a href="supplemental.html#cb148-16" aria-hidden="true" tabindex="-1"></a><span class="st">  gpa_2 ~~ resid*gpa_2</span></span>
<span id="cb148-17"><a href="supplemental.html#cb148-17" aria-hidden="true" tabindex="-1"></a><span class="st">  gpa_3 ~~ resid*gpa_3</span></span>
<span id="cb148-18"><a href="supplemental.html#cb148-18" aria-hidden="true" tabindex="-1"></a><span class="st">  gpa_4 ~~ resid*gpa_4</span></span>
<span id="cb148-19"><a href="supplemental.html#cb148-19" aria-hidden="true" tabindex="-1"></a><span class="st">  gpa_5 ~~ resid*gpa_5  </span></span>
<span id="cb148-20"><a href="supplemental.html#cb148-20" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb148-21"><a href="supplemental.html#cb148-21" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb148-22"><a href="supplemental.html#cb148-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-23"><a href="supplemental.html#cb148-23" aria-hidden="true" tabindex="-1"></a>lgc_tvc <span class="ot">&lt;-</span> <span class="fu">growth</span>(lgc_tvc_model, <span class="at">data=</span>gpa_wide)</span>
<span id="cb148-24"><a href="supplemental.html#cb148-24" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lgc_tvc, <span class="at">header =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>
Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  intercept =~                                        
    gpa_0             1.000                           
    gpa_1             1.000                           
    gpa_2             1.000                           
    gpa_3             1.000                           
    gpa_4             1.000                           
    gpa_5             1.000                           
  occasion =~                                         
    gpa_0             0.000                           
    gpa_1             1.000                           
    gpa_2             2.000                           
    gpa_3             3.000                           
    gpa_4             4.000                           
    gpa_5             5.000                           

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  gpa_0 ~                                             
    lb_hr_0 (lh_c)    0.032    0.002   15.951    0.000
  gpa_1 ~                                             
    lb_hr_1 (lh_c)    0.032    0.002   15.951    0.000
  gpa_2 ~                                             
    lb_hr_2 (lh_c)    0.032    0.002   15.951    0.000
  gpa_3 ~                                             
    lb_hr_3 (lh_c)    0.032    0.002   15.951    0.000
  gpa_4 ~                                             
    lb_hr_4 (lh_c)    0.032    0.002   15.951    0.000
  gpa_5 ~                                             
    lb_hr_5 (lh_c)    0.032    0.002   15.951    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  intercept ~~                                        
    occasion         -0.001    0.001   -0.973    0.331

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .gpa_0             0.000                           
   .gpa_1             0.000                           
   .gpa_2             0.000                           
   .gpa_3             0.000                           
   .gpa_4             0.000                           
   .gpa_5             0.000                           
    intercept         2.385    0.021  113.389    0.000
    occasion          0.083    0.005   15.983    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .gpa_0   (resd)    0.038    0.002   20.000    0.000
   .gpa_1   (resd)    0.038    0.002   20.000    0.000
   .gpa_2   (resd)    0.038    0.002   20.000    0.000
   .gpa_3   (resd)    0.038    0.002   20.000    0.000
   .gpa_4   (resd)    0.038    0.002   20.000    0.000
   .gpa_5   (resd)    0.038    0.002   20.000    0.000
    intrcpt           0.033    0.005    6.148    0.000
    occasin           0.003    0.001    5.523    0.000</code></pre>
<p>Compare again to the mixed model result.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="supplemental.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gpa_mixed_tvc, <span class="at">cor =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: gpa ~ occasion + lib_hours + (1 + occasion | student)
   Data: gpa

REML criterion at convergence: 48.5

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.4105 -0.5185 -0.0023  0.5202  2.9575 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 student  (Intercept) 0.033134 0.18203       
          occasion    0.002817 0.05307  -0.13
 Residual             0.037591 0.19388       
Number of obs: 1200, groups:  student, 200

Fixed effects:
            Estimate Std. Error t value
(Intercept) 2.385494   0.021079  113.17
occasion    0.082838   0.005196   15.94
lib_hours   0.032216   0.002024   15.92</code></pre>
<p>Now imagine having just a few of those kinds of variables as would be common in most longitudinal settings. In the mixed model framework one would add them in as any covariate in a regression model, and each covariate would be associated with a single fixed effect. In the LGC framework, one has to regress each time point for the target variable on its corresponding predictor time point. It might take a few paragraphs to explain the coefficients for just a handful of covariates. If you fix them to a single value, you would duplicate the mixed model, but the syntax requires even more tedium<a href="#fn32" class="footnote-ref" id="fnref32"><sup>32</sup></a>.</p>
</div>
</div>
</div>
<div id="some-differences-between-mixed-models-and-growth-curves" class="section level3">
<h3>Some differences between mixed models and growth curves</h3>
<div id="wide-vs.-long" class="section level4">
<h4>Wide vs. long</h4>
<p>The SEM framework is inherently multivariate, i.e. assuming multiple outcomes, so your data will need to be in wide format. In the R world, this is ‘untidy’ data, and makes other data processing and visualization more tedious.</p>
</div>
<div id="random-slopes" class="section level4">
<h4>Random slopes</h4>
<p>One difference seen in comparing LGC models vs. mixed models is that in the former, random slopes are always assumed, whereas in the latter, one would typically see if it’s worth adding random slopes in the first place, or simply not assume them.</p>
</div>
<div id="other-random-effects" class="section level4">
<h4>Other random effects</h4>
<p>Just about any LGC you come across in the wild has only one clustering level of interest. However, it’s very common to have multiple and non-hierarchical random effects structure or additional random effects beyond the time covariate. In our example, these might include school, district, or other complicated structure, or the library hours from the time-varying covariate example. Tools like <span class="pack">lme4</span> handle random effects and complicated structure easily. SEM tools do not do this easily, and resort to the multilevel (long-format) approach, which more or less defeats the purpose of using them, as they merely mimic the standard mixed model approach, albeit with yet another and different type of syntax<a href="#fn33" class="footnote-ref" id="fnref33"><sup>33</sup></a>. However, if you have other latent variables or complicated indirect effects, this may be the way to go.</p>
</div>
<div id="sample-size" class="section level4">
<h4>Sample size</h4>
<p>SEM is inherently a large sample technique. The growth curve model does not require as much for standard approaches, but may require a lot more depending on the model one tries to estimate. In <a href="https://m-clark.github.io/docs/mixedModels/growth_vs_mixed_sim.html">my own simulations</a>, I haven’t seen too much difference compared to mixed models even for notably small sample sizes, but those were for very simple models.</p>
</div>
<div id="number-of-time-points" class="section level4">
<h4>Number of time points</h4>
<p>A basic growth curve model requires four time points to incorporate the flexibility that would make it worthwhile. Mixed models don’t have the restriction (outside of the obvious need of two). In addition, mixed models can handle any number of time points without changing the syntax at all, while LGC is rarely applied to more than a handful of time points. Even then, when you have many time-varying covariates, which is common, the model syntax is tedious, and you end up having the number of parameters to estimate climb rapidly, as the default model assumes interactions with time as a categorical variable.</p>
</div>
<div id="balance" class="section level4">
<h4>Balance</h4>
<p>Mixed models can run even if some clusters have a single value. SEM requires balanced data and so one will always have to estimate missing values or drop them. Whether this missingness can be ignored in the standard mixed model framework is a matter of some debate. Most disciplines typically ignore the missingness, which for mixed models means assuming the observations are <em>missing at random</em> (MAR). With the LGC, the default is simply to drop any observation with missing, and so the assumption there is <em>missing completely at random</em> (MCAR), a stronger assumption.</p>
</div>
<div id="numbering-the-time-points" class="section level4">
<h4>Numbering the time points</h4>
<p>Numbering your time from zero makes sense in both worlds. This leads to the natural interpretation that the intercept is the mean of the outcome for your first time point. In other cases having a centered value would make sense, or numbering from 0 to a final value of 1, which would mean the slope coefficient represents the change over the whole time span.</p>
</div>
</div>
<div id="recommended-packages-that-can-do-growth-curve-models" class="section level3">
<h3>Recommended packages that can do growth curve models</h3>
<p>Between <span class="pack">lme4</span> and <span class="pack">nlme</span> or <span class="pack">glmmTMB</span>, you can do any standard LGC. Besides that, various packages provide functionality that some might think is only done with SEM software. One package I highly recommend is <span class="pack">brms</span>, as it builds on many other packages that incorporate a mixed model approach in the Bayesian framework. The others are ones that come to mind off the top of my head, so in some cases should be seen as a starting point only.</p>
<ul>
<li>Standard LGC, including alternative distributions (e.g. robust t, beta, count, zero-inflated): <span class="pack">nlme</span>, <span class="pack">lavaan</span>, <span class="pack">lme4</span>, <span class="pack">mgcv</span>, <span class="pack">brms</span>, many others</li>
<li>Multilevel SEM: <span class="pack">lavaan</span></li>
<li>Flexible nonlinear relationships: <span class="pack">nlme</span>, <span class="pack">mgcv</span>, <span class="pack">brms</span></li>
<li>Missing data: <span class="pack">lavaan</span>, <span class="pack">brms</span>, <span class="pack">mice</span> applied to other packages</li>
<li>Multivariate/Parallel Process/Correlated random effects: <span class="pack">lavaan</span>, <span class="pack">brms</span></li>
<li>Mediation: <span class="pack">lavaan</span>, <span class="pack">mediation</span>, <span class="pack">brms</span></li>
<li>Growth Mixture Models: <span class="pack">brms</span>, <span class="pack">flexmix</span></li>
</ul>
<p>In short, you’d need a very complicated growth model to require moving from the mixed model framework to SEM-specific software or beyond R, in other words, one that combines potentially already complex modeling situations. Note also, unless you are incorporating latent variables, e.g. from scale measurements, there is little need to use something like <span class="pack">lavaan</span> or <span class="pack">Mplus</span> for standard mixed/multilevel modeling (i.e. in the long data framework), though they have such functionality. The <span class="pack">Mplus</span> manual also lumps survival and standard time series in the chapter on longitudinal and related models. However, I personally can’t see a scenario where I would use <span class="pack">Mplus</span> for survival or time series given the multitude of easier to use, more flexible, and more powerful options in R.</p>
</div>
<div id="summary-of-lgc" class="section level3">
<h3>Summary of LGC</h3>
<p>Latent Growth Curve modeling is an alternative way to do what is very commonly accomplished through mixed models, and allow for more complex models than typically seen for standard mixed models. One’s default should probably be to use the far more commonly used, and probably more flexible (in most situations), mixed modeling tools, where there are packages in R that could handle nonlinear effects, mediation and multivariate outcomes for mixed models. I have other documents regarding mixed models on my <a href="https://m-clark.github.io/documents">website</a> and code at <a href="https://github.com/m-clark/Miscellaneous-R-Code">GitHub</a>, including a document that does <a href="http://m-clark.github.io/mixed-growth-comparison/">more comparison to growth curve models</a>. However, the latent variable approach may provide what you need in some circumstances, and at the very least gives you a fresh take on the standard mixed model perspective.</p>
</div>
</div>
<div id="correlation-structure-revisited" class="section level2">
<h2>Correlation Structure Revisited</h2>
<p>Let’s revisit the notion of autocorrelation/autoregressive (AR) residual structure. We’ll start by recalling the AR structure we noted before, with <span class="math inline">\(\rho\)</span> our estimate of the covariance/correlation. For the following depiction, we have three observations per cluster, and observations are correlated in time. However the residual correlation decreases the further in time the observations are apart from one another.</p>
<p><span class="math display">\[\Sigma = \sigma^2
\left[
\begin{array}{cccc} 
1 &amp; \rho     &amp; \rho^2   &amp; \rho^3   \\
\rho     &amp; 1 &amp; \rho     &amp; \rho^2   \\
\rho^2   &amp; \rho     &amp; 1 &amp; \rho     \\
\rho^3   &amp; \rho^2   &amp; \rho     &amp; 1 \\
\end{array}\right]\]</span></p>
<p>How does this get into our model? We can find out via simulation. The next bit of code follows <span class="pack" style="">lme4</span> developer <a href="https://cran.r-project.org/web/packages/glmmTMB/vignettes/covstruct.html">Ben Bolker’s example</a>. Here we create a variable which is a multivariate draw with the specified correlational structure. In addition, we’ll have a single covariate, call it <code>x</code>. The linear predictor is based on an intercept value of 5 and a coefficient for <code>x</code> of .5.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="supplemental.html#cb152-1" aria-hidden="true" tabindex="-1"></a>simGroup <span class="ot">&lt;-</span> <span class="cf">function</span>(g, <span class="at">n =</span> <span class="dv">5</span>, <span class="at">rho =</span> <span class="dv">0</span>, <span class="at">sigma =</span> <span class="dv">1</span>) {</span>
<span id="cb152-2"><a href="supplemental.html#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create time points and group id</span></span>
<span id="cb152-3"><a href="supplemental.html#cb152-3" aria-hidden="true" tabindex="-1"></a>  times <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb152-4"><a href="supplemental.html#cb152-4" aria-hidden="true" tabindex="-1"></a>  group <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(g, n))</span>
<span id="cb152-5"><a href="supplemental.html#cb152-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb152-6"><a href="supplemental.html#cb152-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create the ar structure</span></span>
<span id="cb152-7"><a href="supplemental.html#cb152-7" aria-hidden="true" tabindex="-1"></a>  cor_struct <span class="ot">&lt;-</span> rho<span class="sc">^</span><span class="fu">as.matrix</span>(<span class="fu">dist</span>(<span class="dv">1</span><span class="sc">:</span>n))   </span>
<span id="cb152-8"><a href="supplemental.html#cb152-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb152-9"><a href="supplemental.html#cb152-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># if you want to play around with the estimated variance of glmmTMB you can,</span></span>
<span id="cb152-10"><a href="supplemental.html#cb152-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># but this will change what the expected correlation should be; use cov2cor on</span></span>
<span id="cb152-11"><a href="supplemental.html#cb152-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># cor_struct after adding the diagonal to see that value</span></span>
<span id="cb152-12"><a href="supplemental.html#cb152-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># diag(cor_struct) = 2.5</span></span>
<span id="cb152-13"><a href="supplemental.html#cb152-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb152-14"><a href="supplemental.html#cb152-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulate the process</span></span>
<span id="cb152-15"><a href="supplemental.html#cb152-15" aria-hidden="true" tabindex="-1"></a>  x_ar <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="at">mu =</span> <span class="fu">rep</span>(<span class="dv">0</span>, n), <span class="at">Sigma =</span> cor_struct) </span>
<span id="cb152-16"><a href="supplemental.html#cb152-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb152-17"><a href="supplemental.html#cb152-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add another covariate</span></span>
<span id="cb152-18"><a href="supplemental.html#cb152-18" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb152-19"><a href="supplemental.html#cb152-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb152-20"><a href="supplemental.html#cb152-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># linear predictor</span></span>
<span id="cb152-21"><a href="supplemental.html#cb152-21" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> .<span class="dv">5</span><span class="sc">*</span>x</span>
<span id="cb152-22"><a href="supplemental.html#cb152-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb152-23"><a href="supplemental.html#cb152-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add measurement noise and create target variable</span></span>
<span id="cb152-24"><a href="supplemental.html#cb152-24" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span>  mu <span class="sc">+</span> x_ar <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> sigma)                      </span>
<span id="cb152-25"><a href="supplemental.html#cb152-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb152-26"><a href="supplemental.html#cb152-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(y, times, x, group)</span>
<span id="cb152-27"><a href="supplemental.html#cb152-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb152-28"><a href="supplemental.html#cb152-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-29"><a href="supplemental.html#cb152-29" aria-hidden="true" tabindex="-1"></a><span class="fu">simGroup</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>         y times          x group
1 4.332912     1 -0.5119390     1
2 5.951277     2 -0.6460704     1
3 5.823120     3 -0.9695196     1
4 4.719023     4 -0.8317013     1
5 6.894601     5  1.0799571     1</code></pre>
<p>Now let’s do this for 500 groups or clusters, each with 10 observations, sigma equal to 1.5 and <span class="math inline">\(\rho\)</span> set at 0.8.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="supplemental.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb154-2"><a href="supplemental.html#cb154-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-3"><a href="supplemental.html#cb154-3" aria-hidden="true" tabindex="-1"></a>test_df <span class="ot">=</span> <span class="fu">map_df</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>, simGroup, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">rho =</span> .<span class="dv">8</span>, <span class="at">sigma =</span> <span class="fl">1.5</span>) </span>
<span id="cb154-4"><a href="supplemental.html#cb154-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-5"><a href="supplemental.html#cb154-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(test_df)</span></code></pre></div>
<pre><code>             y times           x group
1...1 6.924564     1 -0.47719270     1
2...2 5.349769     2 -0.99838644     1
3...3 4.673456     3 -0.77625389     1
4...4 5.626127     4  0.06445882     1
5...5 4.831887     5  0.95949406     1
6...6 3.813962     6 -0.11028549     1</code></pre>
<p>Now we run and summarize the model with <span class="pack" style="">glmmTMB</span>.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="supplemental.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmmTMB)</span>
<span id="cb156-2"><a href="supplemental.html#cb156-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-3"><a href="supplemental.html#cb156-3" aria-hidden="true" tabindex="-1"></a>model_tmb <span class="ot">=</span> <span class="fu">glmmTMB</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">ar1</span>(times <span class="sc">+</span> <span class="dv">0</span> <span class="sc">|</span> group), <span class="at">data =</span> test_df)</span>
<span id="cb156-4"><a href="supplemental.html#cb156-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-5"><a href="supplemental.html#cb156-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_tmb)</span></code></pre></div>
<pre><code> Family: gaussian  ( identity )
Formula:          y ~ x + ar1(times + 0 | group)
Data: test_df

     AIC      BIC   logLik deviance df.resid 
 19586.5  19619.1  -9788.3  19576.5     4995 

Random effects:

Conditional model:
 Groups   Name   Variance Std.Dev. Corr      
 group    times1 1.007    1.003    0.79 (ar1)
 Residual        2.180    1.477              
Number of obs: 5000, groups:  group, 500

Dispersion estimate for gaussian family (sigma^2): 2.18 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  5.04663    0.03842  131.35   &lt;2e-16 ***
x            0.54392    0.02393   22.73   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>We recover our estimates. The <code>ar1</code> value is very close to the true value of 0.8 we specified, while the residual standard deviation is close to 1.5, and our fixed effects are also as expected. We have an additional value approaching 1 for the <code>times1</code> variance, which is the diagonal of the AR correlation matrix, which in our code is separate from what we draw for the observation level residual variance.</p>
<p>Likewise, <span class="pack" style="">brms</span> has similar syntax in that we add the AR component to the formula.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="supplemental.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb158-2"><a href="supplemental.html#cb158-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-3"><a href="supplemental.html#cb158-3" aria-hidden="true" tabindex="-1"></a>model_brm <span class="ot">=</span> <span class="fu">brm</span>(</span>
<span id="cb158-4"><a href="supplemental.html#cb158-4" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">ar</span>(times, group),</span>
<span id="cb158-5"><a href="supplemental.html#cb158-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data  =</span> test_df,</span>
<span id="cb158-6"><a href="supplemental.html#cb158-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb158-7"><a href="supplemental.html#cb158-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed  =</span> <span class="dv">1234</span></span>
<span id="cb158-8"><a href="supplemental.html#cb158-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="supplemental.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_brm)</span></code></pre></div>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: y ~ x + ar(times, group) 
   Data: test_df (Number of observations: 5000) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Correlation Structures:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
ar[1]     0.25      0.01     0.22     0.28 1.00     4595     3082

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     5.05      0.03     4.98     5.11 1.00     5212     3582
x             0.55      0.02     0.50     0.60 1.00     4457     2895

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     1.74      0.02     1.70     1.77 1.00     4241     3105

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>While the focus here is on the other packages, we could also use the <span class="func" style="">gls</span> function in <span class="pack" style="">nlme</span>, which gives the same result as <span class="pack" style="">brms</span>.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="supplemental.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gls</span>(</span>
<span id="cb161-2"><a href="supplemental.html#cb161-2" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> x, </span>
<span id="cb161-3"><a href="supplemental.html#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> test_df, </span>
<span id="cb161-4"><a href="supplemental.html#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">correlation =</span> <span class="fu">corAR1</span>(<span class="at">form =</span> <span class="sc">~</span><span class="fu">as.numeric</span>(times)<span class="sc">|</span>group)</span>
<span id="cb161-5"><a href="supplemental.html#cb161-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>Generalized least squares fit by REML
  Model: y ~ x 
  Data: test_df 
  Log-restricted-likelihood: -9853.791

Coefficients:
(Intercept)           x 
  5.0443811   0.5514778 

Correlation Structure: AR(1)
 Formula: ~as.numeric(times) | group 
 Parameter estimate(s):
      Phi 
0.2453209 
Degrees of freedom: 5000 total; 4998 residual
Residual standard error: 1.784043 </code></pre>
<p>It may seem at first blush that <span class="pack" style="">glmmTMB</span> and <span class="pack" style="">brms</span> have come to different conclusions about the correlation and variance estimates. However, close inspection reveals they are in fact providing the same information from different viewpoints. The simulation code shows how we start with our linear predictor, which includes the fixed effects, then adds the random effect with autoregressive structure, and finally adds our residual variance. But the way <span class="pack" style="">brms</span> (and <span class="pack" style="">nlme</span>) is estimating it is how we’ve shown it in the matrix formulation above, as a single residual/random effect.</p>
<p><br></p>
<p><span class="math display">\[\Sigma_{brms} = \sigma^2_{brms}
\left[
\begin{array}{cccc} 
1 &amp; \rho_{brms}     &amp; \rho_{brms}^2   &amp; \rho_{brms}^3   \\
\rho_{brms}     &amp; 1 &amp; \rho_{brms}     &amp; \rho_{brms}^2   \\
\rho_{brms}^2   &amp; \rho_{brms}     &amp; 1 &amp; \rho_{brms}     \\
\rho_{brms}^3   &amp; \rho_{brms}^2   &amp; \rho_{brms}     &amp; 1 \\
\end{array}\right]\]</span></p>
<p><br></p>
<p><span class="math display">\[\Sigma_{tmb} = 
\left[
\begin{array}{cccc} 
\sigma^2_{ar} &amp; \rho_{tmb}     &amp; \rho_{tmb}^2   &amp; \rho_{tmb}^3   \\
\rho_{tmb}     &amp; \sigma^2_{ar} &amp; \rho_{tmb}     &amp; \rho_{tmb}^2   \\
\rho_{tmb}^2   &amp; \rho_{tmb}     &amp; \sigma^2_{ar} &amp; \rho_{tmb}     \\
\rho_{tmb}^3   &amp; \rho_{tmb}^2   &amp; \rho_{tmb}     &amp; \sigma^2_{ar} \\
\end{array}\right] +  
\left[
\begin{array}{cccc} 
\sigma^2_{tmb} &amp; 0   &amp; 0 &amp; 0   \\
0     &amp; \sigma^2_{tmb} &amp; 0   &amp; 0   \\
0   &amp; 0     &amp; \sigma^2_{tmb} &amp; 0   \\
0   &amp; 0   &amp; 0     &amp; \sigma^2_{tmb} \\
\end{array}\right]\]</span>
<br></p>
<p>So if we take the <span class="pack" style="">glmmTMB</span> <code>ar1</code> estimate and variance estimates we can recover the <span class="pack" style="">brms</span> estimate.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="supplemental.html#cb163-1" aria-hidden="true" tabindex="-1"></a>ar_tmb <span class="sc">*</span> ar_var_tmb<span class="sc">/</span>(ar_var_tmb <span class="sc">+</span> res_var_tmb)</span></code></pre></div>
<pre><code>[1] 0.2494005</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="supplemental.html#cb165-1" aria-hidden="true" tabindex="-1"></a>ar_brm</span></code></pre></div>
<pre><code>[1] 0.2469</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="supplemental.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># if we assume ar var = 1</span></span>
<span id="cb167-2"><a href="supplemental.html#cb167-2" aria-hidden="true" tabindex="-1"></a>ar_brm<span class="sc">*</span>res_var_brms</span></code></pre></div>
<pre><code>[1] 0.7432924</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="supplemental.html#cb169-1" aria-hidden="true" tabindex="-1"></a>ar_tmb</span></code></pre></div>
<pre><code>[1] 0.7895</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="supplemental.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># if we knew the ar variance, we could use brms to get to tmb&#39;s estimate</span></span>
<span id="cb171-2"><a href="supplemental.html#cb171-2" aria-hidden="true" tabindex="-1"></a>ar_brm<span class="sc">*</span>(ar_var_tmb <span class="sc">+</span> res_var_tmb)<span class="sc">/</span>ar_var_tmb</span></code></pre></div>
<pre><code>[1] 0.7815843</code></pre>
<p>The <span class="pack" style="">glmmTMB</span> approach is interesting in how it explicitly separates out the ar component from the rest of the residual component. This seems non-standard, as I don’t recall papers reporting the AR standard deviation for example, and every depiction I come across in the mixed model literature is the one that underlies <span class="pack" style="">brms</span>. However, it seems like it would be useful and/or interesting for some settings, or I think is even preferable as an additional interpretation for a type of random effect, similar to the ones we commonly use.</p>
<p>We can change our function to force <span class="pack" style="">glmmTMB</span> to come to the same conclusion as <span class="pack" style="">brms</span> by not distinguishing the variance components. In this case, <span class="pack" style="">glmmTMB</span> will move all residual variance to the AR estimate, and the estimated correlation is the same as what <span class="pack" style="">brms</span> reports.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="supplemental.html#cb173-1" aria-hidden="true" tabindex="-1"></a>simGroup_alt <span class="ot">&lt;-</span> <span class="cf">function</span>(g, <span class="at">n =</span> <span class="dv">5</span>, <span class="at">rho =</span> <span class="fl">0.7</span>, <span class="at">sigma =</span> .<span class="dv">5</span>) {</span>
<span id="cb173-2"><a href="supplemental.html#cb173-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create time points and group id</span></span>
<span id="cb173-3"><a href="supplemental.html#cb173-3" aria-hidden="true" tabindex="-1"></a>  times <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb173-4"><a href="supplemental.html#cb173-4" aria-hidden="true" tabindex="-1"></a>  group <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(g, n))</span>
<span id="cb173-5"><a href="supplemental.html#cb173-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb173-6"><a href="supplemental.html#cb173-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create the ar structure</span></span>
<span id="cb173-7"><a href="supplemental.html#cb173-7" aria-hidden="true" tabindex="-1"></a>  cor_struct <span class="ot">&lt;-</span> rho<span class="sc">^</span><span class="fu">as.matrix</span>(<span class="fu">dist</span>(<span class="dv">1</span><span class="sc">:</span>n))   </span>
<span id="cb173-8"><a href="supplemental.html#cb173-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb173-9"><a href="supplemental.html#cb173-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># combine the residual variance</span></span>
<span id="cb173-10"><a href="supplemental.html#cb173-10" aria-hidden="true" tabindex="-1"></a>  resid_struct <span class="ot">&lt;-</span> cor_struct<span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb173-11"><a href="supplemental.html#cb173-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb173-12"><a href="supplemental.html#cb173-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulate the process; note the difference</span></span>
<span id="cb173-13"><a href="supplemental.html#cb173-13" aria-hidden="true" tabindex="-1"></a>  x_ar <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="at">mu =</span> <span class="fu">rep</span>(<span class="dv">0</span>, n), <span class="at">Sigma =</span> resid_struct) </span>
<span id="cb173-14"><a href="supplemental.html#cb173-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb173-15"><a href="supplemental.html#cb173-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add another covariate</span></span>
<span id="cb173-16"><a href="supplemental.html#cb173-16" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb173-17"><a href="supplemental.html#cb173-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb173-18"><a href="supplemental.html#cb173-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># linear predictor</span></span>
<span id="cb173-19"><a href="supplemental.html#cb173-19" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> .<span class="dv">5</span><span class="sc">*</span>x</span>
<span id="cb173-20"><a href="supplemental.html#cb173-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb173-21"><a href="supplemental.html#cb173-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create target variable; residual already incorporated into x_ar</span></span>
<span id="cb173-22"><a href="supplemental.html#cb173-22" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span>  mu <span class="sc">+</span> x_ar           </span>
<span id="cb173-23"><a href="supplemental.html#cb173-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb173-24"><a href="supplemental.html#cb173-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(y, times, x, group)</span>
<span id="cb173-25"><a href="supplemental.html#cb173-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb173-26"><a href="supplemental.html#cb173-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-27"><a href="supplemental.html#cb173-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-28"><a href="supplemental.html#cb173-28" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb173-29"><a href="supplemental.html#cb173-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-30"><a href="supplemental.html#cb173-30" aria-hidden="true" tabindex="-1"></a>test_df_alt <span class="ot">=</span> <span class="fu">map_df</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>, simGroup_alt, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">rho =</span> ar_brm, <span class="at">sigma =</span> <span class="fl">1.5</span>) </span>
<span id="cb173-31"><a href="supplemental.html#cb173-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-32"><a href="supplemental.html#cb173-32" aria-hidden="true" tabindex="-1"></a>model_tmb_alt <span class="ot">=</span> <span class="fu">glmmTMB</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">ar1</span>(times <span class="sc">+</span> <span class="dv">0</span> <span class="sc">|</span> group), <span class="at">data =</span> test_df_alt)</span>
<span id="cb173-33"><a href="supplemental.html#cb173-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-34"><a href="supplemental.html#cb173-34" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_tmb_alt)</span></code></pre></div>
<pre><code> Family: gaussian  ( identity )
Formula:          y ~ x + ar1(times + 0 | group)
Data: test_df_alt

     AIC      BIC   logLik deviance df.resid 
 17776.4  17809.0  -8883.2  17766.4     4995 

Random effects:

Conditional model:
 Groups   Name   Variance  Std.Dev. Corr      
 group    times1 2.189e+00 1.479380 0.27 (ar1)
 Residual        2.277e-06 0.001509           
Number of obs: 5000, groups:  group, 500

Dispersion estimate for gaussian family (sigma^2): 2.28e-06 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  4.97996    0.02662  187.10   &lt;2e-16 ***
x            0.47472    0.01975   24.04   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div id="summary-of-residual-correlation-structure" class="section level3">
<h3>Summary of residual correlation structure</h3>
<p>What both of these syntactical approaches make clear is that, in specifying a specific correlational structure, we can think of it as adding a latent variable, i.e. a random effect, to our standard model, just as we have done with other random effects. This particular random effect has correlated observations within a group as specified by the structure. The same thing can apply in the case of heterogenous variances, just that no specific correlation is assumed in that case. As such, it may make more sense to think of it as an additional component to the model structure/formula, as opposed to an function argument separate from your theoretical focus.</p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="30">
<li id="fn30"><p>I’m omitting the observation level subscript, so this can work for the single observation or entire data set.<a href="supplemental.html#fnref30" class="footnote-back">↩︎</a></p></li>
<li id="fn31"><p>Usually we would draw both random effects from a multivariate normal distribution with some covariance.<a href="supplemental.html#fnref31" class="footnote-back">↩︎</a></p></li>
<li id="fn32"><p>To be fair, <span class="pack">Mplus</span> (and presumably <span class="pack">lavaan</span> at some point in the future) has shortcuts to make the syntax easier, but it also can make for more esoteric and less understandable syntax.<a href="supplemental.html#fnref32" class="footnote-back">↩︎</a></p></li>
<li id="fn33"><p>Honestly, for the same types of models I find the multilevel syntax of <span class="pack">Mplus</span> ridiculously complex relative to R packages.<a href="supplemental.html#fnref33" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="summary.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appendix.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["twitter", "facebook", "linkedin", "google", "weibo", "instapaper"],
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/m-clark/mixed-models-with-R/blob/master/supplemental.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"depth": 2,
"scroll_highlight": true
},
"df_print": "kable",
"highlight": "pygments"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
